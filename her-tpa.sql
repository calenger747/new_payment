/*
Navicat MySQL Data Transfer

Source Server         : Server
Source Server Version : 50505
Source Host           : 192.168.0.24:3306
Source Database       : her-tpa

Target Server Type    : MYSQL
Target Server Version : 50505
File Encoding         : 65001

Date: 2021-01-21 11:02:35
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for aia_member_2
-- ----------------------------
DROP TABLE IF EXISTS `aia_member_2`;
CREATE TABLE `aia_member_2` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `Policy_No` varchar(50) NOT NULL,
  `Payment_Method` varchar(50) DEFAULT NULL,
  `Branch_Code` varchar(50) DEFAULT NULL,
  `Branch_Desc` varchar(50) DEFAULT NULL,
  `RCD_Policy` varchar(50) DEFAULT NULL,
  `RCD_Rider` varchar(50) DEFAULT NULL,
  `Paid_to_Date` varchar(50) DEFAULT NULL,
  `Rider_Status` varchar(50) DEFAULT NULL,
  `Date_of_Reinstatement` varchar(50) DEFAULT NULL,
  `Product_Code` varchar(50) DEFAULT NULL,
  `Plan_Type` varchar(50) NOT NULL,
  `Owner_No` varchar(50) DEFAULT NULL,
  `Policy_Owner` varchar(75) DEFAULT NULL,
  `Address_1_Owner` varchar(255) DEFAULT NULL,
  `Address_2_Owner` varchar(255) DEFAULT NULL,
  `Address_3_Owner` varchar(255) DEFAULT NULL,
  `Address_4_Owner` varchar(255) DEFAULT NULL,
  `Address_5_Owner` varchar(255) DEFAULT NULL,
  `Kode_Pos_Owner` varchar(50) DEFAULT NULL,
  `Telp_No_1_Owner` varchar(50) DEFAULT NULL,
  `Telp_No_2_Owner` varchar(50) DEFAULT NULL,
  `Telp_No_3_Owner` varchar(50) DEFAULT NULL,
  `Insured_No` varchar(50) DEFAULT NULL,
  `Policy_Insured` varchar(75) DEFAULT NULL,
  `Date_of_Birth_Insured` varchar(50) DEFAULT NULL,
  `Sex_Insured` varchar(50) DEFAULT NULL,
  `Declare_Date` date DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for automation_report
-- ----------------------------
DROP TABLE IF EXISTS `automation_report`;
CREATE TABLE `automation_report` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `client` int(11) DEFAULT NULL,
  `code` varchar(500) COLLATE utf8_unicode_ci DEFAULT NULL,
  `case` int(50) DEFAULT NULL,
  `remarks` varchar(900) COLLATE utf8_unicode_ci DEFAULT '',
  `process_date` datetime DEFAULT NULL,
  `report_date` date DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `index_001` (`client`,`code`,`case`,`process_date`)
) ENGINE=InnoDB AUTO_INCREMENT=11763977 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- ----------------------------
-- Table structure for automation_type
-- ----------------------------
DROP TABLE IF EXISTS `automation_type`;
CREATE TABLE `automation_type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for case_log
-- ----------------------------
DROP TABLE IF EXISTS `case_log`;
CREATE TABLE `case_log` (
  `id` int(11) NOT NULL,
  `created_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `create_date` datetime DEFAULT NULL,
  `status` int(11) DEFAULT NULL,
  `category` int(11) DEFAULT NULL,
  `type` int(11) DEFAULT NULL,
  `ref` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `patient` int(11) DEFAULT NULL,
  `dob` date DEFAULT NULL,
  `gender` int(11) DEFAULT NULL,
  `member_id` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `member_card` varchar(100) CHARACTER SET latin1 DEFAULT '',
  `principle` int(11) DEFAULT NULL,
  `relation` int(11) DEFAULT NULL,
  `client` int(11) DEFAULT NULL,
  `branch` int(11) DEFAULT NULL,
  `company` int(11) DEFAULT NULL,
  `policy_status` int(11) DEFAULT NULL,
  `policy_no` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `policy_effective_date` datetime DEFAULT NULL,
  `policy_expiry_date` datetime DEFAULT NULL,
  `policy_issue_date` datetime DEFAULT NULL,
  `policy_declare_date` datetime DEFAULT NULL,
  `policy_lapse_date` datetime DEFAULT NULL,
  `policy_revival_date` datetime DEFAULT NULL,
  `policy_termination_date` datetime DEFAULT NULL,
  `special_condition` varchar(300) CHARACTER SET latin1 DEFAULT '',
  `program` int(11) DEFAULT NULL,
  `plan` int(11) DEFAULT NULL,
  `plan_attach_date` datetime DEFAULT NULL,
  `plan_expiry_date` datetime DEFAULT NULL,
  `rider` int(11) DEFAULT NULL,
  `rider_attach_date` datetime DEFAULT NULL,
  `rider_expiry_date` datetime DEFAULT NULL,
  `provider` int(11) DEFAULT NULL,
  `other_provider` varchar(75) CHARACTER SET latin1 DEFAULT '',
  `currency_01` int(11) DEFAULT NULL,
  `currency_02` int(11) DEFAULT NULL,
  `currency_rate` decimal(20,15) DEFAULT NULL,
  `admission_date` date DEFAULT NULL,
  `admission_time` time DEFAULT NULL,
  `admission_doctor` varchar(75) CHARACTER SET latin1 DEFAULT '',
  `symptom` varchar(75) CHARACTER SET latin1 DEFAULT '',
  `symptom_since` date DEFAULT NULL,
  `vital_sign` varchar(75) CHARACTER SET latin1 DEFAULT '',
  `initial_diagnosis` varchar(75) CHARACTER SET latin1 DEFAULT '',
  `treatment_plan` varchar(75) CHARACTER SET latin1 DEFAULT '',
  `upload_haf` varchar(150) CHARACTER SET latin1 DEFAULT '',
  `haf_uploaded_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `haf_upload_date` datetime DEFAULT NULL,
  `upload_doc` varchar(150) CHARACTER SET latin1 DEFAULT '',
  `doc_uploaded_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `doc_upload_date` datetime DEFAULT NULL,
  `haf_doc_completed` int(11) DEFAULT NULL,
  `haf_doc_completed_remarks` varchar(300) CHARACTER SET latin1 DEFAULT '',
  `haf_doc_completed_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `haf_doc_completed_date` datetime DEFAULT NULL,
  `issue_initial_log` int(11) DEFAULT NULL,
  `initial_log_issued_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `initial_log_issue_date` datetime DEFAULT NULL,
  `initial_claim_no` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `initial_log_approval` int(11) DEFAULT NULL,
  `discharge_date` datetime DEFAULT NULL,
  `discharge_doctor` varchar(75) CHARACTER SET latin1 DEFAULT '',
  `actual_treatment` varchar(150) CHARACTER SET latin1 DEFAULT '',
  `diagnosis` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `other_diagnosis` varchar(300) CHARACTER SET latin1 DEFAULT '',
  `upload_bill` varchar(150) CHARACTER SET latin1 DEFAULT '',
  `bill_uploaded_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `bill_upload_date` datetime DEFAULT NULL,
  `bill_completed` int(11) DEFAULT NULL,
  `bill_completed_remarks` varchar(300) CHARACTER SET latin1 DEFAULT '',
  `bill_completed_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `bill_completed_date` datetime DEFAULT NULL,
  `ws_type` int(11) DEFAULT NULL,
  `ws_option` int(11) DEFAULT NULL,
  `ws_link` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `ws_link_01` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `ws_finished` int(11) DEFAULT NULL,
  `ws_finished_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `ws_finished_date` datetime DEFAULT NULL,
  `ws_approval` int(11) DEFAULT NULL,
  `ws_approval_remarks` varchar(300) CHARACTER SET latin1 DEFAULT '',
  `ws_approval_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `ws_approval_date` datetime DEFAULT NULL,
  `issuance_limit` decimal(20,2) DEFAULT NULL,
  `issue_log` int(11) DEFAULT NULL,
  `issue_log_option` int(11) DEFAULT NULL,
  `log_issued_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `log_issue_date` datetime DEFAULT NULL,
  `claim_no` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `log_approval` int(11) DEFAULT NULL,
  `nonlog_reason` varchar(600) CHARACTER SET latin1 DEFAULT '',
  `nonlog_remarks` varchar(300) CHARACTER SET latin1 DEFAULT '',
  `bill_no` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `bill_issue_date` datetime DEFAULT NULL,
  `bill_due_date` datetime DEFAULT NULL,
  `upload_original_bill` varchar(150) CHARACTER SET latin1 DEFAULT '',
  `original_bill_uploaded_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `original_bill_upload_date` datetime DEFAULT NULL,
  `original_bill_checked` int(11) DEFAULT NULL,
  `original_bill_checked_remarks` varchar(300) CHARACTER SET latin1 DEFAULT '',
  `original_bill_checked_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `original_bill_checked_date` datetime DEFAULT NULL,
  `close_case_option` int(11) DEFAULT NULL,
  `original_bill_verified` int(11) DEFAULT NULL,
  `original_bill_verified_remarks` varchar(300) CHARACTER SET latin1 DEFAULT '',
  `original_bill_verified_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `original_bill_verified_date` datetime DEFAULT NULL,
  `payment_date` datetime DEFAULT NULL,
  `paid_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `upload_proof_of_payment` varchar(150) CHARACTER SET latin1 DEFAULT '',
  `doc_send_back_to_client_required` int(11) DEFAULT NULL,
  `doc_send_back_to_client_date` datetime DEFAULT NULL,
  `doc_received_by_client_date` datetime DEFAULT NULL,
  `edited_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `edit_date` datetime DEFAULT NULL,
  `userlevel` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `caseSort` (`patient`,`member_id`,`principle`,`client`,`program`,`plan`,`currency_01`,`ws_finished_by`,`ws_approval_by`,`admission_date`,`discharge_date`,`ws_approval_date`,`ws_finished_date`,`policy_no`,`status`,`ref`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for ch_detail
-- ----------------------------
DROP TABLE IF EXISTS `ch_detail`;
CREATE TABLE `ch_detail` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `claim_ref` varchar(255) DEFAULT NULL,
  `plan_id` varchar(255) DEFAULT NULL,
  `policy_no` varchar(255) DEFAULT NULL,
  `benefit_code` varchar(255) DEFAULT NULL,
  `benefit_desc` varchar(900) DEFAULT '',
  `actual` int(11) DEFAULT NULL,
  `cover` int(11) DEFAULT NULL,
  `excess` int(11) DEFAULT NULL,
  `remarks` varchar(255) DEFAULT NULL,
  `plan_header_id` int(11) DEFAULT NULL,
  `plan_detail_id` int(11) DEFAULT NULL,
  `status` int(11) DEFAULT 0,
  `process_date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=17467 DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for ch_header
-- ----------------------------
DROP TABLE IF EXISTS `ch_header`;
CREATE TABLE `ch_header` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `policy_no` varchar(255) DEFAULT NULL,
  `member_name` varchar(255) DEFAULT NULL,
  `member_id` varchar(255) DEFAULT NULL,
  `claim_type` varchar(255) DEFAULT NULL,
  `claim_ref` varchar(255) DEFAULT '',
  `hospital_name` varchar(255) DEFAULT NULL,
  `admission_date` date DEFAULT NULL,
  `discharge_date` date DEFAULT NULL,
  `duration_days` int(11) DEFAULT NULL,
  `plan_id` varchar(255) DEFAULT NULL,
  `plan_desc` varchar(255) DEFAULT NULL,
  `actual` int(11) DEFAULT NULL,
  `cover` int(11) DEFAULT NULL,
  `excess` int(11) DEFAULT NULL,
  `diagnosa` varchar(255) DEFAULT NULL,
  `client` int(11) DEFAULT NULL,
  `remarks` varchar(255) DEFAULT NULL,
  `status` int(11) DEFAULT 1,
  `process_date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=6563 DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for claim_balancer_detail
-- ----------------------------
DROP TABLE IF EXISTS `claim_balancer_detail`;
CREATE TABLE `claim_balancer_detail` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `claim_ref` varchar(255) DEFAULT NULL,
  `benefit_code` varchar(11) DEFAULT '',
  `benefit_desc` varchar(255) DEFAULT NULL,
  `actual` int(11) DEFAULT NULL,
  `cover` int(11) DEFAULT NULL,
  `excess` int(11) DEFAULT NULL,
  `header` int(11) DEFAULT NULL,
  `detail` int(11) DEFAULT NULL,
  `status` int(11) DEFAULT 0,
  `process_date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2488 DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for claim_balancer_header
-- ----------------------------
DROP TABLE IF EXISTS `claim_balancer_header`;
CREATE TABLE `claim_balancer_header` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `client` int(11) DEFAULT NULL,
  `patient` int(11) DEFAULT NULL,
  `claim_type` int(11) DEFAULT NULL,
  `claim_ref` varchar(255) DEFAULT NULL,
  `hospital` int(255) DEFAULT NULL,
  `other_hospital` varchar(255) DEFAULT NULL,
  `admission_date` date DEFAULT NULL,
  `discharge_date` date DEFAULT NULL,
  `diagnosa` varchar(255) DEFAULT NULL,
  `status` int(11) DEFAULT 0,
  `remarks` varchar(255) DEFAULT NULL,
  `process_date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2488 DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for daily_aiaf
-- ----------------------------
DROP TABLE IF EXISTS `daily_aiaf`;
CREATE TABLE `daily_aiaf` (
  `claim_no` varchar(50) NOT NULL DEFAULT '',
  `sequence_no` varchar(50) NOT NULL DEFAULT '',
  `pre_/_post-hosp_claim_no` varchar(50) DEFAULT '',
  `id` int(11) DEFAULT NULL,
  `policy_no` varchar(50) DEFAULT '',
  `client_no` varchar(50) DEFAULT '',
  `policy_insured` varchar(75) DEFAULT '',
  `product_code` varchar(50) DEFAULT '',
  `branch_code` varchar(50) DEFAULT '',
  `branch_desc` varchar(50) DEFAULT '',
  `date_of_submit` varchar(50) DEFAULT '',
  `claim_type` varchar(50) DEFAULT '',
  `date_of_admission` varchar(50) DEFAULT '',
  `date_of_released` varchar(50) DEFAULT '',
  `name_of_hospital` varchar(250) DEFAULT '',
  `cause_of_claim` varchar(50) DEFAULT '',
  `claim_incurred` decimal(20,2) DEFAULT NULL,
  `currency` int(11) DEFAULT NULL,
  `claim_status` int(11) DEFAULT NULL,
  `claim_accepted` decimal(20,2) DEFAULT NULL,
  `amount_paid` decimal(20,2) DEFAULT NULL,
  `amount_reject` decimal(20,2) DEFAULT NULL,
  `paid_to` varchar(600) DEFAULT '',
  `account_no` varchar(150) DEFAULT '',
  `name_of_bank` varchar(50) DEFAULT '',
  `bank_branch` varchar(50) DEFAULT '',
  `city` varchar(50) DEFAULT '',
  `date_of_reject` varchar(50) DEFAULT '',
  `date_of_complete` varchar(50) DEFAULT '',
  `claim_note` varchar(50) DEFAULT '',
  `remarks` varchar(900) DEFAULT '',
  `rcd_policy` varchar(50) DEFAULT '',
  `date_of_reinstatement` varchar(50) DEFAULT '',
  `old_plan` varchar(50) DEFAULT '',
  `old_plan_rcd` varchar(50) DEFAULT '',
  `active_plan` varchar(50) DEFAULT '',
  `active_plan_rcd` varchar(50) DEFAULT '',
  `active_plan_status` varchar(50) DEFAULT '',
  `days_approved` int(11) DEFAULT NULL,
  `filter_01` date DEFAULT NULL,
  `case` int(11) DEFAULT NULL,
  PRIMARY KEY (`claim_no`,`sequence_no`),
  KEY `index_daily_aiaf` (`claim_no`,`policy_no`,`policy_insured`,`filter_01`,`case`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;

-- ----------------------------
-- Table structure for daily_aiaf_prod
-- ----------------------------
DROP TABLE IF EXISTS `daily_aiaf_prod`;
CREATE TABLE `daily_aiaf_prod` (
  `claim_no` varchar(50) NOT NULL DEFAULT '',
  `sequence_no` varchar(50) NOT NULL DEFAULT '',
  `pre_/_post-hosp_claim_no` varchar(50) DEFAULT '',
  `id` int(11) DEFAULT NULL,
  `policy_no` varchar(50) DEFAULT '',
  `client_no` varchar(50) DEFAULT '',
  `policy_insured` varchar(75) DEFAULT '',
  `product_code` varchar(50) DEFAULT '',
  `branch_code` varchar(50) DEFAULT '',
  `branch_desc` varchar(50) DEFAULT '',
  `date_of_submit` varchar(50) DEFAULT '',
  `claim_type` varchar(50) DEFAULT '',
  `date_of_admission` varchar(50) DEFAULT '',
  `date_of_released` varchar(50) DEFAULT '',
  `name_of_hospital` varchar(250) DEFAULT '',
  `cause_of_claim` varchar(50) DEFAULT '',
  `claim_incurred` int(11) DEFAULT NULL,
  `currency` int(11) DEFAULT NULL,
  `claim_status` int(11) DEFAULT NULL,
  `claim_accepted` int(11) DEFAULT NULL,
  `amount_paid` int(11) DEFAULT NULL,
  `amount_reject` int(11) DEFAULT NULL,
  `paid_to` varchar(600) DEFAULT '',
  `account_no` varchar(50) DEFAULT '',
  `name_of_bank` varchar(50) DEFAULT '',
  `bank_branch` varchar(50) DEFAULT '',
  `city` varchar(50) DEFAULT '',
  `date_of_reject` varchar(50) DEFAULT '',
  `date_of_complete` varchar(50) DEFAULT '',
  `claim_note` varchar(50) DEFAULT '',
  `remarks` varchar(900) DEFAULT '',
  `rcd_policy` varchar(50) DEFAULT '',
  `date_of_reinstatement` varchar(50) DEFAULT '',
  `old_plan` varchar(50) DEFAULT '',
  `old_plan_rcd` varchar(50) DEFAULT '',
  `active_plan` varchar(50) DEFAULT '',
  `active_plan_rcd` varchar(50) DEFAULT '',
  `active_plan_status` varchar(50) DEFAULT '',
  `days_approved` int(11) DEFAULT NULL,
  `filter_01` date DEFAULT NULL,
  `case` int(11) DEFAULT NULL,
  PRIMARY KEY (`claim_no`,`sequence_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;

-- ----------------------------
-- Table structure for daily_aiaf_temp
-- ----------------------------
DROP TABLE IF EXISTS `daily_aiaf_temp`;
CREATE TABLE `daily_aiaf_temp` (
  `CORRECTION` varchar(255) DEFAULT NULL,
  `CLAIM_NO` varchar(50) NOT NULL DEFAULT '',
  `SEQUENCE_NO` varchar(50) NOT NULL DEFAULT '',
  `PRE_/_POST-HOSP_CLAIM_NO` varchar(50) DEFAULT '',
  `id` int(11) DEFAULT NULL,
  `POLICY_NO` varchar(50) DEFAULT '',
  `CLIENT_NO` varchar(50) DEFAULT '',
  `POLICY_INSURED` varchar(75) DEFAULT '',
  `PRODUCT_CODE` varchar(50) DEFAULT '',
  `BRANCH_CODE` varchar(50) DEFAULT '',
  `BRANCH_DESC` varchar(50) DEFAULT '',
  `DATE_OF_SUBMIT` varchar(50) DEFAULT '',
  `CLAIM_TYPE` varchar(50) DEFAULT '',
  `DATE_OF_ADMISSION` varchar(50) DEFAULT '',
  `DATE_OF_RELEASED` varchar(50) DEFAULT '',
  `NAME_OF_HOSPITAL` varchar(250) DEFAULT '',
  `CAUSE_OF_CLAIM` varchar(50) DEFAULT '',
  `CLAIM_INCURRED` decimal(20,2) DEFAULT NULL,
  `CURRENCY` int(11) DEFAULT NULL,
  `CLAIM_STATUS` int(11) DEFAULT NULL,
  `CLAIM_ACCEPTED` decimal(20,2) DEFAULT NULL,
  `AMOUNT_PAID` decimal(20,2) DEFAULT NULL,
  `AMOUNT_REJECT` decimal(20,2) DEFAULT NULL,
  `PAID_TO` varchar(600) DEFAULT NULL,
  `ACCOUNT_NO` varchar(150) DEFAULT NULL,
  `NAME_OF_BANK` varchar(50) DEFAULT NULL,
  `BANK_BRANCH` varchar(50) DEFAULT '',
  `CITY` varchar(50) DEFAULT NULL,
  `DATE_OF_REJECT` varchar(50) DEFAULT NULL,
  `DATE_OF_COMPLETE` varchar(50) DEFAULT NULL,
  `CLAIM_NOTE` varchar(50) DEFAULT NULL,
  `REMARKS` varchar(900) DEFAULT NULL,
  `RCD_POLICY` varchar(50) DEFAULT NULL,
  `DATE_OF_REINSTATEMENT` varchar(50) DEFAULT NULL,
  `OLD_PLAN` varchar(50) DEFAULT NULL,
  `OLD_PLAN_RCD` varchar(50) DEFAULT NULL,
  `ACTIVE_PLAN` varchar(50) DEFAULT NULL,
  `ACTIVE_PLAN_RCD` varchar(50) DEFAULT NULL,
  `ACTIVE_PLAN_STATUS` varchar(50) DEFAULT NULL,
  `DAYS_APPROVED` int(11) DEFAULT NULL,
  `FILTER_01` date DEFAULT NULL,
  `CASE` int(11) DEFAULT NULL,
  `STATUS` int(11) DEFAULT NULL,
  PRIMARY KEY (`CLAIM_NO`,`SEQUENCE_NO`),
  KEY `index_daily_aiaf` (`CLAIM_NO`,`POLICY_NO`,`POLICY_INSURED`,`FILTER_01`,`CASE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;

-- ----------------------------
-- Table structure for daily_aiaf_temp_01
-- ----------------------------
DROP TABLE IF EXISTS `daily_aiaf_temp_01`;
CREATE TABLE `daily_aiaf_temp_01` (
  `CORRECTION` varchar(255) DEFAULT NULL,
  `CLAIM_NO` varchar(50) NOT NULL DEFAULT '',
  `SEQUENCE_NO` varchar(50) NOT NULL DEFAULT '',
  `PRE_/_POST-HOSP_CLAIM_NO` varchar(50) DEFAULT '',
  `id` int(11) DEFAULT NULL,
  `POLICY_NO` varchar(50) DEFAULT '',
  `CLIENT_NO` varchar(50) DEFAULT '',
  `POLICY_INSURED` varchar(75) DEFAULT '',
  `PRODUCT_CODE` varchar(50) DEFAULT '',
  `BRANCH_CODE` varchar(50) DEFAULT '',
  `BRANCH_DESC` varchar(50) DEFAULT '',
  `DATE_OF_SUBMIT` varchar(50) DEFAULT '',
  `CLAIM_TYPE` varchar(50) DEFAULT '',
  `DATE_OF_ADMISSION` varchar(50) DEFAULT '',
  `DATE_OF_RELEASED` varchar(50) DEFAULT '',
  `NAME_OF_HOSPITAL` varchar(250) DEFAULT '',
  `CAUSE_OF_CLAIM` varchar(50) DEFAULT '',
  `CLAIM_INCURRED` decimal(20,2) DEFAULT NULL,
  `CURRENCY` int(11) DEFAULT NULL,
  `CLAIM_STATUS` int(11) DEFAULT NULL,
  `CLAIM_ACCEPTED` decimal(20,2) DEFAULT NULL,
  `AMOUNT_PAID` decimal(20,2) DEFAULT NULL,
  `AMOUNT_REJECT` decimal(20,2) DEFAULT NULL,
  `PAID_TO` varchar(600) DEFAULT NULL,
  `ACCOUNT_NO` varchar(150) DEFAULT '',
  `NAME_OF_BANK` varchar(50) DEFAULT '',
  `BANK_BRANCH` varchar(50) DEFAULT '',
  `CITY` varchar(50) DEFAULT '',
  `DATE_OF_REJECT` varchar(50) DEFAULT '',
  `DATE_OF_COMPLETE` varchar(50) DEFAULT '',
  `CLAIM_NOTE` varchar(50) DEFAULT '',
  `REMARKS` varchar(900) DEFAULT '',
  `RCD_POLICY` varchar(50) DEFAULT '',
  `DATE_OF_REINSTATEMENT` varchar(50) DEFAULT '',
  `OLD_PLAN` varchar(50) DEFAULT '',
  `OLD_PLAN_RCD` varchar(50) DEFAULT '',
  `ACTIVE_PLAN` varchar(50) DEFAULT '',
  `ACTIVE_PLAN_RCD` varchar(50) DEFAULT '',
  `ACTIVE_PLAN_STATUS` varchar(50) DEFAULT '',
  `DAYS_APPROVED` int(11) DEFAULT NULL,
  `FILTER_01` date DEFAULT NULL,
  `STATUS` int(11) DEFAULT NULL,
  `CASE` int(11) DEFAULT NULL,
  PRIMARY KEY (`CLAIM_NO`,`SEQUENCE_NO`),
  KEY `index_daily_aiaf` (`CLAIM_NO`,`POLICY_NO`,`POLICY_INSURED`,`FILTER_01`,`CASE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;

-- ----------------------------
-- Table structure for daily_aiaf_tes
-- ----------------------------
DROP TABLE IF EXISTS `daily_aiaf_tes`;
CREATE TABLE `daily_aiaf_tes` (
  `claim_no` varchar(50) NOT NULL DEFAULT '',
  `sequence_no` varchar(50) NOT NULL DEFAULT '',
  `pre_/_post-hosp_claim_no` varchar(50) DEFAULT '',
  `id` int(11) DEFAULT NULL,
  `policy_no` varchar(50) DEFAULT '',
  `client_no` varchar(50) DEFAULT '',
  `policy_insured` varchar(75) DEFAULT '',
  `product_code` varchar(50) DEFAULT '',
  `branch_code` varchar(50) DEFAULT '',
  `branch_desc` varchar(50) DEFAULT '',
  `date_of_submit` varchar(50) DEFAULT '',
  `claim_type` varchar(50) DEFAULT '',
  `date_of_admission` varchar(50) DEFAULT '',
  `date_of_released` varchar(50) DEFAULT '',
  `name_of_hospital` varchar(250) DEFAULT '',
  `cause_of_claim` varchar(50) DEFAULT '',
  `claim_incurred` decimal(20,2) DEFAULT NULL,
  `currency` int(11) DEFAULT NULL,
  `claim_status` int(11) DEFAULT NULL,
  `claim_accepted` decimal(20,2) DEFAULT NULL,
  `amount_paid` decimal(20,2) DEFAULT NULL,
  `amount_reject` decimal(20,2) DEFAULT NULL,
  `paid_to` varchar(600) DEFAULT '',
  `account_no` varchar(150) DEFAULT '',
  `name_of_bank` varchar(50) DEFAULT '',
  `bank_branch` varchar(50) DEFAULT '',
  `city` varchar(50) DEFAULT '',
  `date_of_reject` varchar(50) DEFAULT '',
  `date_of_complete` varchar(50) DEFAULT '',
  `claim_note` varchar(50) DEFAULT '',
  `remarks` varchar(900) DEFAULT '',
  `rcd_policy` varchar(50) DEFAULT '',
  `date_of_reinstatement` varchar(50) DEFAULT '',
  `old_plan` varchar(50) DEFAULT '',
  `old_plan_rcd` varchar(50) DEFAULT '',
  `active_plan` varchar(50) DEFAULT '',
  `active_plan_rcd` varchar(50) DEFAULT '',
  `active_plan_status` varchar(50) DEFAULT '',
  `days_approved` int(11) DEFAULT NULL,
  `filter_01` date DEFAULT NULL,
  `case` int(11) DEFAULT NULL,
  PRIMARY KEY (`claim_no`,`sequence_no`),
  KEY `index_daily_aiaf` (`claim_no`,`policy_no`,`policy_insured`,`filter_01`,`case`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;

-- ----------------------------
-- Table structure for daily_aiaf_testing
-- ----------------------------
DROP TABLE IF EXISTS `daily_aiaf_testing`;
CREATE TABLE `daily_aiaf_testing` (
  `claim_no` varchar(50) NOT NULL DEFAULT '',
  `sequence_no` varchar(50) NOT NULL DEFAULT '',
  `pre_/_post-hosp_claim_no` varchar(50) DEFAULT '',
  `id` int(11) DEFAULT NULL,
  `policy_no` varchar(50) DEFAULT '',
  `client_no` varchar(50) DEFAULT '',
  `policy_insured` varchar(75) DEFAULT '',
  `product_code` varchar(50) DEFAULT '',
  `branch_code` varchar(50) DEFAULT '',
  `branch_desc` varchar(50) DEFAULT '',
  `date_of_submit` varchar(50) DEFAULT '',
  `claim_type` varchar(50) DEFAULT '',
  `date_of_admission` varchar(50) DEFAULT '',
  `date_of_released` varchar(50) DEFAULT '',
  `name_of_hospital` varchar(250) DEFAULT '',
  `cause_of_claim` varchar(50) DEFAULT '',
  `claim_incurred` decimal(20,2) DEFAULT NULL,
  `currency` int(11) DEFAULT NULL,
  `claim_status` int(11) DEFAULT NULL,
  `claim_accepted` decimal(20,2) DEFAULT NULL,
  `amount_paid` decimal(20,2) DEFAULT NULL,
  `amount_reject` decimal(20,2) DEFAULT NULL,
  `paid_to` varchar(600) DEFAULT '',
  `account_no` varchar(150) DEFAULT '',
  `name_of_bank` varchar(50) DEFAULT '',
  `bank_branch` varchar(50) DEFAULT '',
  `city` varchar(50) DEFAULT '',
  `date_of_reject` varchar(50) DEFAULT '',
  `date_of_complete` varchar(50) DEFAULT '',
  `claim_note` varchar(50) DEFAULT '',
  `remarks` varchar(900) DEFAULT '',
  `rcd_policy` varchar(50) DEFAULT '',
  `date_of_reinstatement` varchar(50) DEFAULT '',
  `old_plan` varchar(50) DEFAULT '',
  `old_plan_rcd` varchar(50) DEFAULT '',
  `active_plan` varchar(50) DEFAULT '',
  `active_plan_rcd` varchar(50) DEFAULT '',
  `active_plan_status` varchar(50) DEFAULT '',
  `days_approved` int(11) DEFAULT NULL,
  `filter_01` date DEFAULT NULL,
  `case` int(11) DEFAULT NULL,
  PRIMARY KEY (`claim_no`,`sequence_no`),
  KEY `index_daily_aiaf` (`claim_no`,`policy_no`,`policy_insured`,`filter_01`,`case`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;

-- ----------------------------
-- Table structure for gop_medical
-- ----------------------------
DROP TABLE IF EXISTS `gop_medical`;
CREATE TABLE `gop_medical` (
  `case` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL,
  `gop_no` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `provider` int(11) DEFAULT NULL,
  `other_provider` varchar(75) CHARACTER SET latin1 DEFAULT NULL,
  `tel` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `fax` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `email` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `attention` varchar(75) CHARACTER SET latin1 DEFAULT NULL,
  `admission_date` date DEFAULT NULL,
  `discharge_date` date DEFAULT NULL,
  `case_type` int(11) DEFAULT NULL,
  `case_description` varchar(255) CHARACTER SET latin1 DEFAULT NULL,
  `currency` int(11) DEFAULT NULL,
  `actual` decimal(20,2) DEFAULT NULL,
  `cover` decimal(20,2) DEFAULT NULL,
  `excess` decimal(20,2) DEFAULT NULL,
  `original_bill_receive_date` date DEFAULT NULL,
  `verified` int(11) DEFAULT NULL,
  `verified_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `verify_date` datetime DEFAULT NULL,
  `send_to_billing` int(11) DEFAULT NULL,
  `send_to_billing_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `send_to_billing_date` datetime DEFAULT NULL,
  `invoiced` int(11) DEFAULT NULL,
  `invoiced_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `invoice_date` datetime DEFAULT NULL,
  `payment_status` int(11) DEFAULT NULL,
  `paid_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `payment_date` datetime DEFAULT NULL,
  `created_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `create_date` datetime DEFAULT NULL,
  `edited_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `edit_date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `gop_medical_index` (`case`,`gop_no`,`provider`,`admission_date`,`discharge_date`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for gop_travel
-- ----------------------------
DROP TABLE IF EXISTS `gop_travel`;
CREATE TABLE `gop_travel` (
  `case` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL,
  `gop_no` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `provider` int(11) DEFAULT NULL,
  `other_provider` varchar(75) CHARACTER SET latin1 DEFAULT NULL,
  `tel` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `fax` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `email` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `attention` varchar(75) CHARACTER SET latin1 DEFAULT NULL,
  `admission_date` date DEFAULT NULL,
  `discharge_date` date DEFAULT NULL,
  `case_type` int(11) DEFAULT NULL,
  `case_description` varchar(255) CHARACTER SET latin1 DEFAULT NULL,
  `currency` int(11) DEFAULT NULL,
  `actual` decimal(20,2) DEFAULT NULL,
  `cover` decimal(20,2) DEFAULT NULL,
  `excess` decimal(20,2) DEFAULT NULL,
  `verified` int(11) DEFAULT NULL,
  `verified_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `verify_date` datetime DEFAULT NULL,
  `send_to_billing` int(11) DEFAULT NULL,
  `send_to_billing_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `send_to_billing_date` datetime DEFAULT NULL,
  `invoiced` int(11) DEFAULT NULL,
  `invoiced_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `invoice_date` datetime DEFAULT NULL,
  `payment_status` int(11) DEFAULT NULL,
  `paid_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `payment_date` datetime DEFAULT NULL,
  `created_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `create_date` datetime DEFAULT NULL,
  `edited_by` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `edit_date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for holiday
-- ----------------------------
DROP TABLE IF EXISTS `holiday`;
CREATE TABLE `holiday` (
  `id` bigint(32) unsigned NOT NULL AUTO_INCREMENT,
  `hday` date NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;

-- ----------------------------
-- Table structure for log_attachment
-- ----------------------------
DROP TABLE IF EXISTS `log_attachment`;
CREATE TABLE `log_attachment` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `subject` varchar(255) DEFAULT NULL,
  `generate_date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=331 DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for log_automation
-- ----------------------------
DROP TABLE IF EXISTS `log_automation`;
CREATE TABLE `log_automation` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `client` int(11) DEFAULT NULL,
  `category` int(11) DEFAULT NULL,
  `type` int(11) DEFAULT NULL,
  `name` varchar(500) COLLATE utf8_unicode_ci DEFAULT NULL,
  `method` int(11) DEFAULT NULL,
  `code` varchar(500) COLLATE utf8_unicode_ci DEFAULT NULL,
  `process_date` date DEFAULT NULL,
  `send_date` datetime DEFAULT NULL,
  `status` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  `remarks` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=24921 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- ----------------------------
-- Table structure for log_page_analytic
-- ----------------------------
DROP TABLE IF EXISTS `log_page_analytic`;
CREATE TABLE `log_page_analytic` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `url` text DEFAULT NULL,
  `name` text DEFAULT NULL,
  `loading_time` int(11) DEFAULT NULL,
  `created_date` datetime DEFAULT NULL,
  `flag` int(2) DEFAULT 1,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5729417 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Table structure for log_upload_module
-- ----------------------------
DROP TABLE IF EXISTS `log_upload_module`;
CREATE TABLE `log_upload_module` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `batch` int(11) DEFAULT NULL,
  `code` varchar(255) DEFAULT NULL,
  `case` int(11) DEFAULT NULL,
  `obv_date` datetime DEFAULT NULL,
  `obv_by` varchar(255) DEFAULT NULL,
  `payment_date` date DEFAULT NULL,
  `upload_proof_of_payment` varchar(255) DEFAULT NULL,
  `client_approval_for_payment` date DEFAULT NULL,
  `paid_by` varchar(255) DEFAULT NULL,
  `remarks` text DEFAULT NULL,
  `process_date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=282457 DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for provider_kemenkes
-- ----------------------------
DROP TABLE IF EXISTS `provider_kemenkes`;
CREATE TABLE `provider_kemenkes` (
  `kode` varchar(11) DEFAULT '',
  `tgl_registrasi` date DEFAULT NULL,
  `nama` varchar(255) DEFAULT NULL,
  `type` varchar(255) DEFAULT NULL,
  `jenis` varchar(255) DEFAULT NULL,
  `kls` varchar(255) DEFAULT NULL,
  `direktur` varchar(255) DEFAULT NULL,
  `alamat` varchar(255) DEFAULT NULL,
  `penyelenggara` varchar(255) DEFAULT NULL,
  `kota` varchar(255) DEFAULT NULL,
  `kode_pos` int(11) DEFAULT NULL,
  `telepon` varchar(255) DEFAULT NULL,
  `fax` varchar(255) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for provider_mail
-- ----------------------------
DROP TABLE IF EXISTS `provider_mail`;
CREATE TABLE `provider_mail` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `provider` int(11) NOT NULL,
  `email` varchar(75) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for worksheet_log
-- ----------------------------
DROP TABLE IF EXISTS `worksheet_log`;
CREATE TABLE `worksheet_log` (
  `case` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL,
  `program` int(11) DEFAULT NULL,
  `plan` int(11) DEFAULT NULL,
  `header` int(11) DEFAULT NULL,
  `detail` int(11) DEFAULT NULL,
  `day` decimal(20,2) DEFAULT NULL,
  `day_rate` decimal(20,2) DEFAULT NULL,
  `actual` decimal(20,2) DEFAULT NULL,
  `non_prorate` decimal(20,2) DEFAULT NULL,
  `prorate` decimal(20,2) DEFAULT NULL,
  `prorate_percent` decimal(20,15) DEFAULT NULL,
  `prorate_result` decimal(20,2) DEFAULT NULL,
  `exclusion` decimal(20,2) DEFAULT NULL,
  `remaining_deductible` decimal(20,2) DEFAULT NULL,
  `copayment` decimal(20,2) DEFAULT NULL,
  `remaining_day` decimal(20,2) DEFAULT NULL,
  `remaining_inner_limit` decimal(20,2) DEFAULT NULL,
  `remaining_annual_limit` decimal(20,2) DEFAULT NULL,
  `using_float_fund` int(11) DEFAULT NULL,
  `remaining_float_fund` decimal(20,2) DEFAULT NULL,
  `cash_benefit_availability` int(11) DEFAULT NULL,
  `cover` decimal(20,2) DEFAULT NULL,
  `excess` decimal(20,2) DEFAULT NULL,
  `deductible` decimal(20,2) DEFAULT NULL,
  `cash_benefit` decimal(20,2) DEFAULT NULL,
  `remarks` varchar(1500) CHARACTER SET latin1 DEFAULT '',
  `remarks_01` varchar(1500) CHARACTER SET latin1 DEFAULT NULL,
  `created_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `create_date` datetime DEFAULT NULL,
  `edited_by` varchar(50) CHARACTER SET latin1 DEFAULT '',
  `edit_date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `wsSort` (`case`,`program`,`plan`,`header`,`detail`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- View structure for activity_log_max
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_max`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `activity_log_max` AS select max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`case` AS `case` from `his-tpa`.`activity_log` group by `his-tpa`.`activity_log`.`case` order by NULL ;

-- ----------------------------
-- View structure for activity_log_status_08
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_status_08`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `activity_log_status_08` AS select `his-tpa`.`activity_log`.`case` AS `case`,max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`datetime` AS `datetime`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,`his-tpa`.`activity_log`.`contact_info` AS `contact_info`,`his-tpa`.`activity_log`.`contact_person` AS `contact_person`,`his-tpa`.`activity_log`.`description` AS `description`,`his-tpa`.`activity_log`.`status` AS `status`,`his-tpa`.`activity_log`.`created_by` AS `created_by`,`his-tpa`.`activity_log`.`create_date` AS `create_date`,`his-tpa`.`activity_log`.`edited_by` AS `edited_by`,`his-tpa`.`activity_log`.`edit_date` AS `edit_date` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 99 and `his-tpa`.`activity_log`.`status` = 8 group by `his-tpa`.`activity_log`.`case`,`his-tpa`.`activity_log`.`contact_type`,`his-tpa`.`activity_log`.`status` ;

-- ----------------------------
-- View structure for activity_log_status_09
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_status_09`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `activity_log_status_09` AS select `his-tpa`.`activity_log`.`case` AS `case`,max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`datetime` AS `datetime`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,`his-tpa`.`activity_log`.`contact_info` AS `contact_info`,`his-tpa`.`activity_log`.`contact_person` AS `contact_person`,`his-tpa`.`activity_log`.`description` AS `description`,`his-tpa`.`activity_log`.`status` AS `status`,`his-tpa`.`activity_log`.`created_by` AS `created_by`,`his-tpa`.`activity_log`.`create_date` AS `create_date`,`his-tpa`.`activity_log`.`edited_by` AS `edited_by`,`his-tpa`.`activity_log`.`edit_date` AS `edit_date` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 99 and `his-tpa`.`activity_log`.`status` = 9 group by `his-tpa`.`activity_log`.`case`,`his-tpa`.`activity_log`.`contact_type`,`his-tpa`.`activity_log`.`status` ;

-- ----------------------------
-- View structure for activity_log_status_10
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_status_10`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `activity_log_status_10` AS select `his-tpa`.`activity_log`.`case` AS `case`,max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`datetime` AS `datetime`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,`his-tpa`.`activity_log`.`contact_info` AS `contact_info`,`his-tpa`.`activity_log`.`contact_person` AS `contact_person`,`his-tpa`.`activity_log`.`description` AS `description`,`his-tpa`.`activity_log`.`status` AS `status`,`his-tpa`.`activity_log`.`created_by` AS `created_by`,`his-tpa`.`activity_log`.`create_date` AS `create_date`,`his-tpa`.`activity_log`.`edited_by` AS `edited_by`,`his-tpa`.`activity_log`.`edit_date` AS `edit_date` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 99 and `his-tpa`.`activity_log`.`status` = 10 group by `his-tpa`.`activity_log`.`case`,`his-tpa`.`activity_log`.`contact_type`,`his-tpa`.`activity_log`.`status` ;

-- ----------------------------
-- View structure for activity_log_status_13
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_status_13`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `activity_log_status_13` AS select `his-tpa`.`activity_log`.`case` AS `case`,max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`datetime` AS `datetime`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,`his-tpa`.`activity_log`.`contact_info` AS `contact_info`,`his-tpa`.`activity_log`.`contact_person` AS `contact_person`,`his-tpa`.`activity_log`.`description` AS `description`,`his-tpa`.`activity_log`.`status` AS `status`,`his-tpa`.`activity_log`.`created_by` AS `created_by`,`his-tpa`.`activity_log`.`create_date` AS `create_date`,`his-tpa`.`activity_log`.`edited_by` AS `edited_by`,`his-tpa`.`activity_log`.`edit_date` AS `edit_date` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 99 and `his-tpa`.`activity_log`.`status` = 13 group by `his-tpa`.`activity_log`.`case`,`his-tpa`.`activity_log`.`contact_type`,`his-tpa`.`activity_log`.`status` ;

-- ----------------------------
-- View structure for activity_log_status_14
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_status_14`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `activity_log_status_14` AS select `his-tpa`.`activity_log`.`case` AS `case`,max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`datetime` AS `datetime`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,`his-tpa`.`activity_log`.`contact_info` AS `contact_info`,`his-tpa`.`activity_log`.`contact_person` AS `contact_person`,`his-tpa`.`activity_log`.`description` AS `description`,`his-tpa`.`activity_log`.`status` AS `status`,`his-tpa`.`activity_log`.`created_by` AS `created_by`,`his-tpa`.`activity_log`.`create_date` AS `create_date`,`his-tpa`.`activity_log`.`edited_by` AS `edited_by`,`his-tpa`.`activity_log`.`edit_date` AS `edit_date` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 99 and `his-tpa`.`activity_log`.`status` = 14 group by `his-tpa`.`activity_log`.`case`,`his-tpa`.`activity_log`.`contact_type`,`his-tpa`.`activity_log`.`status` ;

-- ----------------------------
-- View structure for activity_log_status_15
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_status_15`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `activity_log_status_15` AS select `his-tpa`.`activity_log`.`case` AS `case`,max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`datetime` AS `datetime`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,`his-tpa`.`activity_log`.`contact_info` AS `contact_info`,`his-tpa`.`activity_log`.`contact_person` AS `contact_person`,`his-tpa`.`activity_log`.`description` AS `description`,`his-tpa`.`activity_log`.`status` AS `status`,`his-tpa`.`activity_log`.`created_by` AS `created_by`,`his-tpa`.`activity_log`.`create_date` AS `create_date`,`his-tpa`.`activity_log`.`edited_by` AS `edited_by`,`his-tpa`.`activity_log`.`edit_date` AS `edit_date` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 99 and `his-tpa`.`activity_log`.`status` = 15 group by `his-tpa`.`activity_log`.`case`,`his-tpa`.`activity_log`.`contact_type`,`his-tpa`.`activity_log`.`status` ;

-- ----------------------------
-- View structure for activity_log_status_23
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_status_23`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `activity_log_status_23` AS select `his-tpa`.`activity_log`.`case` AS `case`,max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`datetime` AS `datetime`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,`his-tpa`.`activity_log`.`contact_info` AS `contact_info`,`his-tpa`.`activity_log`.`contact_person` AS `contact_person`,`his-tpa`.`activity_log`.`description` AS `description`,`his-tpa`.`activity_log`.`status` AS `status`,`his-tpa`.`activity_log`.`created_by` AS `created_by`,`his-tpa`.`activity_log`.`create_date` AS `create_date`,`his-tpa`.`activity_log`.`edited_by` AS `edited_by`,`his-tpa`.`activity_log`.`edit_date` AS `edit_date` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 99 and `his-tpa`.`activity_log`.`status` = 21 group by `his-tpa`.`activity_log`.`case`,`his-tpa`.`activity_log`.`contact_type`,`his-tpa`.`activity_log`.`status` ;

-- ----------------------------
-- View structure for activity_log_status_24
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_status_24`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `activity_log_status_24` AS select `his-tpa`.`activity_log`.`case` AS `case`,max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`datetime` AS `datetime`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,`his-tpa`.`activity_log`.`contact_info` AS `contact_info`,`his-tpa`.`activity_log`.`contact_person` AS `contact_person`,`his-tpa`.`activity_log`.`description` AS `description`,`his-tpa`.`activity_log`.`status` AS `status`,`his-tpa`.`activity_log`.`created_by` AS `created_by`,`his-tpa`.`activity_log`.`create_date` AS `create_date`,`his-tpa`.`activity_log`.`edited_by` AS `edited_by`,`his-tpa`.`activity_log`.`edit_date` AS `edit_date` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 99 and `his-tpa`.`activity_log`.`status` = 22 group by `his-tpa`.`activity_log`.`case`,`his-tpa`.`activity_log`.`contact_type`,`his-tpa`.`activity_log`.`status` ;

-- ----------------------------
-- View structure for activity_log_status_25
-- ----------------------------
DROP VIEW IF EXISTS `activity_log_status_25`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `activity_log_status_25` AS select `his-tpa`.`activity_log`.`case` AS `case`,max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`datetime` AS `datetime`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,`his-tpa`.`activity_log`.`contact_info` AS `contact_info`,`his-tpa`.`activity_log`.`contact_person` AS `contact_person`,`his-tpa`.`activity_log`.`description` AS `description`,`his-tpa`.`activity_log`.`status` AS `status`,`his-tpa`.`activity_log`.`created_by` AS `created_by`,`his-tpa`.`activity_log`.`create_date` AS `create_date`,`his-tpa`.`activity_log`.`edited_by` AS `edited_by`,`his-tpa`.`activity_log`.`edit_date` AS `edit_date` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 99 and `his-tpa`.`activity_log`.`status` = 23 group by `his-tpa`.`activity_log`.`case`,`his-tpa`.`activity_log`.`contact_type`,`his-tpa`.`activity_log`.`status` ;

-- ----------------------------
-- View structure for aiaf_provider
-- ----------------------------
DROP VIEW IF EXISTS `aiaf_provider`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `aiaf_provider` AS select `his-tpa`.`case`.`id` AS `case`,`her-tpa`.`daily_aiaf`.`name_of_hospital` AS `name_of_hospital`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`case`.`other_provider_city` AS `other_provider_city`,`his-tpa`.`country`.`name` AS `other_provider_country`,`his-tpa`.`case`.`other_provider_country` AS `other_provider_country_01`,`provider`.`full_name` AS `full_name`,`her-tpa`.`daily_aiaf`.`filter_01` AS `filter_01`,concat(`her-tpa`.`daily_aiaf`.`claim_no`,`her-tpa`.`daily_aiaf`.`sequence_no`) AS `KEY` from (((`her-tpa`.`daily_aiaf` join `his-tpa`.`case` on(`his-tpa`.`case`.`id` = `her-tpa`.`daily_aiaf`.`case`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) left join `his-tpa`.`country` on(`his-tpa`.`country`.`id` = `his-tpa`.`case`.`other_provider_country`)) where `her-tpa`.`daily_aiaf`.`filter_01` = curdate() - interval 1 day and `his-tpa`.`case`.`provider` in (310,2417,2462) ;

-- ----------------------------
-- View structure for aiaf_provider_01
-- ----------------------------
DROP VIEW IF EXISTS `aiaf_provider_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `aiaf_provider_01` AS select `her-tpa`.`daily_aiaf`.`case` AS `id`,`her-tpa`.`daily_aiaf`.`claim_no` AS `claim_no`,`her-tpa`.`daily_aiaf`.`sequence_no` AS `sequence_no`,`her-tpa`.`daily_aiaf`.`name_of_hospital` AS `name_of_hospital`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`case`.`other_provider_city` AS `other_provider_city`,`his-tpa`.`country`.`name` AS `other_provider_country`,`his-tpa`.`case`.`other_provider_country` AS `other_provider_country_01`,`provider`.`full_name` AS `full_name`,`her-tpa`.`daily_aiaf`.`filter_01` AS `filter_01` from (((`her-tpa`.`daily_aiaf` join `his-tpa`.`case` on(`his-tpa`.`case`.`id` = `her-tpa`.`daily_aiaf`.`case`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) left join `his-tpa`.`country` on(`his-tpa`.`country`.`id` = `his-tpa`.`case`.`other_provider_country`)) where `her-tpa`.`daily_aiaf`.`filter_01` = curdate() - interval 1 day and `his-tpa`.`case`.`provider` in (310,2417,2462) ;

-- ----------------------------
-- View structure for approved_claim
-- ----------------------------
DROP VIEW IF EXISTS `approved_claim`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `approved_claim` AS select coalesce(`his-tpa`.`case`.`create_date_01`,`his-tpa`.`case`.`create_date`) AS `RECEIVED_DATE`,`client`.`id` AS `CLIENT_ID`,`client`.`full_name` AS `CLIENT_NAME`,`his-tpa`.`case`.`policy_no` AS `POLICY_NO`,`his-tpa`.`case`.`policy_effective_date` AS `POLICY_EFFECTIVE_DATE`,`his-tpa`.`case`.`policy_expiry_date` AS `POLICY_EXPIRY_DATE`,case `his-tpa`.`case`.`policy_status` when 0 then 'Disable' when 1 then 'Enable' else 'N/A' end AS `POLICY_STATUS`,`his-tpa`.`case`.`member_id` AS `MEMBER_ID`,`his-tpa`.`case`.`member_card` AS `MEMBER_CARD`,`his-tpa`.`program`.`name` AS `PROGRAM`,`plan_tmli`.`code` AS `PLAN`,`his-tpa`.`case`.`rider` AS `RIDER`,`his-tpa`.`company`.`name` AS `COMPANY`,`his-tpa`.`case`.`policy_holder` AS `PRINCIPLE`,`his-tpa`.`member`.`member_name` AS `PATIENT`,case `his-tpa`.`case`.`relation` when 1 then 'Principle' when 2 then 'Spouse' when 3 then 'Child' when 4 then 'Dependant' else 'N/A' end AS `RELATION`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `GENDER`,`his-tpa`.`case`.`id` AS `CASE_ID`,`his-tpa`.`case`.`admission_date` AS `ADMISSION_DATE`,cast(`his-tpa`.`case`.`discharge_date` as date) AS `DISCHARGE_DATE`,`his-tpa`.`diagnosis`.`code` AS `DIAGNOSIS_CODE`,`his-tpa`.`diagnosis`.`name` AS `DIAGNOSIS_DESC`,`provider`.`full_name` AS `HOSPITAL`,`his-tpa`.`case`.`other_provider` AS `OTHER_HOSPITAL`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `CATEGORY`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `TYPE`,`his-tpa`.`country`.`name` AS `CURRENCY_01`,`his-tpa`.`country`.`name` AS `CURRENCY_02`,(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `ACTUAL`,(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `COVER`,(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `EXCESS`,cast(`his-tpa`.`case`.`original_bill_upload_date` as date) AS `DOC_RECEIVE_DATE`,cast(`his-tpa`.`case`.`log_issue_date` as date) AS `PROCESS_DATE`,cast(`his-tpa`.`case`.`original_bill_checked_date` as date) AS `CHECK_APPROVAL_DATE`,cast(`his-tpa`.`case`.`original_bill_checked_date` + interval 1 day as date) AS `SUBMIT_APPROVAL_DATE`,cast(`his-tpa`.`case`.`original_bill_checked_date` as date) AS `APPROVAL_DATE_FROM_CLIENT`,`his-tpa`.`country`.`name` AS `BRANCH`,`his-tpa`.`case`.`created_by` AS `CREATED_BY`,`his-tpa`.`case_status`.`name` AS `CASE_STATUS`,`his-tpa`.`case`.`ref` AS `REF` from (((((((((((((((`his-tpa`.`case` left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join (select `his-tpa`.`plan_tmli`.`id` AS `id`,`his-tpa`.`plan_tmli`.`client` AS `client`,`his-tpa`.`plan_tmli`.`program` AS `program`,`his-tpa`.`plan_tmli`.`plan_id` AS `plan_id`,`his-tpa`.`plan_tmli`.`name` AS `name`,`his-tpa`.`plan_tmli`.`code` AS `code` from `his-tpa`.`plan_tmli` group by `his-tpa`.`plan_tmli`.`plan_id`) `plan_tmli` on(`his-tpa`.`plan`.`id` = `plan_tmli`.`plan_id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`original_bill_checked` = 4 and `his-tpa`.`case`.`status` not in (11,12,13,14,30,31,32,98,99,96) and `his-tpa`.`case`.`payment_date` is null group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for astra_aviva_activity_case_management
-- ----------------------------
DROP VIEW IF EXISTS `astra_aviva_activity_case_management`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `astra_aviva_activity_case_management` AS select concat(year(`his-tpa`.`case`.`admission_date`),'-',convert(lpad(month(`his-tpa`.`case`.`admission_date`),2,0) using utf8mb4)) AS `Periode_of_claim`,sum(case when (`his-tpa`.`case`.`issue_log` = 2 and `his-tpa`.`case`.`status` not in (31,32)) then 1 else 0 end) AS `GOP`,sum(case when `his-tpa`.`case`.`status` in (31,32) then 1 else 0 end) AS `Decline`,sum(case when `his-tpa`.`case`.`admission_date` then 1 else 0 end) AS `No_of_Claim`,date_format(sec_to_time(avg(time_to_sec(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`)))),'%k:%i:%s') AS `TAT_(30 Minute)_(*)`,sum(case when (minute(sec_to_time(timestampdiff(SECOND,`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`))) <= 30 and `his-tpa`.`case`.`status` not in (31,32) and `his-tpa`.`case`.`issue_log` = 2) then 1 else NULL end) AS `No_of_case_Meet_TAT`,sum(case when `his-tpa`.`case`.`issue_log` = 2 then 1 else NULL end) / sum(case when (timestampdiff(MINUTE,`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`) <= 30 and `his-tpa`.`case`.`status` not in (31,32)) then 1 else NULL end) * 100 AS `%_within_TAT_InitialLOG`,date_format(sec_to_time(avg(time_to_sec(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`)))),'%k:%i:%s') AS `TAT_(60 Minute)_(*)`,sum(case when (timestampdiff(MINUTE,`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`) <= 60 and `his-tpa`.`case`.`status` not in (31,32)) then 1 else NULL end) AS `No_of_case_Meet_TAT_LOG`,sum(case when `his-tpa`.`case`.`issue_log` = 2 then 1 else NULL end) / sum(case when (timestampdiff(MINUTE,`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`) <= 60 and `his-tpa`.`case`.`status` not in (31,32)) then 1 else NULL end) * 100 AS `%_within_TAT_FinalLOG` from `his-tpa`.`case` where `his-tpa`.`case`.`status` not in (97,98,99) and `his-tpa`.`case`.`client` = 29 group by concat(year(`his-tpa`.`case`.`admission_date`),'-',convert(lpad(month(`his-tpa`.`case`.`admission_date`),2,0) using utf8mb4)) ;

-- ----------------------------
-- View structure for astra_aviva_claim_utilization
-- ----------------------------
DROP VIEW IF EXISTS `astra_aviva_claim_utilization`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `astra_aviva_claim_utilization` AS select concat(year(`his-tpa`.`case`.`admission_date`),'-',convert(lpad(month(`his-tpa`.`case`.`admission_date`),2,0) using utf8mb4)) AS `Periode_of_claim`,`his-tpa`.`case`.`id` AS `Claim_ref`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `Type`,`his-tpa`.`case_status`.`name` AS `Status`,`his-tpa`.`member`.`policy_no` AS `Policy_number`,`his-tpa`.`member`.`member_name` AS `Member`,'ASTRA AVIVA LIFE - IB' AS `Client`,`his-tpa`.`program`.`name` AS `Product`,`his-tpa`.`plan`.`name` AS `Plan`,`provider`.`full_name` AS `Provider`,`his-tpa`.`case`.`other_provider` AS `Other_Provider`,`his-tpa`.`diagnosis`.`code` AS `Diagnosis_Code`,`his-tpa`.`diagnosis`.`name` AS `Diagnosis_Desc`,`his-tpa`.`case`.`admission_date` AS `Admission_Date`,`his-tpa`.`case`.`discharge_date` AS `Discharge_Date`,`his-tpa`.`case`.`admission_doctor` AS `Doctor_name`,(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `Actual`,(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `Cover`,(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `Excess`,timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`) AS `Initial_LOG_TIME`,timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`) AS `Issue_LOG_TIME` from ((((((((((((`his-tpa`.`case` join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) where `client`.`id` = 29 and `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` not in (98,99) and `his-tpa`.`case`.`type` = 2 group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for astra_aviva_ob_complete_detail
-- ----------------------------
DROP VIEW IF EXISTS `astra_aviva_ob_complete_detail`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `astra_aviva_ob_complete_detail` AS select concat(year(`his-tpa`.`case`.`original_bill_upload_date`),'-',convert(lpad(month(`his-tpa`.`case`.`original_bill_upload_date`),2,0) using utf8mb4)) AS `Periode_of_claim`,`his-tpa`.`case`.`id` AS `CLAIM_REF`,`his-tpa`.`plan`.`name` AS `PLAN_ID`,`his-tpa`.`plan_detail`.`code` AS `Plan_code`,`his-tpa`.`plan_detail`.`name` AS `BENEFIT_DESC`,`his-tpa`.`worksheet`.`actual` AS `TOTAL_AMOUNT_INCURRED`,`his-tpa`.`worksheet`.`cover` AS `TOTAL_AMOUNT_APPROVED`,`his-tpa`.`worksheet`.`excess` AS `TOTAL_AMOUNT_NOT_APPROVED`,`his-tpa`.`worksheet`.`remarks` AS `REMARKS` from ((((((((((((((`his-tpa`.`case` left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` not in (98,99) and `client`.`id` = 29 and `his-tpa`.`case`.`type` = 2 group by `his-tpa`.`worksheet`.`id` ;

-- ----------------------------
-- View structure for astra_aviva_ob_complete_header
-- ----------------------------
DROP VIEW IF EXISTS `astra_aviva_ob_complete_header`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `astra_aviva_ob_complete_header` AS select concat(year(`his-tpa`.`case`.`original_bill_upload_date`),'-',convert(lpad(month(`his-tpa`.`case`.`original_bill_upload_date`),2,0) using utf8mb4)) AS `Periode_of_claim`,`his-tpa`.`case`.`member_id` AS `Id`,`his-tpa`.`case`.`create_date` AS `Create_Date`,`his-tpa`.`case_status`.`name` AS `Status_Case`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `Category`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `Type`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`case`.`id` AS `Claim_Ref`,`his-tpa`.`member`.`member_name` AS `Patient`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `Gender`,`his-tpa`.`case`.`policy_no` AS `Member_id`,`his-tpa`.`case`.`member_card` AS `Member_card`,'Principle' AS `Relation`,'Individual' AS `Client`,`his-tpa`.`country`.`name` AS `Branch`,`his-tpa`.`case`.`company` AS `Company`,case `his-tpa`.`case`.`policy_status` when 0 then 'Disable' when 1 then 'Enable' else 'N/A' end AS `Policy_Status`,`his-tpa`.`case`.`policy_holder` AS `Name`,`his-tpa`.`case`.`policy_no` AS `Policy_No`,`his-tpa`.`case`.`policy_effective_date` AS `Effective_Date`,`his-tpa`.`case`.`policy_expiry_date` AS `Expired_Date`,`his-tpa`.`program`.`name` AS `Program`,`his-tpa`.`plan`.`name` AS `Plan`,`his-tpa`.`case`.`rider` AS `Rider_Plan`,`provider`.`full_name` AS `Provider`,`his-tpa`.`case`.`other_provider` AS `Other_Provider`,`his-tpa`.`country`.`name` AS `Currency_01`,`his-tpa`.`country`.`name` AS `Currency_02`,`his-tpa`.`case`.`admission_date` AS `Admission_Date`,`his-tpa`.`case`.`discharge_date` AS `Discharge_Date`,`his-tpa`.`worksheet`.`day` AS `Duration`,`his-tpa`.`diagnosis`.`code` AS `Diagnosis_Code`,`his-tpa`.`diagnosis`.`name` AS `Diagnosis_Desc`,(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `Actual`,(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `Cover`,(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `Excess`,`his-tpa`.`case`.`original_bill_upload_date` AS `Doc_Receive_date`,`his-tpa`.`case`.`original_bill_checked_date` AS `Doc_Complete_date`,timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`) AS `Admission_LOG_SLA`,timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`) AS `Discharge_LOG_SLA` from ((((((((((((((`his-tpa`.`case` left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` not in (98,99) and `client`.`id` = 29 and `his-tpa`.`case`.`type` = 2 group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for automation_report_01
-- ----------------------------
DROP VIEW IF EXISTS `automation_report_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `automation_report_01` AS select `automation_report`.`client` AS `client`,group_concat(distinct `automation_report`.`case` separator ',') AS `case_id`,`automation_report`.`code` AS `code`,`automation_report`.`report_date` AS `report_date` from `automation_report` where date_format(`automation_report`.`process_date`,'%Y-%m') = date_format(current_timestamp(),'%Y-%m') group by `automation_report`.`code`,`automation_report`.`report_date` order by NULL ;

-- ----------------------------
-- View structure for automation_report_02
-- ----------------------------
DROP VIEW IF EXISTS `automation_report_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `automation_report_02` AS select `client`.`full_name` AS `client`,`her-tpa`.`automation_type`.`name` AS `type`,`her-tpa`.`log_automation`.`process_date` AS `process_date`,`her-tpa`.`log_automation`.`name` AS `name`,`her-tpa`.`log_automation`.`id` AS `id`,if(`her-tpa`.`log_automation`.`status` = 'success',1,0) AS `success`,if(`her-tpa`.`log_automation`.`status` = 'error',1,0) AS `error` from ((`her-tpa`.`log_automation` left join `her-tpa`.`client` on(`client`.`id` = `her-tpa`.`log_automation`.`client`)) join `her-tpa`.`automation_type` on(`her-tpa`.`automation_type`.`id` = `her-tpa`.`log_automation`.`type`)) where yearweek(`her-tpa`.`log_automation`.`process_date`,0) = yearweek(current_timestamp(),0) ;

-- ----------------------------
-- View structure for bank_02
-- ----------------------------
DROP VIEW IF EXISTS `bank_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`aaisys.master`@`%` SQL SECURITY DEFINER VIEW `bank_02` AS select `his-tpa`.`bank`.`id` AS `id`,`his-tpa`.`bank`.`code` AS `code`,`his-tpa`.`bank`.`name` AS `name`,`his-tpa`.`bank`.`bi_code` AS `bi_code`,`his-tpa`.`bank`.`rtgs_code` AS `rtgs_code`,`his-tpa`.`bank`.`status` AS `status` from `his-tpa`.`bank` ;

-- ----------------------------
-- View structure for branch
-- ----------------------------
DROP VIEW IF EXISTS `branch`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `branch` AS select `his-tpa`.`branch`.`client` AS `client`,`his-tpa`.`branch`.`id` AS `id`,`his-tpa`.`branch`.`code` AS `code`,`his-tpa`.`branch`.`name` AS `name`,`his-tpa`.`branch`.`created_by` AS `created_by`,`his-tpa`.`branch`.`create_date` AS `create_date`,`his-tpa`.`branch`.`edited_by` AS `edited_by`,`his-tpa`.`branch`.`edit_date` AS `edit_date` from `his-tpa`.`branch` ;

-- ----------------------------
-- View structure for case_all
-- ----------------------------
DROP VIEW IF EXISTS `case_all`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `case_all` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case`.`status` AS `status`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,if(`his-tpa`.`case`.`category` = 0,'Outpatient','Inpatient') AS `category`,`his-tpa`.`member`.`member_name` AS `patient`,if(`his-tpa`.`case`.`gender` = 0,'Female',if(`his-tpa`.`case`.`gender` = 1,'Male','')) AS `gender`,`principle`.`member_name` AS `principle`,if(`his-tpa`.`case`.`relation` = 1,'Principle',if(`his-tpa`.`case`.`relation` = 2,'Spouse',if(`his-tpa`.`case`.`relation` = 3,'Child',if(`his-tpa`.`case`.`relation` = 4,'Dependant','')))) AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`case`.`dob` AS `dob`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`plan_detail`.`name` AS `benefit`,`his-tpa`.`plan_header`.`name` AS `jenis_benefit`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,`his-tpa`.`status`.`name` AS `policy_status`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`rider`.`name` AS `rider`,`provider`.`full_name` AS `provider`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`country`.`currency` AS `currency`,`his-tpa`.`case`.`currency_rate` AS `currency_rate`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,if(`his-tpa`.`case`.`haf_doc_completed` = 1,'Pending',if(`his-tpa`.`case`.`haf_doc_completed` = 2,'Not Completed','Completed')) AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,if(`his-tpa`.`case`.`issue_initial_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_initial_log` = 2,'LOG','Non-LOG')) AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_approval` AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,`his-tpa`.`diagnosis`.`name` AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,if(`his-tpa`.`case`.`bill_completed` = 1,'Pending',if(`his-tpa`.`case`.`bill_completed` = 2,'Not completed','Completed')) AS `bill_completed`,if(`his-tpa`.`case`.`ws_finished` = 1,'Done','Not Done') AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,if(`his-tpa`.`case`.`ws_approval` = 1,'Pending',if(`his-tpa`.`case`.`ws_approval` = 2,'Not Approve','Not Done')) AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,if(`his-tpa`.`case`.`issue_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_log` = 2,'Non-LOG','LOG')) AS `issue_log`,if(`his-tpa`.`case`.`issue_log_option` = 1,'Full Cover','') AS `issue_log_option`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_approval` AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,if(`his-tpa`.`case`.`original_bill_checked` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_checked` = 2,'Original Bill Not Complete',if(`his-tpa`.`case`.`original_bill_checked` = 3,'WS Revision',if(`his-tpa`.`case`.`original_bill_checked` = 4,'OK','Close Case')))) AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,if(`his-tpa`.`case`.`close_case_option` = 1,'By Document Send Back','By Payment') AS `close_case_option`,if(`his-tpa`.`case`.`original_bill_verified` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_verified` = 2,'Original Bill Not Completed',if(`his-tpa`.`case`.`original_bill_verified` = 3,'WS Revision','OK'))) AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,if(`his-tpa`.`case`.`doc_send_back_to_client_required` = 1,'Required','Not Required') AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,sum(`his-tpa`.`worksheet`.`actual`) AS `actual`,sum(`his-tpa`.`worksheet`.`cover`) AS `cover`,sum(`his-tpa`.`worksheet`.`excess`) AS `excess`,`his-tpa`.`case`.`edited_by` AS `edited_by`,`his-tpa`.`case`.`edit_date` AS `edit_date` from ((((((((((((((((`his-tpa`.`case` left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`principle` on(`his-tpa`.`case`.`principle` = `principle`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`status` on(`his-tpa`.`case`.`policy_status` = `his-tpa`.`status`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id` and `his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) where `his-tpa`.`case`.`status` <> 99 group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for case_all_01
-- ----------------------------
DROP VIEW IF EXISTS `case_all_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `case_all_01` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case`.`created_by_01` AS `created_by_01`,`his-tpa`.`case`.`create_date_01` AS `create_date_01`,`his-tpa`.`case`.`source` AS `source`,`his-tpa`.`case`.`status` AS `status`,`his-tpa`.`case`.`status_01` AS `status_01`,`his-tpa`.`case`.`category` AS `category`,`his-tpa`.`case`.`type` AS `type`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`case`.`case_remarks` AS `case_remarks`,`his-tpa`.`case`.`averaged_cost` AS `averaged_cost`,`his-tpa`.`case`.`case_remarks_by` AS `case_remarks_by`,`his-tpa`.`case`.`case_remarks_date` AS `case_remarks_date`,`his-tpa`.`case`.`patient` AS `patient`,`his-tpa`.`case`.`dob` AS `dob`,`his-tpa`.`case`.`gender` AS `gender`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,`his-tpa`.`case`.`member_card_edc` AS `member_card_edc`,`his-tpa`.`case`.`principle` AS `principle`,`his-tpa`.`case`.`relation` AS `relation`,`his-tpa`.`case`.`mobile` AS `mobile`,`his-tpa`.`case`.`client` AS `client`,`his-tpa`.`case`.`branch` AS `branch`,`his-tpa`.`case`.`company` AS `company`,`his-tpa`.`case`.`policy_status` AS `policy_status`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_holder` AS `policy_holder`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`policy_suspend_date` AS `policy_suspend_date`,`his-tpa`.`case`.`policy_unsuspend_date` AS `policy_unsuspend_date`,`his-tpa`.`case`.`waiting_period` AS `waiting_period`,`his-tpa`.`case`.`exclusion` AS `exclusion`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`case`.`program` AS `program`,`his-tpa`.`case`.`plan` AS `plan`,`his-tpa`.`case`.`plan_header` AS `plan_header`,`his-tpa`.`case`.`code_rawat` AS `code_rawat`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`case`.`rider` AS `rider`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,`his-tpa`.`case`.`provider` AS `provider`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`case`.`other_provider_city` AS `other_provider_city`,`his-tpa`.`case`.`other_provider_country` AS `other_provider_country`,`his-tpa`.`case`.`provider_cancel` AS `provider_cancel`,`his-tpa`.`case`.`id_edc` AS `id_edc`,`his-tpa`.`case`.`currency_01` AS `currency_01`,`his-tpa`.`case`.`currency_02` AS `currency_02`,`his-tpa`.`case`.`currency_rate` AS `currency_rate`,`his-tpa`.`case`.`currency_rate_01_to_idr` AS `currency_rate_01_to_idr`,`his-tpa`.`case`.`currency_rate_idr_to_02` AS `currency_rate_idr_to_02`,`his-tpa`.`case`.`amount_currency_01` AS `amount_currency_01`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`initial_diagnosis_01` AS `initial_diagnosis_01`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,`his-tpa`.`case`.`upload_haf_doc_finished` AS `upload_haf_doc_finished`,`his-tpa`.`case`.`upload_haf_doc_finished_by` AS `upload_haf_doc_finished_by`,`his-tpa`.`case`.`upload_haf_doc_finished_date` AS `upload_haf_doc_finished_date`,`his-tpa`.`case`.`haf_doc_completed` AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,`his-tpa`.`case`.`issue_initial_log` AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_log_issued_by_01` AS `initial_log_issued_by_01`,`his-tpa`.`case`.`initial_log_issue_date_01` AS `initial_log_issue_date_01`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_remarks` AS `initial_log_remarks`,`his-tpa`.`case`.`initial_log_approval` AS `initial_log_approval`,`his-tpa`.`case`.`discharge_plan` AS `discharge_plan`,`his-tpa`.`case`.`discharge_plan_received_by` AS `discharge_plan_received_by`,`his-tpa`.`case`.`discharge_plan_receive_date` AS `discharge_plan_receive_date`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,`his-tpa`.`case`.`diagnosis` AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`surgery` AS `surgery`,`his-tpa`.`case`.`other_surgery` AS `other_surgery`,`his-tpa`.`case`.`bill_received` AS `bill_received`,`his-tpa`.`case`.`bill_received_by` AS `bill_received_by`,`his-tpa`.`case`.`bill_received_date` AS `bill_received_date`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`upload_bill_finished` AS `upload_bill_finished`,`his-tpa`.`case`.`upload_bill_finished_by` AS `upload_bill_finished_by`,`his-tpa`.`case`.`upload_bill_finished_date` AS `upload_bill_finished_date`,`his-tpa`.`case`.`bill_completed` AS `bill_completed`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,`his-tpa`.`case`.`bill_completed_by_01` AS `bill_completed_by_01`,`his-tpa`.`case`.`bill_completed_date_01` AS `bill_completed_date_01`,`his-tpa`.`case`.`ws_type` AS `ws_type`,`his-tpa`.`case`.`ws_option` AS `ws_option`,`his-tpa`.`case`.`ws_finished` AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,`his-tpa`.`case`.`ws_approval` AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`ws_error_category` AS `ws_error_category`,`his-tpa`.`case`.`ws_error_type` AS `ws_error_type`,`his-tpa`.`case`.`ws_error_remarks` AS `ws_error_remarks`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,`his-tpa`.`case`.`issue_log` AS `issue_log`,`his-tpa`.`case`.`issue_log_option` AS `issue_log_option`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`log_issued_by_01` AS `log_issued_by_01`,`his-tpa`.`case`.`log_issue_date_01` AS `log_issue_date_01`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_remarks` AS `log_remarks`,`his-tpa`.`case`.`log_bank` AS `log_bank`,`his-tpa`.`case`.`log_bank_branch` AS `log_bank_branch`,`his-tpa`.`case`.`log_bank_city` AS `log_bank_city`,`his-tpa`.`case`.`log_bank_account_no` AS `log_bank_account_no`,`his-tpa`.`case`.`log_bank_on_behalf_of` AS `log_bank_on_behalf_of`,`his-tpa`.`case`.`log_approval` AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`reject_reason` AS `reject_reason`,`his-tpa`.`case`.`reject_remarks` AS `reject_remarks`,`his-tpa`.`case`.`batch_received` AS `batch_received`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,`his-tpa`.`case`.`original_bill_checked` AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,`his-tpa`.`case`.`original_bill_checked_01` AS `original_bill_checked_01`,`his-tpa`.`case`.`original_bill_checked_by_01` AS `original_bill_checked_by_01`,`his-tpa`.`case`.`original_bill_checked_date_01` AS `original_bill_checked_date_01`,`his-tpa`.`case`.`original_bill_checked_error_category` AS `original_bill_checked_error_category`,`his-tpa`.`case`.`original_bill_checked_error_type` AS `original_bill_checked_error_type`,`his-tpa`.`case`.`original_bill_checked_error_remarks` AS `original_bill_checked_error_remarks`,`his-tpa`.`case`.`close_case_option` AS `close_case_option`,`his-tpa`.`case`.`discount` AS `discount`,`his-tpa`.`case`.`original_bill_verified` AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`original_bill_verified_error_category` AS `original_bill_verified_error_category`,`his-tpa`.`case`.`original_bill_verified_error_type` AS `original_bill_verified_error_type`,`his-tpa`.`case`.`original_bill_verified_error_remarks` AS `original_bill_verified_error_remarks`,`his-tpa`.`case`.`client_approval_for_payment` AS `client_approval_for_payment`,`his-tpa`.`case`.`payment_approval_by` AS `payment_approval_by`,`his-tpa`.`case`.`payment_approval_date` AS `payment_approval_date`,`his-tpa`.`case`.`upload_payment_approval` AS `upload_payment_approval`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,`his-tpa`.`case`.`upload_payment_date` AS `upload_payment_date`,`his-tpa`.`case`.`payment_date_01` AS `payment_date_01`,`his-tpa`.`case`.`paid_by_01` AS `paid_by_01`,`his-tpa`.`case`.`upload_proof_of_payment_01` AS `upload_proof_of_payment_01`,`his-tpa`.`case`.`upload_payment_date_01` AS `upload_payment_date_01`,`his-tpa`.`case`.`doc_send_back_to_client_required` AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,`his-tpa`.`case`.`edited_by` AS `edited_by`,`his-tpa`.`case`.`edit_date` AS `edit_date`,`his-tpa`.`case`.`case_closed_date` AS `case_closed_date`,`his-tpa`.`case`.`case_closed_date_01` AS `case_closed_date_01`,`his-tpa`.`case`.`case_reopen_date` AS `case_reopen_date`,`his-tpa`.`case`.`case_reopen_date_01` AS `case_reopen_date_01`,`his-tpa`.`case`.`procced_to_worksheet` AS `procced_to_worksheet`,`his-tpa`.`case`.`case_header` AS `case_header`,`his-tpa`.`case`.`is_clean` AS `is_clean`,`his-tpa`.`case`.`code_edc` AS `code_edc`,`his-tpa`.`case`.`TraceNumber` AS `TraceNumber`,`his-tpa`.`case`.`los` AS `los`,`his-tpa`.`case`.`userlevel` AS `userlevel` from `his-tpa`.`case` ;

-- ----------------------------
-- View structure for case_all_dev
-- ----------------------------
DROP VIEW IF EXISTS `case_all_dev`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `case_all_dev` AS select `his-tpa-dev`.`case`.`id` AS `id`,`his-tpa-dev`.`case`.`created_by` AS `created_by`,`his-tpa-dev`.`case`.`create_date` AS `create_date`,`his-tpa-dev`.`case`.`created_by_01` AS `created_by_01`,`his-tpa-dev`.`case`.`create_date_01` AS `create_date_01`,`his-tpa-dev`.`case`.`source` AS `source`,`his-tpa-dev`.`case`.`status` AS `status`,`his-tpa-dev`.`case`.`status_01` AS `status_01`,`his-tpa-dev`.`case`.`category` AS `category`,`his-tpa-dev`.`case`.`type` AS `type`,`his-tpa-dev`.`case`.`ref` AS `ref`,`his-tpa-dev`.`case`.`case_remarks` AS `case_remarks`,`his-tpa-dev`.`case`.`averaged_cost` AS `averaged_cost`,`his-tpa-dev`.`case`.`case_remarks_by` AS `case_remarks_by`,`his-tpa-dev`.`case`.`case_remarks_date` AS `case_remarks_date`,`his-tpa-dev`.`case`.`patient` AS `patient`,`his-tpa-dev`.`case`.`dob` AS `dob`,`his-tpa-dev`.`case`.`gender` AS `gender`,`his-tpa-dev`.`case`.`member_id` AS `member_id`,`his-tpa-dev`.`case`.`member_card` AS `member_card`,`his-tpa-dev`.`case`.`member_card_edc` AS `member_card_edc`,`his-tpa-dev`.`case`.`principle` AS `principle`,`his-tpa-dev`.`case`.`relation` AS `relation`,`his-tpa-dev`.`case`.`mobile` AS `mobile`,`his-tpa-dev`.`case`.`client` AS `client`,`his-tpa-dev`.`case`.`branch` AS `branch`,`his-tpa-dev`.`case`.`company` AS `company`,`his-tpa-dev`.`case`.`policy_status` AS `policy_status`,`his-tpa-dev`.`case`.`policy_no` AS `policy_no`,`his-tpa-dev`.`case`.`policy_holder` AS `policy_holder`,`his-tpa-dev`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa-dev`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa-dev`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa-dev`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa-dev`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa-dev`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa-dev`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa-dev`.`case`.`policy_suspend_date` AS `policy_suspend_date`,`his-tpa-dev`.`case`.`policy_unsuspend_date` AS `policy_unsuspend_date`,`his-tpa-dev`.`case`.`waiting_period` AS `waiting_period`,`his-tpa-dev`.`case`.`exclusion` AS `exclusion`,`his-tpa-dev`.`case`.`special_condition` AS `special_condition`,`his-tpa-dev`.`case`.`program` AS `program`,`his-tpa-dev`.`case`.`plan` AS `plan`,`his-tpa-dev`.`case`.`plan_header` AS `plan_header`,`his-tpa-dev`.`case`.`code_rawat` AS `code_rawat`,`his-tpa-dev`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa-dev`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa-dev`.`case`.`rider` AS `rider`,`his-tpa-dev`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa-dev`.`case`.`rider_expiry_date` AS `rider_expiry_date`,`his-tpa-dev`.`case`.`provider` AS `provider`,`his-tpa-dev`.`case`.`other_provider` AS `other_provider`,`his-tpa-dev`.`case`.`other_provider_city` AS `other_provider_city`,`his-tpa-dev`.`case`.`other_provider_country` AS `other_provider_country`,`his-tpa-dev`.`case`.`provider_cancel` AS `provider_cancel`,`his-tpa-dev`.`case`.`id_edc` AS `id_edc`,`his-tpa-dev`.`case`.`currency_01` AS `currency_01`,`his-tpa-dev`.`case`.`currency_02` AS `currency_02`,`his-tpa-dev`.`case`.`currency_rate` AS `currency_rate`,`his-tpa-dev`.`case`.`currency_rate_01_to_idr` AS `currency_rate_01_to_idr`,`his-tpa-dev`.`case`.`currency_rate_idr_to_02` AS `currency_rate_idr_to_02`,`his-tpa-dev`.`case`.`amount_currency_01` AS `amount_currency_01`,`his-tpa-dev`.`case`.`admission_date` AS `admission_date`,`his-tpa-dev`.`case`.`admission_time` AS `admission_time`,`his-tpa-dev`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa-dev`.`case`.`symptom` AS `symptom`,`his-tpa-dev`.`case`.`symptom_since` AS `symptom_since`,`his-tpa-dev`.`case`.`vital_sign` AS `vital_sign`,`his-tpa-dev`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa-dev`.`case`.`initial_diagnosis_01` AS `initial_diagnosis_01`,`his-tpa-dev`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa-dev`.`case`.`upload_haf` AS `upload_haf`,`his-tpa-dev`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa-dev`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa-dev`.`case`.`upload_doc` AS `upload_doc`,`his-tpa-dev`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa-dev`.`case`.`doc_upload_date` AS `doc_upload_date`,`his-tpa-dev`.`case`.`upload_haf_doc_finished` AS `upload_haf_doc_finished`,`his-tpa-dev`.`case`.`upload_haf_doc_finished_by` AS `upload_haf_doc_finished_by`,`his-tpa-dev`.`case`.`upload_haf_doc_finished_date` AS `upload_haf_doc_finished_date`,`his-tpa-dev`.`case`.`haf_doc_completed` AS `haf_doc_completed`,`his-tpa-dev`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa-dev`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa-dev`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,`his-tpa-dev`.`case`.`issue_initial_log` AS `issue_initial_log`,`his-tpa-dev`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa-dev`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa-dev`.`case`.`initial_log_issued_by_01` AS `initial_log_issued_by_01`,`his-tpa-dev`.`case`.`initial_log_issue_date_01` AS `initial_log_issue_date_01`,`his-tpa-dev`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa-dev`.`case`.`initial_log_remarks` AS `initial_log_remarks`,`his-tpa-dev`.`case`.`initial_log_approval` AS `initial_log_approval`,`his-tpa-dev`.`case`.`discharge_plan` AS `discharge_plan`,`his-tpa-dev`.`case`.`discharge_plan_received_by` AS `discharge_plan_received_by`,`his-tpa-dev`.`case`.`discharge_plan_receive_date` AS `discharge_plan_receive_date`,`his-tpa-dev`.`case`.`discharge_date` AS `discharge_date`,`his-tpa-dev`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa-dev`.`case`.`actual_treatment` AS `actual_treatment`,`his-tpa-dev`.`case`.`diagnosis` AS `diagnosis`,`his-tpa-dev`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa-dev`.`case`.`surgery` AS `surgery`,`his-tpa-dev`.`case`.`other_surgery` AS `other_surgery`,`his-tpa-dev`.`case`.`bill_received` AS `bill_received`,`his-tpa-dev`.`case`.`bill_received_by` AS `bill_received_by`,`his-tpa-dev`.`case`.`bill_received_date` AS `bill_received_date`,`his-tpa-dev`.`case`.`upload_bill` AS `upload_bill`,`his-tpa-dev`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa-dev`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa-dev`.`case`.`upload_bill_finished` AS `upload_bill_finished`,`his-tpa-dev`.`case`.`upload_bill_finished_by` AS `upload_bill_finished_by`,`his-tpa-dev`.`case`.`upload_bill_finished_date` AS `upload_bill_finished_date`,`his-tpa-dev`.`case`.`bill_completed` AS `bill_completed`,`his-tpa-dev`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa-dev`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa-dev`.`case`.`bill_completed_date` AS `bill_completed_date`,`his-tpa-dev`.`case`.`bill_completed_by_01` AS `bill_completed_by_01`,`his-tpa-dev`.`case`.`bill_completed_date_01` AS `bill_completed_date_01`,`his-tpa-dev`.`case`.`ws_type` AS `ws_type`,`his-tpa-dev`.`case`.`ws_option` AS `ws_option`,`his-tpa-dev`.`case`.`ws_finished` AS `ws_finished`,`his-tpa-dev`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa-dev`.`case`.`ws_finished_date` AS `ws_finished_date`,`his-tpa-dev`.`case`.`ws_approval` AS `ws_approval`,`his-tpa-dev`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa-dev`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa-dev`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa-dev`.`case`.`ws_error_category` AS `ws_error_category`,`his-tpa-dev`.`case`.`ws_error_type` AS `ws_error_type`,`his-tpa-dev`.`case`.`ws_error_remarks` AS `ws_error_remarks`,`his-tpa-dev`.`case`.`issuance_limit` AS `issuance_limit`,`his-tpa-dev`.`case`.`issue_log` AS `issue_log`,`his-tpa-dev`.`case`.`issue_log_option` AS `issue_log_option`,`his-tpa-dev`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa-dev`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa-dev`.`case`.`log_issued_by_01` AS `log_issued_by_01`,`his-tpa-dev`.`case`.`log_issue_date_01` AS `log_issue_date_01`,`his-tpa-dev`.`case`.`claim_no` AS `claim_no`,`his-tpa-dev`.`case`.`log_remarks` AS `log_remarks`,`his-tpa-dev`.`case`.`log_bank` AS `log_bank`,`his-tpa-dev`.`case`.`log_bank_branch` AS `log_bank_branch`,`his-tpa-dev`.`case`.`log_bank_city` AS `log_bank_city`,`his-tpa-dev`.`case`.`log_bank_account_no` AS `log_bank_account_no`,`his-tpa-dev`.`case`.`log_bank_on_behalf_of` AS `log_bank_on_behalf_of`,`his-tpa-dev`.`case`.`log_approval` AS `log_approval`,`his-tpa-dev`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa-dev`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa-dev`.`case`.`reject_reason` AS `reject_reason`,`his-tpa-dev`.`case`.`reject_remarks` AS `reject_remarks`,`his-tpa-dev`.`case`.`batch_received` AS `batch_received`,`his-tpa-dev`.`case`.`bill_no` AS `bill_no`,`his-tpa-dev`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa-dev`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa-dev`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa-dev`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa-dev`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,`his-tpa-dev`.`case`.`original_bill_checked` AS `original_bill_checked`,`his-tpa-dev`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa-dev`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa-dev`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,`his-tpa-dev`.`case`.`original_bill_checked_01` AS `original_bill_checked_01`,`his-tpa-dev`.`case`.`original_bill_checked_by_01` AS `original_bill_checked_by_01`,`his-tpa-dev`.`case`.`original_bill_checked_date_01` AS `original_bill_checked_date_01`,`his-tpa-dev`.`case`.`original_bill_checked_error_category` AS `original_bill_checked_error_category`,`his-tpa-dev`.`case`.`original_bill_checked_error_type` AS `original_bill_checked_error_type`,`his-tpa-dev`.`case`.`original_bill_checked_error_remarks` AS `original_bill_checked_error_remarks`,`his-tpa-dev`.`case`.`close_case_option` AS `close_case_option`,`his-tpa-dev`.`case`.`discount` AS `discount`,`his-tpa-dev`.`case`.`original_bill_verified` AS `original_bill_verified`,`his-tpa-dev`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa-dev`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa-dev`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa-dev`.`case`.`original_bill_verified_error_category` AS `original_bill_verified_error_category`,`his-tpa-dev`.`case`.`original_bill_verified_error_type` AS `original_bill_verified_error_type`,`his-tpa-dev`.`case`.`original_bill_verified_error_remarks` AS `original_bill_verified_error_remarks`,`his-tpa-dev`.`case`.`client_approval_for_payment` AS `client_approval_for_payment`,`his-tpa-dev`.`case`.`payment_approval_by` AS `payment_approval_by`,`his-tpa-dev`.`case`.`payment_approval_date` AS `payment_approval_date`,`his-tpa-dev`.`case`.`upload_payment_approval` AS `upload_payment_approval`,`his-tpa-dev`.`case`.`payment_date` AS `payment_date`,`his-tpa-dev`.`case`.`paid_by` AS `paid_by`,`his-tpa-dev`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,`his-tpa-dev`.`case`.`upload_payment_date` AS `upload_payment_date`,`his-tpa-dev`.`case`.`payment_date_01` AS `payment_date_01`,`his-tpa-dev`.`case`.`paid_by_01` AS `paid_by_01`,`his-tpa-dev`.`case`.`upload_proof_of_payment_01` AS `upload_proof_of_payment_01`,`his-tpa-dev`.`case`.`upload_payment_date_01` AS `upload_payment_date_01`,`his-tpa-dev`.`case`.`doc_send_back_to_client_required` AS `doc_send_back_to_client_required`,`his-tpa-dev`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa-dev`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,`his-tpa-dev`.`case`.`edited_by` AS `edited_by`,`his-tpa-dev`.`case`.`edit_date` AS `edit_date`,`his-tpa-dev`.`case`.`case_closed_date` AS `case_closed_date`,`his-tpa-dev`.`case`.`case_closed_date_01` AS `case_closed_date_01`,`his-tpa-dev`.`case`.`case_reopen_date` AS `case_reopen_date`,`his-tpa-dev`.`case`.`case_reopen_date_01` AS `case_reopen_date_01`,`his-tpa-dev`.`case`.`procced_to_worksheet` AS `procced_to_worksheet`,`his-tpa-dev`.`case`.`case_header` AS `case_header`,`his-tpa-dev`.`case`.`is_clean` AS `is_clean`,`his-tpa-dev`.`case`.`code_edc` AS `code_edc`,`his-tpa-dev`.`case`.`TraceNumber` AS `TraceNumber`,`his-tpa-dev`.`case`.`los` AS `los`,`his-tpa-dev`.`case`.`userlevel` AS `userlevel` from `his-tpa-dev`.`case` where `his-tpa-dev`.`case`.`id` in (191542,192321,205086,205088,205089,2050890) ;

-- ----------------------------
-- View structure for case_amount_per_client
-- ----------------------------
DROP VIEW IF EXISTS `case_amount_per_client`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `case_amount_per_client` AS select `his-tpa`.`case`.`client` AS `client_id`,`client`.`full_name` AS `client_name`,concat(year(`his-tpa`.`case`.`create_date`),'-',convert(lpad(month(`his-tpa`.`case`.`create_date`),2,0) using utf8mb4)) AS `period`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','ERROR')) AS `category`,sum(`worksheet_header`.`total_cover`) AS `total_cover` from ((`his-tpa`.`case` join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) where year(`his-tpa`.`case`.`create_date`) is not null and month(`his-tpa`.`case`.`create_date`) is not null and year(`his-tpa`.`case`.`create_date`) = year(curdate()) and `his-tpa`.`case`.`status` <> 96 group by `his-tpa`.`case`.`client`,year(`his-tpa`.`case`.`create_date`),month(`his-tpa`.`case`.`create_date`),`his-tpa`.`case`.`category` ;

-- ----------------------------
-- View structure for case_cashless
-- ----------------------------
DROP VIEW IF EXISTS `case_cashless`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `case_cashless` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case_status`.`name` AS `case_status`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,if(`his-tpa`.`case`.`category` = 0,'Outpatient','Inpatient') AS `category`,`his-tpa`.`member`.`member_name` AS `patient`,if(`his-tpa`.`member`.`member_gender` = 0,'Female',if(`his-tpa`.`member`.`member_gender` = 1,'Male','ERROR')) AS `gender`,`principle`.`member_name` AS `principle`,`his-tpa`.`relation`.`name` AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`case`.`dob` AS `dob`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`plan_detail`.`name` AS `benefit`,`his-tpa`.`plan_header`.`name` AS `jenis_benefit`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,`his-tpa`.`case_status`.`name` AS `status`,`his-tpa`.`status`.`name` AS `policy_status`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`rider`.`name` AS `rider`,`provider`.`full_name` AS `provider`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`country`.`currency` AS `currency`,`his-tpa`.`case`.`currency_rate` AS `currency_rate`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,if(`his-tpa`.`case`.`haf_doc_completed` = 1,'Pending',if(`his-tpa`.`case`.`haf_doc_completed` = 2,'Not Completed','Completed')) AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,if(`his-tpa`.`case`.`issue_initial_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_initial_log` = 2,'LOG','Non-LOG')) AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_approval` AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,`his-tpa`.`diagnosis`.`name` AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,if(`his-tpa`.`case`.`bill_completed` = 1,'Pending',if(`his-tpa`.`case`.`bill_completed` = 2,'Not completed','Completed')) AS `bill_completed`,if(`his-tpa`.`case`.`ws_finished` = 1,'Done','Not Done') AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,if(`his-tpa`.`case`.`ws_approval` = 1,'Pending',if(`his-tpa`.`case`.`ws_approval` = 2,'Not Approve','Approve')) AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,if(`his-tpa`.`case`.`issue_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_log` = 2,'LOG','Non-LOG')) AS `issue_log`,if(`his-tpa`.`case`.`issue_log_option` = 1,'Full Cover','') AS `issue_log_option`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_approval` AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,if(`his-tpa`.`case`.`original_bill_checked` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_checked` = 2,'Original Bill Not Complete',if(`his-tpa`.`case`.`original_bill_checked` = 3,'WS Revision',if(`his-tpa`.`case`.`original_bill_checked` = 4,'OK','Close Case')))) AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,if(`his-tpa`.`case`.`close_case_option` = 1,'By Document Send Back','By Payment') AS `close_case_option`,if(`his-tpa`.`case`.`original_bill_verified` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_verified` = 2,'Original Bill Not Completed',if(`his-tpa`.`case`.`original_bill_verified` = 3,'WS Revision','OK'))) AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,if(`his-tpa`.`case`.`doc_send_back_to_client_required` = 1,'Required','Not Required') AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,sum(`his-tpa`.`worksheet`.`actual`) AS `actual`,sum(`his-tpa`.`worksheet`.`cover`) AS `cover`,sum(`his-tpa`.`worksheet`.`excess`) AS `excess`,`his-tpa`.`case`.`edit_date` AS `edit_date` from (((((((((((((((((`his-tpa`.`case` left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`principle` on(`his-tpa`.`case`.`principle` = `principle`.`id`)) left join `his-tpa`.`relation` on(`his-tpa`.`case`.`relation` = `his-tpa`.`relation`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`status` on(`his-tpa`.`case`.`policy_status` = `his-tpa`.`status`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id` and `his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` <> 99 and `his-tpa`.`case`.`type` = 2 group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for case_cashless_non_log
-- ----------------------------
DROP VIEW IF EXISTS `case_cashless_non_log`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `case_cashless_non_log` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case_status`.`name` AS `case_status`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,if(`his-tpa`.`case`.`category` = 0,'Outpatient','Inpatient') AS `category`,`his-tpa`.`member`.`member_name` AS `patient`,if(`his-tpa`.`member`.`member_gender` = 0,'Female',if(`his-tpa`.`member`.`member_gender` = 1,'Male','ERROR')) AS `gender`,`principle`.`member_name` AS `principle`,`his-tpa`.`relation`.`name` AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`case`.`dob` AS `dob`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`plan_detail`.`name` AS `benefit`,`his-tpa`.`plan_header`.`name` AS `jenis_benefit`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,`his-tpa`.`case_status`.`name` AS `status`,`his-tpa`.`status`.`name` AS `policy_status`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`rider`.`name` AS `rider`,`provider`.`full_name` AS `provider`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`country`.`currency` AS `currency`,`his-tpa`.`case`.`currency_rate` AS `currency_rate`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,if(`his-tpa`.`case`.`haf_doc_completed` = 1,'Pending',if(`his-tpa`.`case`.`haf_doc_completed` = 2,'Not Completed','Completed')) AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,if(`his-tpa`.`case`.`issue_initial_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_initial_log` = 2,'LOG','Non-LOG')) AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_approval` AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,`his-tpa`.`diagnosis`.`name` AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,if(`his-tpa`.`case`.`bill_completed` = 1,'Pending',if(`his-tpa`.`case`.`bill_completed` = 2,'Not completed','Completed')) AS `bill_completed`,if(`his-tpa`.`case`.`ws_finished` = 1,'Done','Not Done') AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,if(`his-tpa`.`case`.`ws_approval` = 1,'Pending',if(`his-tpa`.`case`.`ws_approval` = 2,'Not Approve','Approve')) AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,if(`his-tpa`.`case`.`issue_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_log` = 2,'LOG','Non-LOG')) AS `issue_log`,if(`his-tpa`.`case`.`issue_log_option` = 1,'Full Cover','') AS `issue_log_option`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_approval` AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,if(`his-tpa`.`case`.`original_bill_checked` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_checked` = 2,'Original Bill Not Complete',if(`his-tpa`.`case`.`original_bill_checked` = 3,'WS Revision',if(`his-tpa`.`case`.`original_bill_checked` = 4,'OK','Close Case')))) AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,if(`his-tpa`.`case`.`close_case_option` = 1,'By Document Send Back','By Payment') AS `close_case_option`,if(`his-tpa`.`case`.`original_bill_verified` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_verified` = 2,'Original Bill Not Completed',if(`his-tpa`.`case`.`original_bill_verified` = 3,'WS Revision','OK'))) AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,if(`his-tpa`.`case`.`doc_send_back_to_client_required` = 1,'Required','Not Required') AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,sum(`his-tpa`.`worksheet`.`actual`) AS `actual`,sum(`his-tpa`.`worksheet`.`cover`) AS `cover`,sum(`his-tpa`.`worksheet`.`excess`) AS `excess`,`his-tpa`.`case`.`edit_date` AS `edit_date` from (((((((((((((((((`his-tpa`.`case` left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`principle` on(`his-tpa`.`case`.`principle` = `principle`.`id`)) left join `his-tpa`.`relation` on(`his-tpa`.`case`.`relation` = `his-tpa`.`relation`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`status` on(`his-tpa`.`case`.`policy_status` = `his-tpa`.`status`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id` and `his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` <> 99 and `his-tpa`.`case`.`type` = 3 group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for case_count_by_patient_per_client
-- ----------------------------
DROP VIEW IF EXISTS `case_count_by_patient_per_client`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `case_count_by_patient_per_client` AS select `case_group_by_patient_per_client`.`client_id` AS `client_id`,`case_group_by_patient_per_client`.`client_name` AS `client_name`,`case_group_by_patient_per_client`.`year` AS `year`,count(`case_group_by_patient_per_client`.`patient`) AS `claimed_member` from `her-tpa`.`case_group_by_patient_per_client` group by `case_group_by_patient_per_client`.`client_id`,`case_group_by_patient_per_client`.`client_name`,`case_group_by_patient_per_client`.`year` ;

-- ----------------------------
-- View structure for case_count_per_client
-- ----------------------------
DROP VIEW IF EXISTS `case_count_per_client`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `case_count_per_client` AS select `his-tpa`.`case`.`client` AS `client_id`,`client`.`full_name` AS `client_name`,concat(year(`his-tpa`.`case`.`create_date`),'-',convert(lpad(month(`his-tpa`.`case`.`create_date`),2,0) using utf8mb4)) AS `period`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','ERROR')) AS `category`,count(`his-tpa`.`case`.`id`) AS `total_case` from ((`his-tpa`.`case` join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) where year(`his-tpa`.`case`.`create_date`) is not null and month(`his-tpa`.`case`.`create_date`) is not null and year(`his-tpa`.`case`.`create_date`) = year(curdate()) and `his-tpa`.`case`.`status` <> 96 group by `his-tpa`.`case`.`client`,year(`his-tpa`.`case`.`create_date`),month(`his-tpa`.`case`.`create_date`),`his-tpa`.`case`.`category` ;

-- ----------------------------
-- View structure for case_cover
-- ----------------------------
DROP VIEW IF EXISTS `case_cover`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `case_cover` AS select `his-tpa`.`case`.`id` AS `barcode`,65 AS `height`,if(`his-tpa`.`case`.`status` = 1,'01. Admission - New (Pending Upload HAF & Supporting Document)',if(`his-tpa`.`case`.`status` = 2,'02. Admission - Pending HAF & Supporting Document Completeness Approval',if(`his-tpa`.`case`.`status` = 3,'03. Admission - Pending Issue Initial LOG',if(`his-tpa`.`case`.`status` = 4,'04. Admission - Completed (Discharge - Pending Upload Softcopy Bill)',if(`his-tpa`.`case`.`status` = 5,'05. Discharge - Pending Softcopy Bill Completeness Approval',if(`his-tpa`.`case`.`status` = 6,'06. Discharge - Pending WS Process',if(`his-tpa`.`case`.`status` = 7,'07. Discharge - Pending WS Approval',if(`his-tpa`.`case`.`status` = 8,'08. Discharge - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 9,'09. Discharge - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 10,'10. Discharge - Pending Issue Final LOG',if(`his-tpa`.`case`.`status` = 11,'11. Discharge - Completed (Administration - Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 12,'12. Administration - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 13,'13. Administration - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 14,'14. Administration - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 15,'15. Administration - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 16,'16. Administration - Pending Payment Process',if(`his-tpa`.`case`.`status` = 17,'17. Administration - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 18,'18. Administration - Pending Document Received by Client',if(`his-tpa`.`case`.`status` = 19,'19. Reimbursement - New (Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 20,'20. Reimbursement - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 21,'21. Reimbursement - Pending WS Process',if(`his-tpa`.`case`.`status` = 22,'22. Reimbursement - Pending WS Approval',if(`his-tpa`.`case`.`status` = 23,'23. Reimbursement - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 24,'24. Reimbursement - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 25,'25. Reimbursement - Pending Issue LOG/ Non-LOG',if(`his-tpa`.`case`.`status` = 26,'26. Reimbursement - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 27,'27. Reimbursement - Pending Payment Process',if(`his-tpa`.`case`.`status` = 28,'28. Reimbursement - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 29,'29. Reimbursement - Pending Document Received by Client','ERROR'))))))))))))))))))))))))))))) AS `case_status`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','ERROR')) AS `case_category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Pay & File','ERROR'))) AS `case_type`,`his-tpa`.`case`.`ref` AS `case_ref`,`his-tpa`.`case`.`id` AS `case_id`,`his-tpa`.`case`.`created_by` AS `received_by`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `receive_date`,`his-tpa`.`member`.`member_name` AS `patient`,date_format(`his-tpa`.`case`.`dob`,'%d/%m/%Y') AS `dob`,if(`his-tpa`.`case`.`gender` = 0,'Female',if(`his-tpa`.`case`.`gender` = 1,'Male','ERROR')) AS `gender`,`member_01`.`member_name` AS `principle`,if(`his-tpa`.`case`.`relation` = 1,'Principle',if(`his-tpa`.`case`.`relation` = 2,'Spouse',if(`his-tpa`.`case`.`relation` = 3,'Child',if(`his-tpa`.`case`.`relation` = 4,'Dependant','ERROR')))) AS `relation`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,if(`his-tpa`.`case`.`policy_status` = 0,'Disable',if(`his-tpa`.`case`.`policy_status` = 1,'Enable','ERROR')) AS `policy_status`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') AS `policy_expiry_date`,cast(`his-tpa`.`case`.`special_condition` as char(255) charset utf8) AS `special_condition`,date_format(`his-tpa`.`case`.`policy_issue_date`,'%d/%m/%Y') AS `policy_issue_date`,date_format(`his-tpa`.`case`.`policy_declare_date`,'%d/%m/%Y') AS `policy_declare_date`,date_format(`his-tpa`.`case`.`policy_lapse_date`,'%d/%m/%Y') AS `policy_lapse_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_reinstate_date`,date_format(`his-tpa`.`case`.`policy_termination_date`,'%d/%m/%Y') AS `policy_termination_date`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`plan`.`name` AS `plan`,date_format(`his-tpa`.`case`.`plan_attach_date`,'%d/%m/%Y') AS `plan_attach_date`,date_format(`his-tpa`.`case`.`plan_expiry_date`,'%d/%m/%Y') AS `plan_expiry_date`,`his-tpa`.`rider`.`name` AS `rider`,date_format(`his-tpa`.`case`.`rider_attach_date`,'%d/%m/%Y') AS `rider_attach_date`,date_format(`his-tpa`.`case`.`rider_expiry_date`,'%d/%m/%Y') AS `rider_expiry_date` from ((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) ;

-- ----------------------------
-- View structure for case_detail
-- ----------------------------
DROP VIEW IF EXISTS `case_detail`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `case_detail` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case_status`.`name` AS `case_status`,if(`his-tpa`.`case`.`category` is null,'',if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','-'))) AS `category`,if(`his-tpa`.`case`.`type` is null,'',if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','-'))))) AS `type`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`case`.`dob` AS `dob`,if(`his-tpa`.`case`.`gender` = 0,'Male','Female') AS `gender`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,`member_01`.`member_name` AS `principle`,if(`his-tpa`.`case`.`relation` = 1,'Principle',if(`his-tpa`.`case`.`relation` = 2,'Spouse',if(`his-tpa`.`case`.`relation` = 3,'Child','Dependant'))) AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,if(`his-tpa`.`case`.`policy_status` = 0,'Disable','Enable') AS `policy_status`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`rider`.`name` AS `rider`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,`provider`.`full_name` AS `provider`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`country`.`currency` AS `currency`,`country_01`.`currency` AS `currency_02`,`his-tpa`.`case`.`currency_rate` AS `currency_rate`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,if(`his-tpa`.`case`.`haf_doc_completed` is null,'',if(`his-tpa`.`case`.`haf_doc_completed` = 1,'Pending',if(`his-tpa`.`case`.`haf_doc_completed` = 2,'Not Complete',if(`his-tpa`.`case`.`haf_doc_completed` = 3,'Complete','-')))) AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,if(`his-tpa`.`case`.`issue_initial_log` is null,'',if(`his-tpa`.`case`.`issue_initial_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_initial_log` = 2,'LOG',if(`his-tpa`.`case`.`issue_initial_log` = 3,'Non-LOG','-')))) AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,if(`his-tpa`.`case`.`initial_log_approval` is null,'',if(`his-tpa`.`case`.`initial_log_approval` = 0,'Disagree',if(`his-tpa`.`case`.`initial_log_approval` = 1,'Agree','-'))) AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,`his-tpa`.`diagnosis`.`name` AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,if(`his-tpa`.`case`.`bill_completed` is null,'',if(`his-tpa`.`case`.`bill_completed` = 1,'Pending',if(`his-tpa`.`case`.`bill_completed` = 2,'Not Complete',if(`his-tpa`.`case`.`bill_completed` = 3,'Complete','-')))) AS `bill_completed`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,if(`his-tpa`.`case`.`ws_type` is null,'',if(`his-tpa`.`case`.`ws_type` = 0,'Blank',if(`his-tpa`.`case`.`ws_type` = 1,'Full Benefit','-'))) AS `ws_type`,`his-tpa`.`case`.`ws_option` AS `ws_option`,if(`his-tpa`.`case`.`ws_finished` is null,'',if(`his-tpa`.`case`.`ws_finished` = 0,'Not Done',if(`his-tpa`.`case`.`ws_finished` = 1,'Done','-'))) AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,if(`his-tpa`.`case`.`ws_approval` is null,'',if(`his-tpa`.`case`.`ws_approval` = 1,'Pending',if(`his-tpa`.`case`.`ws_approval` = 2,'Not Approve',if(`his-tpa`.`case`.`ws_approval` = 3,'Approve','-')))) AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,if(`his-tpa`.`case`.`issue_log` is null,'',if(`his-tpa`.`case`.`issue_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_log` = 2,'LOG',if(`his-tpa`.`case`.`issue_log` = 3,'Non-LOG','-')))) AS `issue_log`,if(`his-tpa`.`case`.`issue_log_option` is null,'',if(`his-tpa`.`case`.`issue_log_option` = 1,'Full Cover','-')) AS `issue_log_option`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`claim_no` AS `claim_no`,if(`his-tpa`.`case`.`log_approval` is null,'',if(`his-tpa`.`case`.`log_approval` = 0,'Disagree',if(`his-tpa`.`case`.`log_approval` = 1,'Agree','-'))) AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,if(`his-tpa`.`case`.`original_bill_checked` is null,'',if(`his-tpa`.`case`.`original_bill_checked` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_checked` = 2,'Original Bill Not Completed',if(`his-tpa`.`case`.`original_bill_checked` = 3,'WS Revision',if(`his-tpa`.`case`.`original_bill_checked` = 4,'OK',if(`his-tpa`.`case`.`original_bill_checked` = 5,'Close Case','-')))))) AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,if(`his-tpa`.`case`.`close_case_option` is null,'',if(`his-tpa`.`case`.`close_case_option` = 1,'By Document Sent Back',if(`his-tpa`.`case`.`close_case_option` = 2,'By Payment','-'))) AS `close_case_option`,if(`his-tpa`.`case`.`original_bill_verified` is null,'',if(`his-tpa`.`case`.`original_bill_verified` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_verified` = 2,'Originall Bill Not Completed',if(`his-tpa`.`case`.`original_bill_verified` = 3,'WS Revision',if(`his-tpa`.`case`.`original_bill_verified` = 4,'OK','-'))))) AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,if(`his-tpa`.`case`.`doc_send_back_to_client_required` is null,'',if(`his-tpa`.`case`.`doc_send_back_to_client_required` = 1,'Required',if(`his-tpa`.`case`.`doc_send_back_to_client_required` = 2,'Not Required','-'))) AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,`worksheet_header`.`total_actual` AS `total_actual`,`worksheet_header`.`total_excess` AS `total_excess`,`his-tpa`.`case`.`edited_by` AS `edited_by`,`his-tpa`.`case`.`edit_date` AS `edit_date` from (((((((((((((((`his-tpa`.`case` left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`id`)) left join `his-tpa`.`country` `country_01` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`userlevels` on(`his-tpa`.`case`.`userlevel` = `his-tpa`.`userlevels`.`userlevelid`)) left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) where `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` <> 98 and `his-tpa`.`case`.`status` <> 99 and `his-tpa`.`case_status`.`userlevels` = -1 ;

-- ----------------------------
-- View structure for case_group_by_patient_per_client
-- ----------------------------
DROP VIEW IF EXISTS `case_group_by_patient_per_client`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `case_group_by_patient_per_client` AS select `his-tpa`.`case`.`client` AS `client_id`,`client`.`full_name` AS `client_name`,year(`his-tpa`.`case`.`create_date`) AS `year`,`his-tpa`.`case`.`patient` AS `patient` from (`his-tpa`.`case` join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) where year(`his-tpa`.`case`.`create_date`) is not null group by `his-tpa`.`case`.`client`,year(`his-tpa`.`case`.`create_date`),`his-tpa`.`case`.`patient` ;

-- ----------------------------
-- View structure for case_member_ratio_per_client
-- ----------------------------
DROP VIEW IF EXISTS `case_member_ratio_per_client`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `case_member_ratio_per_client` AS select `case_count_by_patient_per_client`.`client_id` AS `client_id`,`case_count_by_patient_per_client`.`client_name` AS `client_name`,`case_count_by_patient_per_client`.`year` AS `year`,`member_count_per_client`.`total_member` AS `total_member`,`case_count_by_patient_per_client`.`claimed_member` AS `claimed_member`,`case_count_by_patient_per_client`.`claimed_member` / `member_count_per_client`.`total_member` * 100 AS `ratio` from (`her-tpa`.`case_count_by_patient_per_client` join `her-tpa`.`member_count_per_client` on(`case_count_by_patient_per_client`.`client_id` = `member_count_per_client`.`client_id` and `case_count_by_patient_per_client`.`year` = `member_count_per_client`.`year`)) ;

-- ----------------------------
-- View structure for case_reimbursement
-- ----------------------------
DROP VIEW IF EXISTS `case_reimbursement`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `case_reimbursement` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case_status`.`name` AS `case_status`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,if(`his-tpa`.`case`.`category` = 0,'Outpatient','Inpatient') AS `category`,`his-tpa`.`member`.`member_name` AS `patient`,if(`his-tpa`.`member`.`member_gender` = 0,'Female',if(`his-tpa`.`member`.`member_gender` = 1,'Male','ERROR')) AS `gender`,`principle`.`member_name` AS `principle`,`his-tpa`.`relation`.`name` AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`case`.`dob` AS `dob`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`plan_detail`.`name` AS `benefit`,`his-tpa`.`plan_header`.`name` AS `jenis_benefit`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,`his-tpa`.`case_status`.`name` AS `status`,`his-tpa`.`status`.`name` AS `policy_status`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`rider`.`name` AS `rider`,`provider`.`full_name` AS `provider`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`country`.`currency` AS `currency`,`his-tpa`.`case`.`currency_rate` AS `currency_rate`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,if(`his-tpa`.`case`.`haf_doc_completed` = 1,'Pending',if(`his-tpa`.`case`.`haf_doc_completed` = 2,'Not Completed','Completed')) AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,if(`his-tpa`.`case`.`issue_initial_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_initial_log` = 2,'LOG','Non-LOG')) AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_approval` AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,`his-tpa`.`diagnosis`.`name` AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,if(`his-tpa`.`case`.`bill_completed` = 1,'Pending',if(`his-tpa`.`case`.`bill_completed` = 2,'Not completed','Completed')) AS `bill_completed`,if(`his-tpa`.`case`.`ws_finished` = 1,'Done','Not Done') AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,if(`his-tpa`.`case`.`ws_approval` = 1,'Pending',if(`his-tpa`.`case`.`ws_approval` = 2,'Not Approve','Approve')) AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,if(`his-tpa`.`case`.`issue_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_log` = 2,'LOG','Non-LOG')) AS `issue_log`,if(`his-tpa`.`case`.`issue_log_option` = 1,'Full Cover','') AS `issue_log_option`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_approval` AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,if(`his-tpa`.`case`.`original_bill_checked` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_checked` = 2,'Original Bill Not Complete',if(`his-tpa`.`case`.`original_bill_checked` = 3,'WS Revision',if(`his-tpa`.`case`.`original_bill_checked` = 4,'OK','Close Case')))) AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,if(`his-tpa`.`case`.`close_case_option` = 1,'By Document Send Back','By Payment') AS `close_case_option`,if(`his-tpa`.`case`.`original_bill_verified` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_verified` = 2,'Original Bill Not Completed',if(`his-tpa`.`case`.`original_bill_verified` = 3,'WS Revision','OK'))) AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,if(`his-tpa`.`case`.`doc_send_back_to_client_required` = 1,'Required','Not Required') AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,sum(`his-tpa`.`worksheet`.`actual`) AS `actual`,sum(`his-tpa`.`worksheet`.`cover`) AS `cover`,sum(`his-tpa`.`worksheet`.`excess`) AS `excess`,`his-tpa`.`case`.`edit_date` AS `edit_date` from (((((((((((((((((`his-tpa`.`case` left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`principle` on(`his-tpa`.`case`.`principle` = `principle`.`id`)) left join `his-tpa`.`relation` on(`his-tpa`.`case`.`relation` = `his-tpa`.`relation`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`status` on(`his-tpa`.`case`.`policy_status` = `his-tpa`.`status`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id` and `his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` <> 99 and `his-tpa`.`case`.`type` in (1,4) group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for case_singapore
-- ----------------------------
DROP VIEW IF EXISTS `case_singapore`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `case_singapore` AS select if(`his-tpa`.`case`.`source` = 0,'Healthcare System',if(`his-tpa`.`case`.`source` = 1,'MedisClick - Admission',if(`his-tpa`.`case`.`source` = 2,'MedisClick - Pre Admission',if(`his-tpa`.`case`.`source` = 3,'e-Centrix',if(`his-tpa`.`case`.`source` = 4,'e-Reimbursement',if(`his-tpa`.`case`.`source` = 5,'Hospital Portal',if(`his-tpa`.`case`.`source` = 6,'EDC',if(`his-tpa`.`case`.`source` = 7,'QR Code','')))))))) AS `case_source`,`his-tpa`.`case`.`id` AS `case_number`,`his-tpa`.`case_status`.`name` AS `status`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','')) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,`client`.`full_name` AS `client`,`patient`.`member_name` AS `member_name`,`patient`.`member_card` AS `member_card`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`provider`.`full_name` AS `provider`,`provider`.`province` AS `provider_province`,`provider`.`city` AS `provider_city`,`his-tpa`.`worksheet`.`actual` AS `actual`,`his-tpa`.`worksheet`.`cover` AS `cover`,`his-tpa`.`worksheet`.`excess` AS `excess`,`his-tpa`.`case`.`create_date` AS `create_date` from (((((`his-tpa`.`case` left join `his-tpa`.`patient` on(`patient`.`id` = `his-tpa`.`case`.`patient`)) left join `his-tpa`.`client` on(`client`.`id` = `his-tpa`.`case`.`client`)) left join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`worksheet`.`case` = `his-tpa`.`case`.`id`)) join `his-tpa`.`case_status` on(`his-tpa`.`case_status`.`id` = `his-tpa`.`case`.`status`)) where `his-tpa`.`case_status`.`userlevels` = -1 and date_format(`his-tpa`.`case`.`create_date`,'%Y-%m-%d') >= '2017-01-01' and date_format(`his-tpa`.`case`.`create_date`,'%Y-%m-%d') <= '2017-12-31' and `patient`.`member_name` <> '%dummy' and `his-tpa`.`case`.`type` in (1,2) and `his-tpa`.`case`.`source` in (0,5) and `provider`.`country` = 170 ;

-- ----------------------------
-- View structure for case_status_based_provider
-- ----------------------------
DROP VIEW IF EXISTS `case_status_based_provider`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `case_status_based_provider` AS select `his-tpa-dev`.`case`.`provider` AS `provider_id`,`provider`.`full_name` AS `provider_name`,if(`his-tpa-dev`.`case`.`status` = 1,'Proses Rawat Inap',if(`his-tpa-dev`.`case`.`status` = 2,'Proses Rawat Inap',if(`his-tpa-dev`.`case`.`status` = 3,'Penjaminan Awal',if(`his-tpa-dev`.`case`.`status` = 4,'Pasien Pulang',if(`his-tpa-dev`.`case`.`status` = 5,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 6,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 7,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 8,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 9,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 10,'Penjaminan Akhir',if(`his-tpa-dev`.`case`.`status` = 11,'Menunggu Dokumen',if(`his-tpa-dev`.`case`.`status` = 12,'Menunggu Dokumen',if(`his-tpa-dev`.`case`.`status` = 13,'Dokumen Lengkap',if(`his-tpa-dev`.`case`.`status` = 14,'Proses Pembayaran',if(`his-tpa-dev`.`case`.`status` = 15,'Proses Pembayaran',if(`his-tpa-dev`.`case`.`status` = 16,'Proses Pembayaran',if(`his-tpa-dev`.`case`.`status` = 17,'Sudah Dibayarkan',if(`his-tpa-dev`.`case`.`status` = 18,'Sudah Dibayarkan',if(`his-tpa-dev`.`case`.`status` = 19,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 20,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 21,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 22,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 23,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 24,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 25,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 26,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 27,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 28,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 29,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 30,'Sudah Dibayarkan','ERROR')))))))))))))))))))))))))))))) AS `status`,if(`his-tpa-dev`.`case`.`category` = 0,'Outpatient',if(`his-tpa-dev`.`case`.`category` = 1,'Inpatient','ERROR')) AS `category`,count(`his-tpa-dev`.`case`.`id`) AS `count` from ((`his-tpa-dev`.`case` join `his-tpa-dev`.`provider` on(`his-tpa-dev`.`case`.`provider` = `provider`.`id`)) left join `his-tpa-dev`.`status_hospital` on(`his-tpa-dev`.`case`.`status` = `his-tpa-dev`.`status_hospital`.`id`)) where `his-tpa-dev`.`case`.`status` between 1 and 30 and `provider`.`country` = 85 group by `his-tpa-dev`.`case`.`provider`,if(`his-tpa-dev`.`case`.`status` = 1,'Proses Rawat Inap',if(`his-tpa-dev`.`case`.`status` = 2,'Proses Rawat Inap',if(`his-tpa-dev`.`case`.`status` = 3,'Penjaminan Awal',if(`his-tpa-dev`.`case`.`status` = 4,'Pasien Pulang',if(`his-tpa-dev`.`case`.`status` = 5,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 6,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 7,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 8,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 9,'Monitoring Administrasi',if(`his-tpa-dev`.`case`.`status` = 10,'Penjaminan Akhir',if(`his-tpa-dev`.`case`.`status` = 11,'Menunggu Dokumen',if(`his-tpa-dev`.`case`.`status` = 12,'Menunggu Dokumen',if(`his-tpa-dev`.`case`.`status` = 13,'Dokumen Lengkap',if(`his-tpa-dev`.`case`.`status` = 14,'Proses Pembayaran',if(`his-tpa-dev`.`case`.`status` = 15,'Proses Pembayaran',if(`his-tpa-dev`.`case`.`status` = 16,'Proses Pembayaran',if(`his-tpa-dev`.`case`.`status` = 17,'Sudah Dibayarkan',if(`his-tpa-dev`.`case`.`status` = 18,'Sudah Dibayarkan',if(`his-tpa-dev`.`case`.`status` = 19,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 20,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 21,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 22,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 23,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 24,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 25,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 26,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 27,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 28,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 29,'Cek Data Administrasi oleh AAI',if(`his-tpa-dev`.`case`.`status` = 30,'Sudah Dibayarkan','ERROR')))))))))))))))))))))))))))))),`his-tpa-dev`.`case`.`category` order by `his-tpa-dev`.`case`.`status` ;

-- ----------------------------
-- View structure for case_status_count
-- ----------------------------
DROP VIEW IF EXISTS `case_status_count`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `case_status_count` AS select `his-tpa`.`case`.`client` AS `client_id`,`client`.`full_name` AS `client_name`,if(`his-tpa`.`case`.`status` = 1,'01. Admission - New (Pending Upload HAF & Supporting Document)',if(`his-tpa`.`case`.`status` = 2,'02. Admission - Pending HAF & Supporting Document Completeness Approval',if(`his-tpa`.`case`.`status` = 3,'03. Admission - Pending Issue Initial LOG',if(`his-tpa`.`case`.`status` = 4,'04. Admission - Completed (Discharge - Pending Upload Softcopy Bill)',if(`his-tpa`.`case`.`status` = 5,'05. Discharge - Pending Softcopy Bill Completeness Approval',if(`his-tpa`.`case`.`status` = 6,'06. Discharge - Pending WS Process',if(`his-tpa`.`case`.`status` = 7,'07. Discharge - Pending WS Approval',if(`his-tpa`.`case`.`status` = 8,'08. Discharge - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 9,'09. Discharge - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 10,'10. Discharge - Pending Issue Final LOG',if(`his-tpa`.`case`.`status` = 11 and `his-tpa`.`case`.`original_bill_checked` <> 2,'11a. Discharge - Completed (Administration - Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 11 and `his-tpa`.`case`.`original_bill_checked` = 2,'11b. Discharge - Completed (Administration - Pending Document Completeness)',if(`his-tpa`.`case`.`status` = 12,'12. Administration - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 13,'13. Administration - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 14,'14. Administration - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 15,'15. Administration - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 16,if(`his-tpa`.`case`.`client_approval_for_payment` is null,'15a. Administration - Pending Client Approval for Payment','16. Administration - Pending Payment Process'),if(`his-tpa`.`case`.`status` = 17,'17. Administration - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 18,'18. Administration - Pending Document Received by Client',if(`his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` <> 2,'19a. Reimbursement - New (Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` = 2,'19b. Reimbursement - New (Pending Document Completeness)',if(`his-tpa`.`case`.`status` = 20,'20. Reimbursement - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 21,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','21. Reimbursement - Pending WS Process'),if(`his-tpa`.`case`.`status` = 22,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','22. Reimbursement - Pending WS Approval'),if(`his-tpa`.`case`.`status` = 23,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','23. Reimbursement - Pending WS Process (Revision)'),if(`his-tpa`.`case`.`status` = 24,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','24. Reimbursement - Pending WS Approval (Revision)'),if(`his-tpa`.`case`.`status` = 25,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','25. Reimbursement - Pending Issue LOG/ Non LOG'),if(`his-tpa`.`case`.`status` = 26,'26. Reimbursement - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 27,if(`his-tpa`.`case`.`client_approval_for_payment` is null,'26a. Reimbursement - Pending Client Approval for Payment','27. Reimbursement - Pending Payment Process'),if(`his-tpa`.`case`.`status` = 28,'28. Reimbursement - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 29,'29. Reimbursement - Pending Document Received by Client','ERROR'))))))))))))))))))))))))))))))) AS `status`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','ERROR')) AS `category`,count(`his-tpa`.`case`.`id`) AS `count` from (`his-tpa`.`case` join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) where `his-tpa`.`case`.`status` between 1 and 29 and `his-tpa`.`case`.`client` <> 3 group by `his-tpa`.`case`.`client`,if(`his-tpa`.`case`.`status` = 1,'01. Admission - New (Pending Upload HAF & Supporting Document)',if(`his-tpa`.`case`.`status` = 2,'02. Admission - Pending HAF & Supporting Document Completeness Approval',if(`his-tpa`.`case`.`status` = 3,'03. Admission - Pending Issue Initial LOG',if(`his-tpa`.`case`.`status` = 4,'04. Admission - Completed (Discharge - Pending Upload Softcopy Bill)',if(`his-tpa`.`case`.`status` = 5,'05. Discharge - Pending Softcopy Bill Completeness Approval',if(`his-tpa`.`case`.`status` = 6,'06. Discharge - Pending WS Process',if(`his-tpa`.`case`.`status` = 7,'07. Discharge - Pending WS Approval',if(`his-tpa`.`case`.`status` = 8,'08. Discharge - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 9,'09. Discharge - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 10,'10. Discharge - Pending Issue Final LOG',if(`his-tpa`.`case`.`status` = 11 and `his-tpa`.`case`.`original_bill_checked` <> 2,'11a. Discharge - Completed (Administration - Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 11 and `his-tpa`.`case`.`original_bill_checked` = 2,'11b. Discharge - Completed (Administration - Pending Document Completeness)',if(`his-tpa`.`case`.`status` = 12,'12. Administration - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 13,'13. Administration - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 14,'14. Administration - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 15,'15. Administration - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 16,if(`his-tpa`.`case`.`client_approval_for_payment` is null,'15a. Administration - Pending Client Approval for Payment','16. Administration - Pending Payment Process'),if(`his-tpa`.`case`.`status` = 17,'17. Administration - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 18,'18. Administration - Pending Document Received by Client',if(`his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` <> 2,'19a. Reimbursement - New (Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` = 2,'19b. Reimbursement - New (Pending Document Completeness)',if(`his-tpa`.`case`.`status` = 20,'20. Reimbursement - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 21,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','21. Reimbursement - Pending WS Process'),if(`his-tpa`.`case`.`status` = 22,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','22. Reimbursement - Pending WS Approval'),if(`his-tpa`.`case`.`status` = 23,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','23. Reimbursement - Pending WS Process (Revision)'),if(`his-tpa`.`case`.`status` = 24,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','24. Reimbursement - Pending WS Approval (Revision)'),if(`his-tpa`.`case`.`status` = 25,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','25. Reimbursement - Pending Issue LOG/ Non LOG'),if(`his-tpa`.`case`.`status` = 26,'26. Reimbursement - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 27,if(`his-tpa`.`case`.`client_approval_for_payment` is null,'26a. Reimbursement - Pending Client Approval for Payment','27. Reimbursement - Pending Payment Process'),if(`his-tpa`.`case`.`status` = 28,'28. Reimbursement - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 29,'29. Reimbursement - Pending Document Received by Client','ERROR'))))))))))))))))))))))))))))))),`his-tpa`.`case`.`category` order by `his-tpa`.`case`.`status` ;

-- ----------------------------
-- View structure for case_status_count_01
-- ----------------------------
DROP VIEW IF EXISTS `case_status_count_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `case_status_count_01` AS select `his-tpa`.`case`.`client` AS `client_id`,`client`.`full_name` AS `client_name`,if(`his-tpa`.`case`.`status` = 1,'01. Admission - New (Pending Upload HAF & Supporting Document)',if(`his-tpa`.`case`.`status` = 2,'02. Admission - Pending HAF & Supporting Document Completeness Approval',if(`his-tpa`.`case`.`status` = 3,'03. Admission - Pending Issue Initial LOG',if(`his-tpa`.`case`.`status` = 4,'04. Admission - Completed (Discharge - Pending Upload Softcopy Bill)',if(`his-tpa`.`case`.`status` = 5,'05. Discharge - Pending Softcopy Bill Completeness Approval',if(`his-tpa`.`case`.`status` = 6,'06. Discharge - Pending WS Process',if(`his-tpa`.`case`.`status` = 7,'07. Discharge - Pending WS Approval',if(`his-tpa`.`case`.`status` = 8,'08. Discharge - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 9,'09. Discharge - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 10,'10. Discharge - Pending Issue Final LOG',if(`his-tpa`.`case`.`status` = 11 and `his-tpa`.`case`.`original_bill_checked` <> 2,'11a. Discharge - Completed (Administration - Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 11 and `his-tpa`.`case`.`original_bill_checked` = 2,'11b. Discharge - Completed (Administration - Pending Document Completeness)',if(`his-tpa`.`case`.`status` = 12,'12. Administration - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 13,'13. Administration - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 14,'14. Administration - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 15,'15. Administration - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 16,if(`his-tpa`.`case`.`client_approval_for_payment` is null,'15a. Administration - Pending Client Approval for Payment','16. Administration - Pending Payment Process'),if(`his-tpa`.`case`.`status` = 17,'17. Administration - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 18,'18. Administration - Pending Document Received by Client',if(`his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` <> 2,'19a. Reimbursement - New (Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` = 2,'19b. Reimbursement - New (Pending Document Completeness)',if(`his-tpa`.`case`.`status` = 20,'20. Reimbursement - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 21,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','21. Reimbursement - Pending WS Process'),if(`his-tpa`.`case`.`status` = 22,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','22. Reimbursement - Pending WS Approval'),if(`his-tpa`.`case`.`status` = 23,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','23. Reimbursement - Pending WS Process (Revision)'),if(`his-tpa`.`case`.`status` = 24,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','24. Reimbursement - Pending WS Approval (Revision)'),if(`his-tpa`.`case`.`status` = 25,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','25. Reimbursement - Pending Issue LOG/ Non LOG'),if(`his-tpa`.`case`.`status` = 26,'26. Reimbursement - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 27,if(`his-tpa`.`case`.`client_approval_for_payment` is null,'26a. Reimbursement - Pending Client Approval for Payment','27. Reimbursement - Pending Payment Process'),if(`his-tpa`.`case`.`status` = 28,'28. Reimbursement - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 29,'29. Reimbursement - Pending Document Received by Client','ERROR'))))))))))))))))))))))))))))))) AS `status`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','ERROR')) AS `category`,count(`his-tpa`.`case`.`id`) AS `count` from (`his-tpa`.`case` join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) where `his-tpa`.`case`.`status` between 1 and 29 and `his-tpa`.`case`.`client` <> 3 and `his-tpa`.`case`.`type` = 1 group by `his-tpa`.`case`.`client`,if(`his-tpa`.`case`.`status` = 1,'01. Admission - New (Pending Upload HAF & Supporting Document)',if(`his-tpa`.`case`.`status` = 2,'02. Admission - Pending HAF & Supporting Document Completeness Approval',if(`his-tpa`.`case`.`status` = 3,'03. Admission - Pending Issue Initial LOG',if(`his-tpa`.`case`.`status` = 4,'04. Admission - Completed (Discharge - Pending Upload Softcopy Bill)',if(`his-tpa`.`case`.`status` = 5,'05. Discharge - Pending Softcopy Bill Completeness Approval',if(`his-tpa`.`case`.`status` = 6,'06. Discharge - Pending WS Process',if(`his-tpa`.`case`.`status` = 7,'07. Discharge - Pending WS Approval',if(`his-tpa`.`case`.`status` = 8,'08. Discharge - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 9,'09. Discharge - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 10,'10. Discharge - Pending Issue Final LOG',if(`his-tpa`.`case`.`status` = 11 and `his-tpa`.`case`.`original_bill_checked` <> 2,'11a. Discharge - Completed (Administration - Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 11 and `his-tpa`.`case`.`original_bill_checked` = 2,'11b. Discharge - Completed (Administration - Pending Document Completeness)',if(`his-tpa`.`case`.`status` = 12,'12. Administration - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 13,'13. Administration - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 14,'14. Administration - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 15,'15. Administration - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 16,if(`his-tpa`.`case`.`client_approval_for_payment` is null,'15a. Administration - Pending Client Approval for Payment','16. Administration - Pending Payment Process'),if(`his-tpa`.`case`.`status` = 17,'17. Administration - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 18,'18. Administration - Pending Document Received by Client',if(`his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` <> 2,'19a. Reimbursement - New (Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` = 2,'19b. Reimbursement - New (Pending Document Completeness)',if(`his-tpa`.`case`.`status` = 20,'20. Reimbursement - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 21,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','21. Reimbursement - Pending WS Process'),if(`his-tpa`.`case`.`status` = 22,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','22. Reimbursement - Pending WS Approval'),if(`his-tpa`.`case`.`status` = 23,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','23. Reimbursement - Pending WS Process (Revision)'),if(`his-tpa`.`case`.`status` = 24,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','24. Reimbursement - Pending WS Approval (Revision)'),if(`his-tpa`.`case`.`status` = 25,if(`his-tpa`.`case`.`original_bill_checked_01` is null,'20a. Reimbursement - Pending Information Completeness','25. Reimbursement - Pending Issue LOG/ Non LOG'),if(`his-tpa`.`case`.`status` = 26,'26. Reimbursement - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 27,if(`his-tpa`.`case`.`client_approval_for_payment` is null,'26a. Reimbursement - Pending Client Approval for Payment','27. Reimbursement - Pending Payment Process'),if(`his-tpa`.`case`.`status` = 28,'28. Reimbursement - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 29,'29. Reimbursement - Pending Document Received by Client','ERROR'))))))))))))))))))))))))))))))),`his-tpa`.`case`.`category` order by `his-tpa`.`case`.`status` ;

-- ----------------------------
-- View structure for case_summary
-- ----------------------------
DROP VIEW IF EXISTS `case_summary`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `case_summary` AS select `his-tpa`.`plan_detail`.`name` AS `benefit`,sum(`his-tpa`.`worksheet`.`actual`) AS `total_actual`,sum(`his-tpa`.`worksheet`.`cover`) AS `total_cover`,sum(`his-tpa`.`worksheet`.`excess`) AS `total_excess` from ((`his-tpa`.`case` join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case`.`client` = 11 group by `his-tpa`.`plan_detail`.`name` ;

-- ----------------------------
-- View structure for cashless_case_tat
-- ----------------------------
DROP VIEW IF EXISTS `cashless_case_tat`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `cashless_case_tat` AS select `his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`member`.`member_dob` AS `dob`,`his-tpa`.`member`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,`provider`.`full_name` AS `provider`,cast(`his-tpa`.`case`.`create_date` as date) AS `create_date`,cast(`his-tpa`.`case`.`original_bill_upload_date` as date) AS `original_bill_upload_date`,cast(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) as datetime) AS `admission_date`,`his-tpa`.`case`.`initial_log_issued_by` AS `pic_01`,cast(`his-tpa`.`case`.`initial_log_issue_date` as datetime) AS `date_01`,'00:30:00' AS `target_01`,coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'N/A') AS `tat_01`,coalesce(if(timediff('00:30:00',timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_01`,cast(`his-tpa`.`case`.`discharge_date` as datetime) AS `discharge_date`,`his-tpa`.`case`.`log_issued_by` AS `pic_02`,cast(`his-tpa`.`case`.`log_issue_date` as datetime) AS `date_02`,'00:60:00' AS `target_02`,coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') AS `tat_02`,coalesce(if(timediff('00:60:00',timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_02`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `ws_process_finished_date`,'00:30:00' AS `target_03`,coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') AS `tat_03`,cast(`his-tpa`.`case`.`ws_approval_date` as datetime) AS `ws_process_approved_date`,`his-tpa`.`case`.`ws_approval_by` AS `pic_04`,cast(`his-tpa`.`case`.`ws_approval_date` as datetime) AS `date_04`,'00:15:00' AS `target_04`,coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'N/A') AS `tat_04`,coalesce(if(timediff('00:15:00',timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_04`,cast(`activity_log_status_09`.`datetime` as datetime) AS `ws_revise_finished_date`,'00:15:00' AS `target_05`,coalesce(timediff(`activity_log_status_09`.`datetime`,`activity_log_status_08`.`datetime`),'N/A') AS `tat_05`,cast(`activity_log_status_10`.`datetime` as datetime) AS `ws_revise_approved_date`,'00:15:00' AS `target_06`,coalesce(timediff(`activity_log_status_10`.`datetime`,`activity_log_status_09`.`datetime`),'N/A') AS `tat_06`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `original_bill_checked_date`,`his-tpa`.`case`.`original_bill_checked_by` AS `pic_07`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `date_07`,'00:15:00' AS `target_07`,coalesce(timediff(`activity_log_status_15`.`datetime`,`activity_log_status_14`.`datetime`),'N/A') AS `tat_07`,coalesce(if(timediff('00:15:00',timediff(`activity_log_status_15`.`datetime`,`activity_log_status_14`.`datetime`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_07`,cast(`his-tpa`.`case`.`original_bill_verified_date` as datetime) AS `original_bill_verified_date`,'00:15:00' AS `target_08`,coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,if(`his-tpa`.`case`.`original_bill_checked_date` > coalesce(`activity_log_status_15`.`datetime`,'00:00:00'),`his-tpa`.`case`.`original_bill_checked_date`,coalesce(`activity_log_status_15`.`datetime`,'00:00:00'))),'N/A') AS `tat_08`,cast(`his-tpa`.`case`.`payment_date` as datetime) AS `payment_date`,'00:15:00' AS `target_09`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'N/A') AS `tat_09`,addtime(addtime(addtime(addtime(coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'00:00:00')),addtime(coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'00:00:00'))),addtime(addtime(coalesce(timediff(`activity_log_status_09`.`datetime`,`activity_log_status_08`.`datetime`),'00:00:00'),coalesce(timediff(`activity_log_status_10`.`datetime`,`activity_log_status_09`.`datetime`),'00:00:00')),addtime(coalesce(timediff(`activity_log_status_15`.`datetime`,`activity_log_status_14`.`datetime`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,if(`his-tpa`.`case`.`original_bill_checked_date` > coalesce(`activity_log_status_15`.`datetime`,'00:00:00'),`his-tpa`.`case`.`original_bill_checked_date`,coalesce(`activity_log_status_15`.`datetime`,'00:00:00'))),'00:00:00')))),coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'N/A')) AS `total_tat`,`his-tpa`.`case`.`ws_finished_by` AS `pic_10`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `date_10`,'288:00:00' AS `target_10`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,`activity_log_status_09`.`datetime`),'N/A') AS `tat_10`,coalesce(if(timediff('288:00:00',timediff(`his-tpa`.`case`.`payment_date`,`activity_log_status_09`.`datetime`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_10` from (((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `her-tpa`.`activity_log_status_08` on(`his-tpa`.`case`.`id` = `activity_log_status_08`.`case`)) left join `her-tpa`.`activity_log_status_09` on(`his-tpa`.`case`.`id` = `activity_log_status_09`.`case`)) left join `her-tpa`.`activity_log_status_10` on(`his-tpa`.`case`.`id` = `activity_log_status_10`.`case`)) left join `her-tpa`.`activity_log_status_15` on(`his-tpa`.`case`.`id` = `activity_log_status_15`.`case`)) left join `her-tpa`.`activity_log_status_14` on(`his-tpa`.`case`.`id` = `activity_log_status_14`.`case`)) left join `her-tpa`.`activity_log_status_13` on(`his-tpa`.`case`.`id` = `activity_log_status_13`.`case`)) where `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`status` not in (99,98,32,31) ;

-- ----------------------------
-- View structure for cashless_case_tat_01
-- ----------------------------
DROP VIEW IF EXISTS `cashless_case_tat_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `cashless_case_tat_01` AS select `his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','ERROR')) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`member`.`member_dob` AS `dob`,`his-tpa`.`member`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,`provider`.`full_name` AS `provider`,cast(`his-tpa`.`case`.`create_date` as datetime) AS `create_date`,cast(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) as datetime) AS `admission_date`,cast(`his-tpa`.`case`.`discharge_date` as datetime) AS `discharge_date`,`his-tpa`.`case`.`haf_doc_completed_by` AS `pic_01a`,`his-tpa`.`case`.`initial_log_issued_by` AS `pic_01b`,cast(`his-tpa`.`case`.`haf_doc_completed_date` as datetime) AS `date_01a`,cast(`his-tpa`.`case`.`initial_log_issue_date` as datetime) AS `date_01b`,'00:30:00' AS `target_01`,coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'N/A') AS `tat_01`,if(coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'N/A') = 'N/A','N/A',if(coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'N/A') > 30,'Not Achieved',if(coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'N/A') < 31,'Achieved','ERROR'))) AS `achievement_01`,`his-tpa`.`case`.`bill_completed_by` AS `pic_02a`,`his-tpa`.`case`.`log_issued_by` AS `pic_02b`,cast(`his-tpa`.`case`.`bill_completed_date` as datetime) AS `date_02a`,cast(`his-tpa`.`case`.`log_issue_date` as datetime) AS `date_02b`,'00:30:00' AS `target_02`,coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') AS `tat_02`,if(coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') = 'N/A','N/A',if(coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') > 30,'Not Achieved',if(coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') < 31,'Achieved','ERROR'))) AS `achievement_02` from (((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) where `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`status` not in (99,98,32,31) ;

-- ----------------------------
-- View structure for cashless_case_tat_02
-- ----------------------------
DROP VIEW IF EXISTS `cashless_case_tat_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `cashless_case_tat_02` AS select `his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','ERROR')) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`member`.`member_dob` AS `dob`,`his-tpa`.`member`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,`provider`.`full_name` AS `provider`,cast(`his-tpa`.`case`.`create_date` as datetime) AS `create_date`,cast(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) as datetime) AS `admission_date`,cast(`his-tpa`.`case`.`discharge_date` as datetime) AS `discharge_date`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `pic_01a`,`his-tpa`.`case`.`original_bill_checked_by` AS `pic_01b`,cast(`his-tpa`.`case`.`original_bill_upload_date` as datetime) AS `date_01a`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `date_01b`,'5' AS `target_01`,coalesce(`getworkingday`(`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`original_bill_checked_date`,'work_days'),'N/A') AS `tat_01`,if(coalesce(`getworkingday`(`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`original_bill_checked_date`,'work_days'),'N/A') = 'N/A','N/A',if(coalesce(`getworkingday`(`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`original_bill_checked_date`,'work_days'),'N/A') > 5,'Not Achieved',if(coalesce(`getworkingday`(`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`original_bill_checked_date`,'work_days'),'N/A') < 5,'Achieved','ERROR'))) AS `achievement_01`,if(`his-tpa`.`case`.`is_clean` = 0,'No',if(`his-tpa`.`case`.`is_clean` = 1,'Yes','ERROR')) AS `is_clean` from (((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) where `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`status` not in (99,98,32,31) and `his-tpa`.`case`.`ws_approval` = 3 ;

-- ----------------------------
-- View structure for cashless_case_tat_period_01
-- ----------------------------
DROP VIEW IF EXISTS `cashless_case_tat_period_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `cashless_case_tat_period_01` AS select `his-tpa`.`case`.`id` AS `case`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`member`.`member_dob` AS `dob`,`his-tpa`.`member`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,`provider`.`full_name` AS `provider`,cast(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) as datetime) AS `admission_date`,`his-tpa`.`case`.`initial_log_issued_by` AS `pic_01`,cast(`his-tpa`.`case`.`initial_log_issue_date` as datetime) AS `date_01`,'00:30:00' AS `target_01`,coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'N/A') AS `tat_01`,coalesce(if(timediff('00:30:00',timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_01`,cast(`his-tpa`.`case`.`discharge_date` as datetime) AS `discharge_date`,`his-tpa`.`case`.`log_issued_by` AS `pic_02`,cast(`his-tpa`.`case`.`log_issue_date` as datetime) AS `date_02`,'00:60:00' AS `target_02`,coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') AS `tat_02`,coalesce(if(timediff('00:60:00',timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_02`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `ws_process_finished_date`,'00:30:00' AS `target_03`,coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') AS `tat_03`,cast(`his-tpa`.`case`.`ws_approval_date` as datetime) AS `ws_process_approved_date`,`his-tpa`.`case`.`ws_approval_by` AS `pic_04`,cast(`his-tpa`.`case`.`ws_approval_date` as datetime) AS `date_04`,'00:15:00' AS `target_04`,coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'N/A') AS `tat_04`,coalesce(if(timediff('00:15:00',timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_04`,cast(`activity_log_status_09`.`datetime` as datetime) AS `ws_revise_finished_date`,'00:15:00' AS `target_05`,coalesce(timediff(`activity_log_status_09`.`datetime`,`activity_log_status_08`.`datetime`),'N/A') AS `tat_05`,cast(`activity_log_status_10`.`datetime` as datetime) AS `ws_revise_approved_date`,'00:15:00' AS `target_06`,coalesce(timediff(`activity_log_status_10`.`datetime`,`activity_log_status_09`.`datetime`),'N/A') AS `tat_06`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `original_bill_checked_date`,`his-tpa`.`case`.`original_bill_checked_by` AS `pic_07`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `date_07`,'00:15:00' AS `target_07`,coalesce(timediff(`activity_log_status_15`.`datetime`,`activity_log_status_14`.`datetime`),'N/A') AS `tat_07`,coalesce(if(timediff('00:15:00',timediff(`activity_log_status_15`.`datetime`,`activity_log_status_14`.`datetime`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_07`,cast(`his-tpa`.`case`.`original_bill_verified_date` as datetime) AS `original_bill_verified_date`,'00:15:00' AS `target_08`,coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,if(`his-tpa`.`case`.`original_bill_checked_date` > coalesce(`activity_log_status_15`.`datetime`,'00:00:00'),`his-tpa`.`case`.`original_bill_checked_date`,coalesce(`activity_log_status_15`.`datetime`,'00:00:00'))),'N/A') AS `tat_08`,cast(`his-tpa`.`case`.`payment_date` as datetime) AS `payment_date`,'00:15:00' AS `target_09`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'N/A') AS `tat_09`,addtime(addtime(addtime(addtime(coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'00:00:00')),addtime(coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'00:00:00'))),addtime(addtime(coalesce(timediff(`activity_log_status_09`.`datetime`,`activity_log_status_08`.`datetime`),'00:00:00'),coalesce(timediff(`activity_log_status_10`.`datetime`,`activity_log_status_09`.`datetime`),'00:00:00')),addtime(coalesce(timediff(`activity_log_status_15`.`datetime`,`activity_log_status_14`.`datetime`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,if(`his-tpa`.`case`.`original_bill_checked_date` > coalesce(`activity_log_status_15`.`datetime`,'00:00:00'),`his-tpa`.`case`.`original_bill_checked_date`,coalesce(`activity_log_status_15`.`datetime`,'00:00:00'))),'00:00:00')))),coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'N/A')) AS `total_tat`,`his-tpa`.`case`.`ws_finished_by` AS `pic_10`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `date_10`,'288:00:00' AS `target_10`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,`activity_log_status_09`.`datetime`),'N/A') AS `tat_10`,coalesce(if(timediff('288:00:00',timediff(`his-tpa`.`case`.`payment_date`,`activity_log_status_09`.`datetime`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_10` from (((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `her-tpa`.`activity_log_status_08` on(`his-tpa`.`case`.`id` = `activity_log_status_08`.`case`)) left join `her-tpa`.`activity_log_status_09` on(`his-tpa`.`case`.`id` = `activity_log_status_09`.`case`)) left join `her-tpa`.`activity_log_status_10` on(`his-tpa`.`case`.`id` = `activity_log_status_10`.`case`)) left join `her-tpa`.`activity_log_status_15` on(`his-tpa`.`case`.`id` = `activity_log_status_15`.`case`)) left join `her-tpa`.`activity_log_status_14` on(`his-tpa`.`case`.`id` = `activity_log_status_14`.`case`)) left join `her-tpa`.`activity_log_status_13` on(`his-tpa`.`case`.`id` = `activity_log_status_13`.`case`)) where `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`status` not in (99,98,97,32,31) and year(`his-tpa`.`case`.`create_date`) = 2016 and month(`his-tpa`.`case`.`create_date`) in (2,3) ;

-- ----------------------------
-- View structure for cashless_case_tat_period_02
-- ----------------------------
DROP VIEW IF EXISTS `cashless_case_tat_period_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `cashless_case_tat_period_02` AS select `his-tpa`.`case`.`id` AS `case`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`member`.`member_dob` AS `dob`,`his-tpa`.`member`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,`provider`.`full_name` AS `provider`,cast(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) as datetime) AS `admission_date`,`his-tpa`.`case`.`initial_log_issued_by` AS `pic_01`,cast(`his-tpa`.`case`.`initial_log_issue_date` as datetime) AS `date_01`,'00:30:00' AS `target_01`,coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'N/A') AS `tat_01`,coalesce(if(timediff('00:30:00',timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_01`,cast(`his-tpa`.`case`.`discharge_date` as datetime) AS `discharge_date`,`his-tpa`.`case`.`log_issued_by` AS `pic_02`,cast(`his-tpa`.`case`.`log_issue_date` as datetime) AS `date_02`,'00:60:00' AS `target_02`,coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') AS `tat_02`,coalesce(if(timediff('00:60:00',timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_02`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `ws_process_finished_date`,'00:30:00' AS `target_03`,coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') AS `tat_03`,cast(`his-tpa`.`case`.`ws_approval_date` as datetime) AS `ws_process_approved_date`,`his-tpa`.`case`.`ws_approval_by` AS `pic_04`,cast(`his-tpa`.`case`.`ws_approval_date` as datetime) AS `date_04`,'00:15:00' AS `target_04`,coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'N/A') AS `tat_04`,coalesce(if(timediff('00:15:00',timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_04`,cast(`activity_log_status_09`.`datetime` as datetime) AS `ws_revise_finished_date`,'00:15:00' AS `target_05`,coalesce(timediff(`activity_log_status_09`.`datetime`,`activity_log_status_08`.`datetime`),'N/A') AS `tat_05`,cast(`activity_log_status_10`.`datetime` as datetime) AS `ws_revise_approved_date`,'00:15:00' AS `target_06`,coalesce(timediff(`activity_log_status_10`.`datetime`,`activity_log_status_09`.`datetime`),'N/A') AS `tat_06`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `original_bill_checked_date`,`his-tpa`.`case`.`original_bill_checked_by` AS `pic_07`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `date_07`,'00:15:00' AS `target_07`,coalesce(timediff(`activity_log_status_15`.`datetime`,`activity_log_status_14`.`datetime`),'N/A') AS `tat_07`,coalesce(if(timediff('00:15:00',timediff(`activity_log_status_15`.`datetime`,`activity_log_status_14`.`datetime`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_07`,cast(`his-tpa`.`case`.`original_bill_verified_date` as datetime) AS `original_bill_verified_date`,'00:15:00' AS `target_08`,coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,if(`his-tpa`.`case`.`original_bill_checked_date` > coalesce(`activity_log_status_15`.`datetime`,'00:00:00'),`his-tpa`.`case`.`original_bill_checked_date`,coalesce(`activity_log_status_15`.`datetime`,'00:00:00'))),'N/A') AS `tat_08`,cast(`his-tpa`.`case`.`payment_date` as datetime) AS `payment_date`,'00:15:00' AS `target_09`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'N/A') AS `tat_09`,addtime(addtime(addtime(addtime(coalesce(timediff(`his-tpa`.`case`.`initial_log_issue_date`,`his-tpa`.`case`.`haf_doc_completed_date`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_completed_date`),'00:00:00')),addtime(coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'00:00:00'))),addtime(addtime(coalesce(timediff(`activity_log_status_09`.`datetime`,`activity_log_status_08`.`datetime`),'00:00:00'),coalesce(timediff(`activity_log_status_10`.`datetime`,`activity_log_status_09`.`datetime`),'00:00:00')),addtime(coalesce(timediff(`activity_log_status_15`.`datetime`,`activity_log_status_14`.`datetime`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,if(`his-tpa`.`case`.`original_bill_checked_date` > coalesce(`activity_log_status_15`.`datetime`,'00:00:00'),`his-tpa`.`case`.`original_bill_checked_date`,coalesce(`activity_log_status_15`.`datetime`,'00:00:00'))),'00:00:00')))),coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'N/A')) AS `total_tat`,`his-tpa`.`case`.`ws_finished_by` AS `pic_10`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `date_10`,'288:00:00' AS `target_10`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,`activity_log_status_09`.`datetime`),'N/A') AS `tat_10`,coalesce(if(timediff('288:00:00',timediff(`his-tpa`.`case`.`payment_date`,`activity_log_status_09`.`datetime`)) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_10` from (((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `her-tpa`.`activity_log_status_08` on(`his-tpa`.`case`.`id` = `activity_log_status_08`.`case`)) left join `her-tpa`.`activity_log_status_09` on(`his-tpa`.`case`.`id` = `activity_log_status_09`.`case`)) left join `her-tpa`.`activity_log_status_10` on(`his-tpa`.`case`.`id` = `activity_log_status_10`.`case`)) left join `her-tpa`.`activity_log_status_15` on(`his-tpa`.`case`.`id` = `activity_log_status_15`.`case`)) left join `her-tpa`.`activity_log_status_14` on(`his-tpa`.`case`.`id` = `activity_log_status_14`.`case`)) left join `her-tpa`.`activity_log_status_13` on(`his-tpa`.`case`.`id` = `activity_log_status_13`.`case`)) where `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`status` not in (99,98,97,32,31) and year(`his-tpa`.`case`.`original_bill_upload_date`) = 2016 and month(`his-tpa`.`case`.`original_bill_upload_date`) in (2,3) ;

-- ----------------------------
-- View structure for cashless_issue_initial_log_productivity
-- ----------------------------
DROP VIEW IF EXISTS `cashless_issue_initial_log_productivity`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `cashless_issue_initial_log_productivity` AS select `cashless_case_tat`.`pic_01` AS `pic_01`,cast(`cashless_case_tat`.`date_01` as date) AS `date_01`,`cashless_case_tat`.`achievement_01` AS `achievement_01`,count(`cashless_case_tat`.`case`) AS `case_count` from `her-tpa`.`cashless_case_tat` where `cashless_case_tat`.`pic_01` <> '' group by `cashless_case_tat`.`pic_01`,date_format(`cashless_case_tat`.`date_01`,'%d/%m/%Y'),`cashless_case_tat`.`achievement_01` ;

-- ----------------------------
-- View structure for cashless_issue_log_productivity
-- ----------------------------
DROP VIEW IF EXISTS `cashless_issue_log_productivity`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `cashless_issue_log_productivity` AS select `cashless_case_tat`.`pic_02` AS `pic_02`,cast(`cashless_case_tat`.`date_02` as date) AS `date_02`,`cashless_case_tat`.`achievement_02` AS `achievement_02`,count(`cashless_case_tat`.`case`) AS `case_count` from `her-tpa`.`cashless_case_tat` where `cashless_case_tat`.`pic_02` <> '' group by `cashless_case_tat`.`pic_02`,date_format(`cashless_case_tat`.`date_02`,'%d/%m/%Y'),`cashless_case_tat`.`achievement_02` ;

-- ----------------------------
-- View structure for cashless_original_bill_checked_productivity
-- ----------------------------
DROP VIEW IF EXISTS `cashless_original_bill_checked_productivity`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `cashless_original_bill_checked_productivity` AS select `cashless_case_tat`.`pic_07` AS `pic_07`,cast(`cashless_case_tat`.`date_07` as date) AS `date_07`,`cashless_case_tat`.`achievement_07` AS `achievement_07`,count(`cashless_case_tat`.`case`) AS `case_count` from `her-tpa`.`cashless_case_tat` where `cashless_case_tat`.`pic_07` <> '' group by `cashless_case_tat`.`pic_07`,date_format(`cashless_case_tat`.`date_07`,'%d/%m/%Y'),`cashless_case_tat`.`achievement_07` ;

-- ----------------------------
-- View structure for cashless_original_bill_productivity
-- ----------------------------
DROP VIEW IF EXISTS `cashless_original_bill_productivity`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `cashless_original_bill_productivity` AS select `cashless_case_tat`.`pic_10` AS `pic_10`,cast(`cashless_case_tat`.`date_10` as date) AS `date_10`,`cashless_case_tat`.`achievement_10` AS `achievement_10`,count(`cashless_case_tat`.`case`) AS `case_count` from `her-tpa`.`cashless_case_tat` where `cashless_case_tat`.`pic_10` <> '' group by `cashless_case_tat`.`pic_10`,date_format(`cashless_case_tat`.`date_10`,'%d/%m/%Y'),`cashless_case_tat`.`achievement_10` ;

-- ----------------------------
-- View structure for cashless_ws_approval_productivity
-- ----------------------------
DROP VIEW IF EXISTS `cashless_ws_approval_productivity`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `cashless_ws_approval_productivity` AS select `cashless_case_tat`.`pic_04` AS `pic_04`,cast(`cashless_case_tat`.`date_04` as date) AS `date_04`,`cashless_case_tat`.`achievement_04` AS `achievement_04`,count(`cashless_case_tat`.`case`) AS `case_count` from `her-tpa`.`cashless_case_tat` where `cashless_case_tat`.`pic_04` <> '' group by `cashless_case_tat`.`pic_04`,date_format(`cashless_case_tat`.`date_04`,'%d/%m/%Y'),`cashless_case_tat`.`achievement_04` ;

-- ----------------------------
-- View structure for cek_error
-- ----------------------------
DROP VIEW IF EXISTS `cek_error`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `cek_error` AS select `daily_aiaf`.`claim_no` AS `claim_no`,`daily_aiaf`.`sequence_no` AS `sequence_no`,`daily_aiaf`.`pre_/_post-hosp_claim_no` AS `pre_/_post-hosp_claim_no`,`daily_aiaf`.`id` AS `id`,`daily_aiaf`.`policy_no` AS `policy_no`,`daily_aiaf`.`client_no` AS `client_no`,`daily_aiaf`.`policy_insured` AS `policy_insured`,`daily_aiaf`.`product_code` AS `product_code`,`daily_aiaf`.`branch_code` AS `branch_code`,`daily_aiaf`.`branch_desc` AS `branch_desc`,`daily_aiaf`.`date_of_submit` AS `date_of_submit`,`daily_aiaf`.`claim_type` AS `claim_type`,`daily_aiaf`.`date_of_admission` AS `date_of_admission`,`daily_aiaf`.`date_of_released` AS `date_of_released`,`daily_aiaf`.`name_of_hospital` AS `name_of_hospital`,`daily_aiaf`.`cause_of_claim` AS `cause_of_claim`,`daily_aiaf`.`claim_incurred` AS `claim_incurred`,`daily_aiaf`.`currency` AS `currency`,`daily_aiaf`.`claim_status` AS `claim_status`,`daily_aiaf`.`claim_accepted` AS `claim_accepted`,`daily_aiaf`.`amount_paid` AS `amount_paid`,`daily_aiaf`.`amount_reject` AS `amount_reject`,`daily_aiaf`.`paid_to` AS `paid_to`,`daily_aiaf`.`account_no` AS `account_no`,`daily_aiaf`.`name_of_bank` AS `name_of_bank`,`daily_aiaf`.`bank_branch` AS `bank_branch`,`daily_aiaf`.`city` AS `city`,`daily_aiaf`.`date_of_reject` AS `date_of_reject`,`daily_aiaf`.`date_of_complete` AS `date_of_complete`,`daily_aiaf`.`claim_note` AS `claim_note`,`daily_aiaf`.`remarks` AS `remarks`,`daily_aiaf`.`rcd_policy` AS `rcd_policy`,`daily_aiaf`.`date_of_reinstatement` AS `date_of_reinstatement`,`daily_aiaf`.`old_plan` AS `old_plan`,`daily_aiaf`.`old_plan_rcd` AS `old_plan_rcd`,`daily_aiaf`.`active_plan` AS `active_plan`,`daily_aiaf`.`active_plan_rcd` AS `active_plan_rcd`,`daily_aiaf`.`active_plan_status` AS `active_plan_status`,`daily_aiaf`.`days_approved` AS `days_approved`,`daily_aiaf`.`filter_01` AS `filter_01`,`daily_aiaf`.`case` AS `case` from `daily_aiaf` where `daily_aiaf`.`filter_01` in (cast(current_timestamp() - interval 1 day as date),cast(current_timestamp() - interval 2 day as date),cast(current_timestamp() - interval 3 day as date)) order by `daily_aiaf`.`policy_no` ;

-- ----------------------------
-- View structure for check_manual_case
-- ----------------------------
DROP VIEW IF EXISTS `check_manual_case`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `check_manual_case` AS select `daily_aiaf`.`id` AS `id`,`daily_aiaf`.`filter_01` AS `filter_01`,`daily_aiaf`.`case` AS `case` from `daily_aiaf` where `daily_aiaf`.`id` in (338059,338187,332210,332236) ;

-- ----------------------------
-- View structure for city
-- ----------------------------
DROP VIEW IF EXISTS `city`;
CREATE ALGORITHM=UNDEFINED DEFINER=`it.henro`@`%` SQL SECURITY DEFINER VIEW `city` AS select `his-tpa`.`city`.`country` AS `country`,`his-tpa`.`city`.`province` AS `province`,`his-tpa`.`city`.`id` AS `id`,`his-tpa`.`city`.`name` AS `name`,`his-tpa`.`city`.`id_region` AS `id_region`,`his-tpa`.`city`.`id_province` AS `id_province`,`his-tpa`.`city`.`id_city` AS `id_city` from `his-tpa`.`city` ;

-- ----------------------------
-- View structure for claim_payment_voucher
-- ----------------------------
DROP VIEW IF EXISTS `claim_payment_voucher`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `claim_payment_voucher` AS select `his-tpa`.`case`.`id` AS `case`,concat('TPA','-',convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4)) AS `voucher_no`,`worksheet_header`.`last_edited_by` AS `ws_edited_by`,date_format(`worksheet_header`.`last_edit_date`,'%d/%m/%Y') AS `ws_edit_date`,if(`his-tpa`.`case`.`type` = 1,NULL,`his-tpa`.`case`.`bill_no`) AS `bill_no`,date_format(`his-tpa`.`case`.`bill_issue_date`,'%d/%m/%Y') AS `bill_issue_date`,date_format(`his-tpa`.`case`.`original_bill_upload_date`,'%d/%m/%Y') AS `bill_receive_date`,date_format(`his-tpa`.`case`.`bill_due_date`,'%d/%m/%Y') AS `bill_due_date`,`his-tpa`.`member`.`member_name` AS `patient`,`principle`.`member_name` AS `principle`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,coalesce(`his-tpa`.`company`.`name`,`client`.`full_name`) AS `company`,cast(if(`his-tpa`.`case`.`provider` = 310,concat(`provider`.`full_name`,' ','(',`his-tpa`.`case`.`other_provider`,')'),`provider`.`full_name`) as char(250) charset utf8mb4) AS `provider`,concat(`provider`.`location`,' ',`provider`.`account_no_01`) AS `remarks_provider`,`his-tpa`.`case`.`id` AS `claim_no`,concat(convert(date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') using utf8mb4),' - ',convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4)) AS `treatment_period`,if(`his-tpa`.`case`.`category` = 0,'Outpatient','Inpatient') AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,if(`his-tpa`.`case`.`type` = 2,`bank_02`.`name`,if(`his-tpa`.`case`.`type` = 3,`bank_02`.`name`,`his-tpa`.`member`.`bank`)) AS `bank`,`his-tpa`.`member`.`bank` AS `bank_01`,if(`his-tpa`.`case`.`type` = 2,`provider`.`account_no`,if(`his-tpa`.`case`.`type` = 3,`provider`.`account_no`,`his-tpa`.`member`.`account_no`)) AS `account_no`,`his-tpa`.`member`.`account_no` AS `account_no_01`,if(`his-tpa`.`case`.`type` = 2,`provider`.`location`,if(`his-tpa`.`case`.`type` = 3,`provider`.`location`,`his-tpa`.`member`.`location`)) AS `location`,`his-tpa`.`member`.`location` AS `location_01`,if(`his-tpa`.`case`.`type` = 2,`provider`.`on_behalf_of`,if(`his-tpa`.`case`.`type` = 3,`provider`.`on_behalf_of`,`his-tpa`.`member`.`on_behalf_of`)) AS `on_behalf_of`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_0f_01`,coalesce(`bank_01`.`name`,`his-tpa`.`bank`.`name`) AS `source_of_fund`,if(`his-tpa`.`company`.`account_no` is null,`client`.`account_no`,if(`his-tpa`.`company`.`account_no` = '',`client`.`account_no`,`his-tpa`.`company`.`account_no`)) AS `source_of_fund_01`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`max_day_rate` AS `max_day_rate`,`worksheet_header`.`total_cover` AS `total_cover`,`worksheet_header`.`total_cash_benefit` AS `total_cash_benefit`,`his-tpa`.`users`.`full_name` AS `created_by`,date_format(`his-tpa`.`case`.`edit_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`member`.`policy_holder` AS `policy_holder`,cast(concat(`his-tpa`.`diagnosis`.`code`,'. ',`his-tpa`.`diagnosis`.`name`,if(`his-tpa`.`case`.`other_diagnosis` is null,'',concat('; ',`his-tpa`.`case`.`other_diagnosis`))) as char(255) charset utf8) AS `diagnosis`,cast(`provider`.`abbreviation_name` as char(250) charset utf8mb4) AS `abbreviation_name` from ((((((((((((`his-tpa`.`case` left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`users` on(convert(`his-tpa`.`case`.`paid_by` using utf8) = `his-tpa`.`users`.`username`)) left join `his-tpa`.`principle` on(`his-tpa`.`member`.`member_principle` = `principle`.`id`)) left join `his-tpa`.`bank` on(`client`.`bank` = `his-tpa`.`bank`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`client` = `his-tpa`.`company`.`client` and `his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`bank` `bank_01` on(`his-tpa`.`company`.`bank` = `bank_01`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`diagnosis`.`code` = `his-tpa`.`case`.`diagnosis`)) left join `her-tpa`.`bank_02` on(`provider`.`bank` = `bank_02`.`id`)) ;

-- ----------------------------
-- View structure for claim_payment_voucher_01
-- ----------------------------
DROP VIEW IF EXISTS `claim_payment_voucher_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `claim_payment_voucher_01` AS select `his-tpa`.`case`.`id` AS `case`,concat('TPA','-',convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4)) AS `voucher_no`,`worksheet_header`.`last_edited_by` AS `ws_edited_by`,date_format(`worksheet_header`.`last_edit_date`,'%d/%m/%Y') AS `ws_edit_date`,if(`his-tpa`.`case`.`type` = 1,NULL,`his-tpa`.`case`.`bill_no`) AS `bill_no`,date_format(`his-tpa`.`case`.`bill_issue_date`,'%d/%m/%Y') AS `bill_issue_date`,date_format(`his-tpa`.`case`.`original_bill_upload_date`,'%d/%m/%Y') AS `bill_receive_date`,date_format(`his-tpa`.`case`.`bill_due_date`,'%d/%m/%Y') AS `bill_due_date`,`his-tpa`.`member`.`member_name` AS `patient`,`principle`.`member_name` AS `principle`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,coalesce(`his-tpa`.`company`.`name`,`client`.`full_name`) AS `company`,cast(if(`his-tpa`.`case`.`provider` = 310,concat(`provider`.`full_name`,' ','(',`his-tpa`.`case`.`other_provider`,')'),`provider`.`full_name`) as char(250) charset utf8mb4) AS `provider`,`provider`.`location` AS `remarks_provider`,`his-tpa`.`case`.`id` AS `claim_no`,concat(convert(date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') using utf8mb4),' - ',convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4)) AS `treatment_period`,if(`his-tpa`.`case`.`category` = 0,'Outpatient','Inpatient') AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,if(`his-tpa`.`case`.`type` = 2,`provider`.`bank`,if(`his-tpa`.`case`.`type` = 3,`provider`.`bank`,`his-tpa`.`member`.`bank`)) AS `bank`,`his-tpa`.`member`.`bank` AS `bank_01`,if(`his-tpa`.`case`.`type` = 2,`provider`.`account_no`,if(`his-tpa`.`case`.`type` = 3,`provider`.`account_no`,`his-tpa`.`member`.`account_no`)) AS `account_no`,`his-tpa`.`member`.`account_no` AS `account_no_01`,if(`his-tpa`.`case`.`type` = 2,`provider`.`location`,if(`his-tpa`.`case`.`type` = 3,`provider`.`location`,`his-tpa`.`member`.`location`)) AS `location`,`his-tpa`.`member`.`location` AS `location_01`,if(`his-tpa`.`case`.`type` = 2,`provider`.`on_behalf_of`,if(`his-tpa`.`case`.`type` = 3,`provider`.`on_behalf_of`,`his-tpa`.`member`.`on_behalf_of`)) AS `on_behalf_of`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_0f_01`,coalesce(`bank_01`.`name`,`his-tpa`.`bank`.`name`) AS `source_of_fund`,if(`his-tpa`.`company`.`account_no` is null,`client`.`account_no`,if(`his-tpa`.`company`.`account_no` = '',`client`.`account_no`,`his-tpa`.`company`.`account_no`)) AS `source_of_fund_01`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`country`.`iso-4217` AS `currency`,`his-tpa`.`case`.`currency_rate` * `worksheet_header`.`max_day_rate` AS `max_day_rate`,`his-tpa`.`case`.`currency_rate` * `worksheet_header`.`total_cover` AS `total_cover`,`his-tpa`.`case`.`currency_rate` * `worksheet_header`.`total_cash_benefit` AS `total_cash_benefit`,`his-tpa`.`users`.`full_name` AS `created_by`,date_format(`his-tpa`.`case`.`edit_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`member`.`policy_holder` AS `policy_holder`,cast(concat(`his-tpa`.`diagnosis`.`code`,'. ',`his-tpa`.`diagnosis`.`name`,if(`his-tpa`.`case`.`other_diagnosis` is null,'',concat('; ',`his-tpa`.`case`.`other_diagnosis`))) as char(255) charset utf8) AS `diagnosis`,cast(`provider`.`abbreviation_name` as char(250) charset utf8mb4) AS `abbreviation_name` from (((((((((((`his-tpa`.`case` left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`users` on(convert(`his-tpa`.`case`.`paid_by` using utf8) = `his-tpa`.`users`.`username`)) left join `his-tpa`.`principle` on(`his-tpa`.`member`.`member_principle` = `principle`.`id`)) left join `his-tpa`.`bank` on(`client`.`bank` = `his-tpa`.`bank`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`client` = `his-tpa`.`company`.`client` and `his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`bank` `bank_01` on(`his-tpa`.`company`.`bank` = `bank_01`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`diagnosis`.`code` = `his-tpa`.`case`.`diagnosis`)) ;

-- ----------------------------
-- View structure for client
-- ----------------------------
DROP VIEW IF EXISTS `client`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `client` AS select `intsys`.`client`.`id` AS `id`,`intsys`.`client`.`status` AS `status`,`intsys`.`client`.`full_name` AS `full_name`,`intsys`.`client`.`abbreviation_name` AS `abbreviation_name`,`intsys`.`client`.`service` AS `category`,`intsys`.`client`.`effective_date` AS `effective_date`,`intsys`.`client`.`expiry_date` AS `expiry_date`,`intsys`.`client`.`address` AS `address`,`intsys`.`client`.`country` AS `country`,`intsys`.`client`.`province` AS `province`,`intsys`.`client`.`city` AS `city`,`intsys`.`client`.`postal` AS `postal`,`intsys`.`client`.`phone` AS `phone`,`intsys`.`client`.`fax` AS `fax`,`intsys`.`client`.`email` AS `email`,`intsys`.`client`.`website` AS `website`,`intsys`.`client`.`bank` AS `bank`,`intsys`.`client`.`location` AS `location`,`intsys`.`client`.`account_no` AS `account_no`,`intsys`.`client`.`on_behalf_of` AS `on_behalf_of`,`intsys`.`client`.`benefit_table` AS `benefit_table`,`intsys`.`client`.`waiting_period` AS `waiting_period`,`intsys`.`client`.`conditions_polis` AS `conditions_polis`,`intsys`.`client`.`created_by` AS `created_by`,`intsys`.`client`.`create_date` AS `create_date`,`intsys`.`client`.`edited_by` AS `edited_by`,`intsys`.`client`.`edit_date` AS `edit_date`,`intsys`.`client`.`swipecard` AS `swipecard`,`intsys`.`client`.`condition_polis` AS `condition_polis` from `intsys`.`client` where `intsys`.`client`.`client_flag` = 1 ;

-- ----------------------------
-- View structure for daily_detail_acei
-- ----------------------------
DROP VIEW IF EXISTS `daily_detail_acei`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `daily_detail_acei` AS select if(`his-tpa`.`case`.`type` = 1,cast(`his-tpa`.`case`.`original_bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 2,cast(`his-tpa`.`case`.`bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 3,cast(`his-tpa`.`case`.`bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 4,cast(`his-tpa`.`case`.`original_bill_upload_date` as date),NULL)))) AS `date_filter`,if(`his-tpa`.`case`.`type` = 1,cast(`his-tpa`.`case`.`original_bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 2,cast(`his-tpa`.`case`.`bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 3,cast(`his-tpa`.`case`.`bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 4,cast(`his-tpa`.`case`.`original_bill_upload_date` as date),NULL)))) AS `filter_01`,`his-tpa`.`case`.`id` AS `case`,`his-tpa`.`worksheet`.`detail` AS `detail`,if(right(left(`his-tpa`.`plan`.`name`,6),1) = 'm','A',right(left(`his-tpa`.`plan`.`name`,6),1)) AS `plan`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`plan_detail`.`name` AS `benefit`,sum(`his-tpa`.`worksheet`.`actual`) AS `actual`,sum(`his-tpa`.`worksheet`.`cover`) AS `cover`,sum(`his-tpa`.`worksheet`.`excess`) AS `excess`,if(`his-tpa`.`worksheet`.`remarks` = '','Null',`his-tpa`.`worksheet`.`remarks`) AS `remarks` from (((`his-tpa`.`case` join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case`.`client` = 16 and if(`his-tpa`.`case`.`type` = 1,`his-tpa`.`case`.`original_bill_upload_date`,if(`his-tpa`.`case`.`type` = 2,`his-tpa`.`case`.`bill_upload_date`,if(`his-tpa`.`case`.`type` = 3,`his-tpa`.`case`.`bill_upload_date`,if(`his-tpa`.`case`.`type` = 4,`his-tpa`.`case`.`original_bill_upload_date`,NULL)))) is not null group by `his-tpa`.`case`.`id`,`his-tpa`.`worksheet`.`detail` ;

-- ----------------------------
-- View structure for daily_header_acei
-- ----------------------------
DROP VIEW IF EXISTS `daily_header_acei`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `daily_header_acei` AS select if(`his-tpa`.`case`.`type` = 1,cast(`his-tpa`.`case`.`original_bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 2,cast(`his-tpa`.`case`.`bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 3,cast(`his-tpa`.`case`.`bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 4,cast(`his-tpa`.`case`.`original_bill_upload_date` as date),NULL)))) AS `date_filter`,if(`his-tpa`.`case`.`type` = 1,cast(`his-tpa`.`case`.`original_bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 2,cast(`his-tpa`.`case`.`bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 3,cast(`his-tpa`.`case`.`bill_upload_date` as date),if(`his-tpa`.`case`.`type` = 4,cast(`his-tpa`.`case`.`original_bill_upload_date` as date),NULL)))) AS `filter_01`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`member`.`member_name` AS `patient`,if(right(left(`his-tpa`.`plan`.`name`,6),1) = 'm','IHLO-C',if(`his-tpa`.`case`.`program` = 63,'ICMED-C',if(`his-tpa`.`case`.`type` = 2,'IHSR-C','IHSR-R'))) AS `type`,`his-tpa`.`case`.`id` AS `case`,`provider`.`full_name` AS `provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') AS `discharge_date`,to_days(`his-tpa`.`case`.`discharge_date`) - to_days(`his-tpa`.`case`.`admission_date`) AS `days_of_treatment`,if(right(left(`his-tpa`.`plan`.`name`,6),1) = 'm','A',right(left(`his-tpa`.`plan`.`name`,6),1)) AS `plan`,`worksheet_header`.`total_actual` AS `total_actual`,`worksheet_header`.`total_cover` AS `total_cover`,`worksheet_header`.`total_excess` AS `total_excess`,concat(`his-tpa`.`case`.`diagnosis`,', ',`his-tpa`.`diagnosis`.`name`) AS `diagnosis`,'N.A. (Not Applicable)' AS `tpa_type`,`his-tpa`.`branch`.`name` AS `branch` from ((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) where `his-tpa`.`case`.`client` = 16 and if(`his-tpa`.`case`.`type` = 1,`his-tpa`.`case`.`original_bill_upload_date`,if(`his-tpa`.`case`.`type` = 2,`his-tpa`.`case`.`bill_upload_date`,if(`his-tpa`.`case`.`type` = 3,`his-tpa`.`case`.`bill_upload_date`,if(`his-tpa`.`case`.`type` = 4,`his-tpa`.`case`.`original_bill_upload_date`,NULL)))) is not null ;

-- ----------------------------
-- View structure for daily_log_detail
-- ----------------------------
DROP VIEW IF EXISTS `daily_log_detail`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `daily_log_detail` AS select if(`client`.`category` = 1,'ASO',if(`client`.`category` = 2,'TPA','ERROR')) AS `category`,cast(`her-tpa`.`case_log`.`log_issue_date` as date) AS `log_issue_date`,if(`her-tpa`.`case_log`.`provider` = 310,convert(`her-tpa`.`case_log`.`other_provider` using utf8),`provider`.`full_name`) AS `provider`,`her-tpa`.`case_log`.`id` AS `case`,`her-tpa`.`case_log`.`claim_no` AS `log_no`,`client`.`full_name` AS `client`,`his-tpa`.`member`.`member_name` AS `patient`,cast(`her-tpa`.`case_log`.`admission_date` as date) AS `admission_date`,cast(`her-tpa`.`case_log`.`discharge_date` as date) AS `discharge_date`,`his-tpa`.`country`.`iso-4217` AS `currency`,sum(`her-tpa`.`worksheet_log`.`actual`) AS `actual`,sum(`her-tpa`.`worksheet_log`.`cover`) AS `cover`,sum(`her-tpa`.`worksheet_log`.`excess`) AS `excess` from (((((`her-tpa`.`case_log` join `her-tpa`.`worksheet_log` on(`her-tpa`.`case_log`.`id` = `her-tpa`.`worksheet_log`.`case`)) join `his-tpa`.`provider` on(`her-tpa`.`case_log`.`provider` = `provider`.`id`)) join `his-tpa`.`client` on(`her-tpa`.`case_log`.`client` = `client`.`id`)) join `his-tpa`.`member` on(`her-tpa`.`case_log`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`country` on(`her-tpa`.`case_log`.`currency_01` = `his-tpa`.`country`.`id`)) group by `her-tpa`.`case_log`.`id` union all select 'IMA' AS `category`,cast(`her-tpa`.`gop_medical`.`edit_date` as date) AS `log_issue_date`,if(`her-tpa`.`gop_medical`.`provider` = 310,`her-tpa`.`gop_medical`.`other_provider`,`ima`.`provider`.`full_name`) AS `provider`,`her-tpa`.`gop_medical`.`case` AS `case`,`her-tpa`.`gop_medical`.`gop_no` AS `log_no`,`ima`.`client`.`full_name` AS `client`,`ima`.`case_medical`.`patient` AS `patient`,cast(`her-tpa`.`gop_medical`.`admission_date` as date) AS `admission_date`,cast(`her-tpa`.`gop_medical`.`discharge_date` as date) AS `discharge_date`,`ima`.`country`.`iso-4217` AS `currency`,`her-tpa`.`gop_medical`.`actual` AS `actual`,`her-tpa`.`gop_medical`.`cover` AS `cover`,`her-tpa`.`gop_medical`.`excess` AS `excess` from ((((`her-tpa`.`gop_medical` join `ima`.`provider` on(`her-tpa`.`gop_medical`.`provider` = `ima`.`provider`.`id`)) join `ima`.`case_medical` on(`her-tpa`.`gop_medical`.`case` = `ima`.`case_medical`.`id`)) join `ima`.`client` on(`ima`.`case_medical`.`client` = `ima`.`client`.`id`)) join `ima`.`country` on(`her-tpa`.`gop_medical`.`currency` = `ima`.`country`.`id`)) union all select 'IMA' AS `category`,cast(`her-tpa`.`gop_travel`.`edit_date` as date) AS `log_issue_date`,if(`her-tpa`.`gop_travel`.`provider` = 310,`her-tpa`.`gop_travel`.`other_provider`,`ima`.`provider`.`full_name`) AS `provider`,`her-tpa`.`gop_travel`.`case` AS `case`,`her-tpa`.`gop_travel`.`gop_no` AS `log_no`,`ima`.`client`.`full_name` AS `client`,`ima`.`case_travel`.`insured` AS `patient`,cast(`her-tpa`.`gop_travel`.`admission_date` as date) AS `admission_date`,cast(`her-tpa`.`gop_travel`.`discharge_date` as date) AS `discharge_date`,`ima`.`country`.`iso-4217` AS `currency`,`her-tpa`.`gop_travel`.`actual` AS `actual`,`her-tpa`.`gop_travel`.`cover` AS `cover`,`her-tpa`.`gop_travel`.`excess` AS `excess` from ((((`her-tpa`.`gop_travel` join `ima`.`provider` on(`her-tpa`.`gop_travel`.`provider` = `ima`.`provider`.`id`)) join `ima`.`case_travel` on(`her-tpa`.`gop_travel`.`case` = `ima`.`case_travel`.`id`)) join `ima`.`client` on(`ima`.`case_travel`.`client` = `ima`.`client`.`id`)) join `ima`.`country` on(`her-tpa`.`gop_travel`.`currency` = `ima`.`country`.`id`)) ;

-- ----------------------------
-- View structure for daily_log_summary
-- ----------------------------
DROP VIEW IF EXISTS `daily_log_summary`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `daily_log_summary` AS select `daily_log_detail`.`log_issue_date` AS `log_issue_date`,`daily_log_detail`.`category` AS `category`,`daily_log_detail`.`client` AS `client`,count(`daily_log_detail`.`log_no`) AS `log`,`daily_log_detail`.`currency` AS `currency`,`daily_log_detail`.`cover` AS `cover` from `her-tpa`.`daily_log_detail` group by `daily_log_detail`.`log_issue_date`,`daily_log_detail`.`category`,`daily_log_detail`.`client`,`daily_log_detail`.`currency` ;

-- ----------------------------
-- View structure for decline_claim
-- ----------------------------
DROP VIEW IF EXISTS `decline_claim`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `decline_claim` AS select coalesce(`his-tpa`.`case`.`create_date_01`,`his-tpa`.`case`.`create_date`) AS `RECEIVED_DATE`,coalesce(`his-tpa`.`case`.`case_closed_date`,`his-tpa`.`case`.`edit_date`) AS `DECLINE_DATE`,`client`.`id` AS `CLIENT_ID`,`client`.`full_name` AS `CLIENT_NAME`,`his-tpa`.`case`.`policy_no` AS `POLICY_NO`,`his-tpa`.`case`.`policy_effective_date` AS `POLICY_EFFECTIVE_DATE`,`his-tpa`.`case`.`policy_expiry_date` AS `POLICY_EXPIRY_DATE`,case `his-tpa`.`case`.`policy_status` when 0 then 'Disable' when 1 then 'Enable' else 'N/A' end AS `POLICY_STATUS`,`his-tpa`.`case`.`member_id` AS `MEMBER_ID`,`his-tpa`.`case`.`member_card` AS `MEMBER_CARD`,`his-tpa`.`program`.`name` AS `PROGRAM`,`his-tpa`.`plan`.`name` AS `PLAN`,`his-tpa`.`company`.`name` AS `COMPANY_NAME`,`his-tpa`.`case`.`policy_holder` AS `PRINCIPLE`,`his-tpa`.`member`.`member_name` AS `PATIENT`,'Principle' AS `RELATION`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `GENDER`,`his-tpa`.`case`.`id` AS `CASE_ID`,`his-tpa`.`case`.`admission_date` AS `ADMISSION_DATE`,cast(`his-tpa`.`case`.`discharge_date` as date) AS `DISCHARGE_DATE`,`his-tpa`.`diagnosis`.`code` AS `DIAGNOSIS_CODE`,`his-tpa`.`diagnosis`.`name` AS `DIAGNOSIS_DESC`,`provider`.`full_name` AS `HOSPITAL`,`his-tpa`.`case`.`other_provider` AS `OTHER_HOSPITAL`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `CATEGORY`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `TYPE`,`his-tpa`.`country`.`name` AS `CURRENCY_01`,`his-tpa`.`country`.`name` AS `CURRENCY_02`,(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `actual`,(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `cover`,(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `excess`,cast(`his-tpa`.`case`.`original_bill_upload_date` as date) AS `DOC_RECEIVE_DATE`,cast(`his-tpa`.`case`.`log_issue_date` as date) AS `PROCESS_DATE`,`his-tpa`.`country`.`name` AS `BRANCH`,`his-tpa`.`case`.`created_by` AS `CREATED_BY`,`his-tpa`.`case_status`.`name` AS `CASE_STATUS`,`his-tpa`.`nonlog_reason`.`name` AS `REJECT_REASON`,`his-tpa`.`case`.`nonlog_remarks` AS `REMAKS`,`his-tpa`.`case`.`bill_no` AS `REF` from (((((((((((((((`his-tpa`.`case` left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) left join `his-tpa`.`nonlog_reason` on(`his-tpa`.`case`.`nonlog_reason` = `his-tpa`.`nonlog_reason`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` in (31,32) and `his-tpa`.`case`.`status` not in (98,99) and `his-tpa`.`member`.`member_name`  not like '%xx%' group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for form_inpatient
-- ----------------------------
DROP VIEW IF EXISTS `form_inpatient`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `form_inpatient` AS select `his-tpa`.`admission`.`id` AS `id`,if(`his-tpa`.`admission`.`source` = 0,'Healthcare System',if(`his-tpa`.`admission`.`source` = 1,'MedisClick - Admission',if(`his-tpa`.`admission`.`source` = 2,'MedisClick - Pre Admission',if(`his-tpa`.`admission`.`source` = 3,'eCentrix',if(`his-tpa`.`admission`.`source` = 4,'eReimbursement',if(`his-tpa`.`admission`.`source` = 5,'Hospital Portal',if(`his-tpa`.`admission`.`source` = 6,'EDC',if(`his-tpa`.`admission`.`source` = 7,'QR Code','')))))))) AS `case_source`,`his-tpa`.`category`.`name` AS `category`,`patient`.`member_name` AS `patient_name`,`principle`.`member_name` AS `member_principle`,`his-tpa`.`admission`.`dob` AS `dob`,`client`.`full_name` AS `client`,`his-tpa`.`company`.`name` AS `company_name`,`his-tpa`.`admission`.`policy_no` AS `policy_no`,`his-tpa`.`admission`.`admission_date` AS `admission_date` from ((((((`his-tpa`.`admission` left join `his-tpa`.`patient` on(`patient`.`id` = `his-tpa`.`admission`.`patient`)) left join `his-tpa`.`client` on(`client`.`id` = `his-tpa`.`admission`.`client`)) left join `his-tpa`.`company` on(`his-tpa`.`company`.`id` = `his-tpa`.`admission`.`company`)) left join `his-tpa`.`category` on(`his-tpa`.`category`.`id` = `his-tpa`.`admission`.`category`)) left join `his-tpa`.`member` on(`his-tpa`.`member`.`id` = `his-tpa`.`admission`.`member_id`)) left join `his-tpa`.`principle` on(`principle`.`id` = `his-tpa`.`admission`.`principle`)) group by `his-tpa`.`admission`.`id` ;

-- ----------------------------
-- View structure for guarantee_cashless_inpatient
-- ----------------------------
DROP VIEW IF EXISTS `guarantee_cashless_inpatient`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `guarantee_cashless_inpatient` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case`.`create_date_01` AS `DocReceieveDate`,`his-tpa`.`case`.`status` AS `status_01`,`his-tpa`.`case_status`.`name` AS `status`,case `his-tpa`.`case`.`source` when 1 then 'Medisclick' when 2 then 'Medisclick' when 3 then 'eCentrix' when 4 then 'eReimbursement' when 5 then 'Hospital Portal' else 'Healthcare' end AS `Source`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `category`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `type`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`member`.`member_name` AS `member_name`,`his-tpa`.`case`.`dob` AS `dob`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `gender`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,case `his-tpa`.`case`.`relation` when 1 then 'Principle' when 2 then 'Spouse' when 3 then 'Child' when 4 then 'Dependant' else 'N/A' end AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`department`.`name` AS `DEPARTMENT`,case `his-tpa`.`case`.`policy_status` when 1 then 'Enable' when 0 then 'Disable' else 'N/A' end AS `policy_status`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_holder` AS `policy_holder`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`member`.`plan_external` AS `plan_external`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`rider`.`name` AS `rider`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,case `provider`.`full_name` when 'NON PARTICIPATING HOSPITAL' then concat(`his-tpa`.`case`.`other_provider`,' (Non Panel)') else `provider`.`full_name` end AS `provider`,`provider`.`city` AS `city`,`his-tpa`.`country`.`name` AS `counttr`,case `his-tpa`.`country`.`name` when 'Indonesia' then 'Domestic' else 'Overseas' end AS `ProviderDomicile`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,case `his-tpa`.`case`.`upload_haf_doc_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `upload_haf_doc_finished`,`his-tpa`.`case`.`upload_haf_doc_finished_by` AS `upload_haf_doc_finished_by`,`his-tpa`.`case`.`upload_haf_doc_finished_date` AS `upload_haf_doc_finished_date`,case `his-tpa`.`case`.`haf_doc_completed` when 1 then 'Pending' when 2 then 'Not Complete' when 3 then 'Complete' else 'N/A' end AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,case `his-tpa`.`case`.`issue_initial_log` when 1 then 'Pending' when 2 then 'LOG' when 3 then 'Non-LOG' else 'N/A' end AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_remarks` AS `initial_log_remarks`,case `his-tpa`.`case`.`initial_log_approval` when 0 then 'Disagree' when 1 then 'Agree' else 'N/A' end AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_plan` AS `discharge_plan`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,concat_ws(',',`his-tpa`.`diagnosis`.`code`,`his-tpa`.`diagnosis`.`name`) AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`exclusion` AS `exclusion`,case `his-tpa`.`case`.`bill_received` when 0 then 'Not Received' when 1 then 'Received' else 'N/A' end AS `bill_received`,`his-tpa`.`case`.`bill_received_by` AS `bill_received_by`,`his-tpa`.`case`.`bill_received_date` AS `bill_received_date`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`upload_bill_finished_by` AS `upload_bill_finished_by`,`his-tpa`.`case`.`upload_bill_finished_date` AS `upload_bill_finished_date`,case `his-tpa`.`case`.`upload_bill_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `upload_bill_finished`,case `his-tpa`.`case`.`bill_completed` when 1 then 'Pending' when 2 then 'Not Complete' when 3 then 'Complete' else 'N/A' end AS `bill_completed`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,`his-tpa`.`case`.`bill_completed_by_01` AS `BillCompleteBy_M`,`his-tpa`.`case`.`bill_completed_date_01` AS `BillCompleteDate_M`,`his-tpa`.`case`.`ws_type` AS `ws_type`,case `his-tpa`.`case`.`ws_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,case `his-tpa`.`case`.`ws_approval` when 0 then 'Pending' when 1 then 'Not Approve' when 2 then 'Approve' else 'N/A' end AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,case `his-tpa`.`case`.`issue_log` when 1 then 'Pending' when 2 then 'LOG' when 3 then 'Non-LOG' else 'N/A' end AS `issue_log`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`log_issued_by_01` AS `LogIssued_M`,`his-tpa`.`case`.`log_issue_date_01` AS `LogIssueDate_M`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_remarks` AS `log_remarks`,case `his-tpa`.`case`.`log_approval` when 0 then 'Disagree' when 1 then 'Agree' else 'N/A' end AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`reject_reason` AS `reject_reason`,`his-tpa`.`case`.`reject_remarks` AS `reject_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,case `his-tpa`.`case`.`original_bill_checked` when 1 then 'Pending' when 2 then 'Original Bill Not Complete' when 3 then 'WS Revision' when 4 then 'OK' when 5 then 'Close Case' else 'N/A' end AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,case `his-tpa`.`case`.`close_case_option` when 1 then 'By Document Send Back' when 2 then 'By Payment' else 'N/A' end AS `close_case_option`,case `his-tpa`.`case`.`original_bill_verified` when 1 then 'Pending' when 2 then 'Original Bill Not Complete' when 3 then 'WS Revision' when 4 then 'OK' when 5 then 'Close Case' else 'N/A' end AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,case `his-tpa`.`case`.`doc_send_back_to_client_required` when 1 then 'Required' when 0 then 'Not Required' else 'N/A' end AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,`his-tpa`.`case`.`edited_by` AS `edited_by`,`his-tpa`.`case`.`edit_date` AS `edit_date`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`actual`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`actual`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `actual`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`cover`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`cover`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `cover`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`excess`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`excess`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `excess`,`his-tpa`.`case`.`bill_issue_date` AS `BillReceieveDate`,if(`his-tpa`.`case`.`status` = 1 or `his-tpa`.`case`.`status` = 2,9999999 * -1,timestampdiff(HOUR,`his-tpa`.`case`.`create_date`,`his-tpa`.`case`.`haf_doc_completed_date`)) AS `Document_InitialLOG_Hours`,if(`his-tpa`.`case`.`status` = 3,9999999 * -1,timestampdiff(MINUTE,`his-tpa`.`case`.`haf_doc_completed_date`,`his-tpa`.`case`.`initial_log_issue_date`)) AS `Initial_LOG_Minutes`,'' AS `Provider_Discharge_Hours`,if(`his-tpa`.`case`.`status` = 4 or `his-tpa`.`case`.`status` = 5,9999999 * -1,timestampdiff(HOUR,`his-tpa`.`case`.`discharge_date`,`his-tpa`.`case`.`bill_completed_date`)) AS `Document_FinalLOG_Hours`,if(`his-tpa`.`case`.`status` = 6 or `his-tpa`.`case`.`status` = 7 or `his-tpa`.`case`.`status` = 8 or `his-tpa`.`case`.`status` = 9 or `his-tpa`.`case`.`status` = 10,9999999 * -1,timestampdiff(HOUR,`his-tpa`.`case`.`bill_completed_date`,`his-tpa`.`case`.`log_issue_date`)) AS `Final_LOG_Hours`,if(`his-tpa`.`case`.`status` = 11,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_issue_date`)) AS `Document_OB_Hosp_Days`,if(`his-tpa`.`case`.`status` = 11,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`bill_issue_date`,`his-tpa`.`case`.`original_bill_upload_date`)) AS `Document_OB_Days`,if(`his-tpa`.`case`.`status` = 12 or `his-tpa`.`case`.`status` = 13 or `his-tpa`.`case`.`status` = 14,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`original_bill_checked_date`)) AS `Document_OBCheck_Days`,if(`his-tpa`.`case`.`status` = 15,9999999 * -1,if(`his-tpa`.`case`.`close_case_option` = 1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_checked_date`,`his-tpa`.`case`.`original_bill_verified_date`),timestampdiff(DAY,`his-tpa`.`case`.`doc_send_back_to_client_date`,`his-tpa`.`case`.`original_bill_verified_date`))) AS `Document_OBVerified_Days`,if(`his-tpa`.`case`.`status` = 16,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_verified_date`,`his-tpa`.`case`.`payment_date`)) AS `Document_Payment_Days`,if(`his-tpa`.`case`.`status` = 17,9999999 * -1,if(`his-tpa`.`case`.`close_case_option` = 1,timestampdiff(DAY,`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`doc_send_back_to_client_date`),timestampdiff(DAY,`his-tpa`.`case`.`original_bill_checked_date`,`his-tpa`.`case`.`doc_send_back_to_client_date`))) AS `Document_Sendback_Days`,if(`his-tpa`.`case`.`status` = 18,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date`)) AS `Document_ClientReceive_Days` from ((((((((((((((`his-tpa`.`case` join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`department` on(`his-tpa`.`member`.`department` = `his-tpa`.`department`.`id`)) left join `his-tpa`.`position` on(`his-tpa`.`member`.`position` = `his-tpa`.`position`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` not in (95,96,97,98,99,31,32,33,34,86,87,88,89) and `his-tpa`.`case`.`category` = 1 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case_status`.`name`  not like 'Provider%' group by `his-tpa`.`case`.`id` order by NULL ;

-- ----------------------------
-- View structure for initial_log
-- ----------------------------
DROP VIEW IF EXISTS `initial_log`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `initial_log` AS select `provider`.`full_name` AS `provider`,if(`provider`.`type` = '1','rumah sakit',if(`provider`.`type` = '2','klinik','ERROR')) AS `provider_type`,concat(`provider`.`fax`,' / ',`provider`.`email`) AS `fax_email`,if(`his-tpa`.`case`.`category` = 0,'Admin Rawat Jalan',if(`his-tpa`.`case`.`category` = 0,'Admin Rawat Inap','Admin Rumah Sakit')) AS `recipient`,date_format(`his-tpa`.`case`.`initial_log_issue_date`,'%d/%m/%Y') AS `issue_date`,`his-tpa`.`case`.`id` AS `case`,`his-tpa`.`case`.`initial_claim_no` AS `claim_no`,`his-tpa`.`plan`.`name` AS `plan`,'Surat Jaminan Awal' AS `log_type`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`case`.`policy_no` AS `policy_no`,concat(convert(date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4)) AS `policy_period`,`client`.`full_name` AS `client`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 0,'rawat jalan',if(`his-tpa`.`case`.`category` = 1,'rawat inap','ERROR')) AS `admission_type`,cast(`his-tpa`.`case`.`initial_diagnosis` as char(255) charset utf8) AS `initial_diagnosis`,`his-tpa`.`country`.`iso-4217` AS `currency`,`his-tpa`.`users`.`full_name` AS `issued_by`,`his-tpa`.`users`.`signature` AS `signature`,`his-tpa`.`case`.`id` AS `barcode`,65 AS `height` from ((((((`his-tpa`.`case` join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`users` on(convert(`his-tpa`.`case`.`initial_log_issued_by` using utf8) = `his-tpa`.`users`.`username`)) where `his-tpa`.`case`.`status` not in (99,98) and `his-tpa`.`case`.`issue_initial_log` = 2 group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for internal_correction_01
-- ----------------------------
DROP VIEW IF EXISTS `internal_correction_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `internal_correction_01` AS select if(`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` = 28 and `her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` = 0,'Payment Cover is Null','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) where `her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` = 28 and `her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` = 0 and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp_01`.`STATUS` <> `case_all_01`.`status`,'Different Case Status','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) where `her-tpa`.`daily_aiaf_temp_01`.`STATUS` <> `case_all_01`.`status` and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` is null,'Diagnose is NULL','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) where `her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` is null and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` = 31 and `her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` <> 0,'Amount in Cover is not null/ not empty','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) where `her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` = 31 and `her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` <> 0 and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` is null or `her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` = '' or `her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` like '%ERR%','Product Code is Null/ is Empty/ err','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) where `case_all_01`.`type` = 1 and (`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` is null or `her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` = '' or `her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` like '%ERR%') union all select if(`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` is null or `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` = '' or `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` like '%ERR%','Branch Code is Null/ is Empty/ err','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) where `case_all_01`.`type` = 1 and (`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` is null or `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` = '' or `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` like '%ERR%') union all select if(`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` <> `branch`.`code`,'Different Branch Code','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from ((`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) join `her-tpa`.`branch` on(`branch`.`id` = `case_all_01`.`branch`)) where `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` <> `branch`.`code` and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` is null or `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` = '' or `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` like '%ERR%','Branch Desc is Null/ is Empty/ err','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from ((`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) join `her-tpa`.`branch` on(`branch`.`id` = `case_all_01`.`branch`)) where `case_all_01`.`type` = 1 and (`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` is null or `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` = '' or `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` like '%ERR%') union all select if(`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` <> `branch`.`name`,'Different Branch Desc','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from ((`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) join `her-tpa`.`branch` on(`branch`.`id` = `case_all_01`.`branch`)) where `her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` <> `branch`.`name` and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` = 28 and (`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` is null or `her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` is null or `her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` is null or `her-tpa`.`daily_aiaf_temp_01`.`CITY` is null),'Claim Accept but Payment Bank is Null','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) where `her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` = 28 and `case_all_01`.`type` = 1 and (`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` is null or `her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` is null or `her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` is null or `her-tpa`.`daily_aiaf_temp_01`.`CITY` is null) union all select if(`case_all_01`.`provider` = 310 and (`case_all_01`.`other_provider` is null or `case_all_01`.`other_provider_city` is null or `case_all_01`.`other_provider_country` is null),'Name of Hospital, non participating hospital err','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) where `case_all_01`.`provider` = 310 and `case_all_01`.`type` = 1 and (`case_all_01`.`other_provider` is null or `case_all_01`.`other_provider_city` is null or `case_all_01`.`other_provider_country` is null) union all select if(`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` = 31 and (`case_all_01`.`reject_reason` is null or `case_all_01`.`reject_remarks` is null),'Claim Reject, Reject Reason or Reject Remarks is NULL','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp_01`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp_01`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp_01`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp_01`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp_01`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp_01`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp_01`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp_01`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp_01`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp_01`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp_01`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp_01`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp_01`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp_01`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp_01`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp_01`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp_01`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp_01`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp_01`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp_01`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp_01` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp_01`.`id`)) where `her-tpa`.`daily_aiaf_temp_01`.`CLAIM_NOTE` = 31 and `case_all_01`.`type` = 1 and (`case_all_01`.`reject_reason` is null or `case_all_01`.`reject_remarks` is null) ;

-- ----------------------------
-- View structure for internal_correction_02
-- ----------------------------
DROP VIEW IF EXISTS `internal_correction_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `internal_correction_02` AS select if(`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` = 28 and `her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` = 0,'Payment Cover is Null','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) where `her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` = 28 and `her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` = 0 and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp`.`STATUS` <> `case_all_01`.`status`,'Different Case Status','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) where `her-tpa`.`daily_aiaf_temp`.`STATUS` <> `case_all_01`.`status` and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` is null,'Diagnose is NULL','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) where `her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` is null and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` = 31 and `her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` <> 0,'Amount in Cover is not null/ not empty','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) where `her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` = 31 and `her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` <> 0 and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` is null or `her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` = '' or `her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` like '%ERR%','Product Code is Null/ is Empty/ err','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) where `case_all_01`.`type` = 1 and (`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` is null or `her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` = '' or `her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` like '%ERR%') union all select if(`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` is null or `her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` = '' or `her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` like '%ERR%','Branch Code is Null/ is Empty/ err','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) where `case_all_01`.`type` = 1 and (`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` is null or `her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` = '' or `her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` like '%ERR%') union all select if(`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` <> `branch`.`code`,'Different Branch Code','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from ((`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) join `her-tpa`.`branch` on(`branch`.`id` = `case_all_01`.`branch`)) where `her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` <> `branch`.`code` and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` is null or `her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` = '' or `her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` like '%ERR%','Branch Desc is Null/ is Empty/ err','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from ((`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) join `her-tpa`.`branch` on(`branch`.`id` = `case_all_01`.`branch`)) where `case_all_01`.`type` = 1 and (`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` is null or `her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` = '' or `her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` like '%ERR%') union all select if(`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` <> `branch`.`name`,'Different Branch Desc','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from ((`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) join `her-tpa`.`branch` on(`branch`.`id` = `case_all_01`.`branch`)) where `her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` <> `branch`.`name` and `case_all_01`.`type` = 1 union all select if(`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` = 28 and (`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` is null or `her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` is null or `her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` is null or `her-tpa`.`daily_aiaf_temp`.`CITY` is null),'Claim Accept but Payment Bank is Null','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) where `her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` = 28 and `case_all_01`.`type` = 1 and (`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` is null or `her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` is null or `her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` is null or `her-tpa`.`daily_aiaf_temp`.`CITY` is null) union all select if(`case_all_01`.`provider` = 310 and (`case_all_01`.`other_provider` is null or `case_all_01`.`other_provider_city` is null or `case_all_01`.`other_provider_country` is null),'Name of Hospital, non participating hospital err','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) where `case_all_01`.`provider` = 310 and `case_all_01`.`type` = 1 and (`case_all_01`.`other_provider` is null or `case_all_01`.`other_provider_city` is null or `case_all_01`.`other_provider_country` is null) union all select if(`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` = 31 and (`case_all_01`.`reject_reason` is null or `case_all_01`.`reject_remarks` is null),'Claim Reject, Reject Reason or Reject Remarks is NULL','Normal') AS `CORRECTION`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NO` AS `CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`SEQUENCE_NO` AS `SEQUENCE_NO`,`her-tpa`.`daily_aiaf_temp`.`PRE_/_POST-HOSP_CLAIM_NO` AS `PRE_/_POST-HOSP_CLAIM_NO`,`her-tpa`.`daily_aiaf_temp`.`id` AS `ID`,`her-tpa`.`daily_aiaf_temp`.`POLICY_NO` AS `POLICY_NO`,`her-tpa`.`daily_aiaf_temp`.`CLIENT_NO` AS `CLIENT_NO`,`her-tpa`.`daily_aiaf_temp`.`POLICY_INSURED` AS `POLICY_INSURED`,`her-tpa`.`daily_aiaf_temp`.`PRODUCT_CODE` AS `PRODUCT_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_CODE` AS `BRANCH_CODE`,`her-tpa`.`daily_aiaf_temp`.`BRANCH_DESC` AS `BRANCH_DESC`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_SUBMIT` AS `DATE_OF_SUBMIT`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_TYPE` AS `CLAIM_TYPE`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_ADMISSION` AS `DATE_OF_ADMISSION`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_RELEASED` AS `DATE_OF_RELEASED`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_HOSPITAL` AS `NAME_OF_HOSPITAL`,`her-tpa`.`daily_aiaf_temp`.`CAUSE_OF_CLAIM` AS `CAUSE_OF_CLAIM`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_INCURRED` AS `CLAIM_INCURRED`,`her-tpa`.`daily_aiaf_temp`.`CURRENCY` AS `CURRENCY`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_STATUS` AS `CLAIM_STATUS`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_ACCEPTED` AS `CLAIM_ACCEPTED`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_PAID` AS `AMOUNT_PAID`,`her-tpa`.`daily_aiaf_temp`.`AMOUNT_REJECT` AS `AMOUNT_REJECT`,`her-tpa`.`daily_aiaf_temp`.`PAID_TO` AS `PAID_TO`,`her-tpa`.`daily_aiaf_temp`.`ACCOUNT_NO` AS `ACCOUNT_NO`,`her-tpa`.`daily_aiaf_temp`.`NAME_OF_BANK` AS `NAME_OF_BANK`,`her-tpa`.`daily_aiaf_temp`.`BANK_BRANCH` AS `BANK_BRANCH`,`her-tpa`.`daily_aiaf_temp`.`CITY` AS `CITY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REJECT` AS `DATE_OF_REJECT`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_COMPLETE` AS `DATE_OF_COMPLETE`,`her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` AS `CLAIM_NOTE`,`her-tpa`.`daily_aiaf_temp`.`REMARKS` AS `REMARKS`,`her-tpa`.`daily_aiaf_temp`.`RCD_POLICY` AS `RCD_POLICY`,`her-tpa`.`daily_aiaf_temp`.`DATE_OF_REINSTATEMENT` AS `DATE_OF_REINSTATEMENT`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN` AS `OLD_PLAN`,`her-tpa`.`daily_aiaf_temp`.`OLD_PLAN_RCD` AS `OLD_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN` AS `ACTIVE_PLAN`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_RCD` AS `ACTIVE_PLAN_RCD`,`her-tpa`.`daily_aiaf_temp`.`ACTIVE_PLAN_STATUS` AS `ACTIVE_PLAN_STATUS`,`her-tpa`.`daily_aiaf_temp`.`DAYS_APPROVED` AS `DAYS_APPROVED`,`her-tpa`.`daily_aiaf_temp`.`FILTER_01` AS `FILTER_01`,`her-tpa`.`daily_aiaf_temp`.`CASE` AS `CASE`,`her-tpa`.`daily_aiaf_temp`.`STATUS` AS `STATUS` from (`her-tpa`.`daily_aiaf_temp` join `her-tpa`.`case_all_01` on(`case_all_01`.`id` = `her-tpa`.`daily_aiaf_temp`.`id`)) where `her-tpa`.`daily_aiaf_temp`.`CLAIM_NOTE` = 31 and `case_all_01`.`type` = 1 and (`case_all_01`.`reject_reason` is null or `case_all_01`.`reject_remarks` is null) ;

-- ----------------------------
-- View structure for letter_inpatient
-- ----------------------------
DROP VIEW IF EXISTS `letter_inpatient`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_inpatient` AS select `his-tpa`.`admission`.`id` AS `id`,if(`his-tpa`.`admission`.`source` = 0,'Healthcare System',if(`his-tpa`.`admission`.`source` = 1,'MedisClick - Admission',if(`his-tpa`.`admission`.`source` = 2,'MedisClick - Pre Admission',if(`his-tpa`.`admission`.`source` = 3,'eCentrix',if(`his-tpa`.`admission`.`source` = 4,'eReimbursement',if(`his-tpa`.`admission`.`source` = 5,'Hospital Portal',if(`his-tpa`.`admission`.`source` = 6,'EDC',if(`his-tpa`.`admission`.`source` = 7,'QR Code','')))))))) AS `case_source`,`his-tpa`.`category`.`name` AS `category`,`patient`.`member_name` AS `patient_name`,`principle`.`member_name` AS `member_principle`,`his-tpa`.`admission`.`dob` AS `dob`,`client`.`full_name` AS `client`,`his-tpa`.`company`.`name` AS `company_name`,`his-tpa`.`admission`.`policy_no` AS `policy_no`,`his-tpa`.`admission`.`admission_date` AS `admission_date` from ((((((`his-tpa`.`admission` left join `his-tpa`.`patient` on(`patient`.`id` = `his-tpa`.`admission`.`patient`)) left join `his-tpa`.`client` on(`client`.`id` = `his-tpa`.`admission`.`client`)) left join `his-tpa`.`company` on(`his-tpa`.`company`.`id` = `his-tpa`.`admission`.`company`)) left join `his-tpa`.`category` on(`his-tpa`.`category`.`id` = `his-tpa`.`admission`.`category`)) left join `his-tpa`.`member` on(`his-tpa`.`member`.`id` = `his-tpa`.`admission`.`member_id`)) left join `his-tpa`.`principle` on(`principle`.`id` = `his-tpa`.`admission`.`principle`)) group by `his-tpa`.`admission`.`id` ;

-- ----------------------------
-- View structure for letter_outpatient
-- ----------------------------
DROP VIEW IF EXISTS `letter_outpatient`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_outpatient` AS select `his-tpa`.`admission`.`id` AS `id`,if(`his-tpa`.`admission`.`source` = 0,'Healthcare System',if(`his-tpa`.`admission`.`source` = 1,'MedisClick - Admission',if(`his-tpa`.`admission`.`source` = 2,'MedisClick - Pre Admission',if(`his-tpa`.`admission`.`source` = 3,'eCentrix',if(`his-tpa`.`admission`.`source` = 4,'eReimbursement',if(`his-tpa`.`admission`.`source` = 5,'Hospital Portal',if(`his-tpa`.`admission`.`source` = 6,'EDC',if(`his-tpa`.`admission`.`source` = 7,'QR Code','')))))))) AS `case_source`,`his-tpa`.`category`.`name` AS `category`,`patient`.`member_name` AS `patient_name`,`principle`.`member_name` AS `member_principle`,`his-tpa`.`admission`.`dob` AS `dob`,`client`.`full_name` AS `client`,`his-tpa`.`company`.`name` AS `company_name`,`his-tpa`.`admission`.`policy_no` AS `policy_no` from ((((((`his-tpa`.`admission` left join `his-tpa`.`patient` on(`patient`.`id` = `his-tpa`.`admission`.`patient`)) left join `his-tpa`.`client` on(`client`.`id` = `his-tpa`.`admission`.`client`)) left join `his-tpa`.`company` on(`his-tpa`.`company`.`id` = `his-tpa`.`admission`.`company`)) left join `his-tpa`.`category` on(`his-tpa`.`category`.`id` = `his-tpa`.`admission`.`category`)) left join `his-tpa`.`member` on(`his-tpa`.`member`.`id` = `his-tpa`.`admission`.`member_id`)) left join `his-tpa`.`principle` on(`principle`.`id` = `his-tpa`.`admission`.`principle`)) group by `his-tpa`.`admission`.`id` ;

-- ----------------------------
-- View structure for letter_to_patient
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `letter_to_patient` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,concat(convert(if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',`his-tpa`.`member`.`member_name`),concat(convert(if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`),if(`his-tpa`.`member`.`client` = 1,'',concat('; Ananda ',`his-tpa`.`member`.`member_name`,'.')))) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,250) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,cast(if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,if(`his-tpa`.`case`.`client` = 1 and (`his-tpa`.`plan`.`name` like '%gold%' or `his-tpa`.`plan`.`name` like '%titanium%' or `his-tpa`.`plan`.`name` like '%platinum%'),'(+62-21) 29279676',if(`his-tpa`.`case`.`client` = 1 and (`his-tpa`.`plan`.`name` like '%bronze%' or `his-tpa`.`plan`.`name` like '%silver%'),'(+62-21) 29279626','(+62-21) 29279600')) AS `phone_dedicated`,`his-tpa`.`plan`.`name` AS `plan` from (((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) where `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 98 ;

-- ----------------------------
-- View structure for letter_to_patient_01
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `letter_to_patient_01` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,concat(convert(if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',`his-tpa`.`member`.`member_name`),concat(convert(if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`),if(`his-tpa`.`member`.`client` = 1,'',concat('; Ananda ',`his-tpa`.`member`.`member_name`,'.')))) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,255) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,if(`his-tpa`.`case`.`log_remarks` is null,cast(concat('Bank ',`his-tpa`.`case`.`log_bank`,' cabang ',`his-tpa`.`case`.`log_bank_branch`,'  kota ',`his-tpa`.`case`.`log_bank_city`,'  dengan nomor rekening ',`his-tpa`.`case`.`log_bank_account_no`,'  atas nama ',`his-tpa`.`case`.`log_bank_on_behalf_of`) as char(255) charset utf8mb4),cast(`his-tpa`.`case`.`log_remarks` as char(255) charset utf8mb4)) AS `log_remarks`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,`his-tpa`.`plan_detail`.`name` AS `benefit`,`his-tpa`.`worksheet`.`actual` * `his-tpa`.`case`.`currency_rate` AS `actual`,`his-tpa`.`worksheet`.`cover` * `his-tpa`.`case`.`currency_rate` AS `cover`,cast(`his-tpa`.`worksheet`.`remarks` as char(255) charset utf8) AS `remarks`,cast(substr(`his-tpa`.`worksheet`.`remarks`,256) as char(255) charset utf8) AS `remarks_01`,cast(substr(`his-tpa`.`worksheet`.`remarks`,511) as char(255) charset utf8) AS `remarks_02`,cast(substr(`his-tpa`.`worksheet`.`remarks`,766) as char(255) charset utf8) AS `remarks_03`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1021) as char(255) charset utf8) AS `remarks_04`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1276) as char(255) charset utf8) AS `remarks_05`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1531) as char(255) charset utf8) AS `remarks_06`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1786) as char(255) charset utf8) AS `remarks_07`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2041) as char(255) charset utf8) AS `remarks_08`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2296) as char(255) charset utf8) AS `remarks_09`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2551) as char(255) charset utf8) AS `remarks_10`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2806) as char(255) charset utf8) AS `remarks_11`,if(`his-tpa`.`case`.`client` = 1 and (`his-tpa`.`plan`.`name` like '%gold%' or `his-tpa`.`plan`.`name` like '%titanium%' or `his-tpa`.`plan`.`name` like '%platinum%'),'(+62-21) 29279676',if(`his-tpa`.`case`.`client` = 1 and (`his-tpa`.`plan`.`name` like '%bronze%' or `his-tpa`.`plan`.`name` like '%silver%'),'(+62-21) 29279626','(+62-21) 29279600')) AS `phone_dedicated`,`his-tpa`.`plan`.`name` AS `plan` from (((((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) where `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 98 and `his-tpa`.`case`.`issue_log` = 2 ;

-- ----------------------------
-- View structure for letter_to_patient_02
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_02` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/RejectPending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_pending_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Bapak/Ibu',if(`member_01`.`member_gender` = 1,'Bapak/Ibu','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Bapak/Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak/Ibu','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,concat(convert(if(`his-tpa`.`case`.`gender` = 0,'Bapak/Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak/Ibu','Bapak/Ibu')) using utf8),' ',`his-tpa`.`member`.`member_name`),concat(convert(if(`member_01`.`member_gender` = 0,'Bapak/Ibu',if(`member_01`.`member_gender` = 1,'Bapak/Ibu','Bapak/Ibu')) using utf8),' ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`),if(`his-tpa`.`member`.`client` = 1,'',concat('; Ananda ',`his-tpa`.`member`.`member_name`,'.')))) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,255) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,cast(if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,`his-tpa`.`case`.`diagnosis` AS `code_diagnosis`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,`his-tpa`.`case`.`diagnosis` AS `code_diagnosis_01`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `original_bill_checked_remarks_01`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,511) as char(255) charset utf8) AS `original_bill_checked_remarks_02`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,766) as char(255) charset utf8) AS `original_bill_checked_remarks_03`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,1021) as char(255) charset utf8) AS `original_bill_checked_remarks_04`,if(`his-tpa`.`case`.`client` = 1 and (`his-tpa`.`plan`.`name` like '%gold%' or `his-tpa`.`plan`.`name` like '%titanium%' or `his-tpa`.`plan`.`name` like '%platinum%'),'(+62-21) 29279676',if(`his-tpa`.`case`.`client` = 1 and (`his-tpa`.`plan`.`name` like '%bronze%' or `his-tpa`.`plan`.`name` like '%silver%'),'(+62-21) 29279626','(+62-21) 29279600')) AS `phone_dedicated`,`his-tpa`.`plan`.`name` AS `plan` from (((((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) where `his-tpa`.`case`.`id` > 20000 ;

-- ----------------------------
-- View structure for letter_to_patient_aia
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_aia`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_aia` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,concat('Bapak/Ibu. ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`)) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,255) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,'' AS `policy_expiry_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,if(`his-tpa`.`case`.`log_remarks` is null,cast(concat('Bank ',`his-tpa`.`case`.`log_bank`,' cabang ',`his-tpa`.`case`.`log_bank_branch`,'  kota ',`his-tpa`.`case`.`log_bank_city`,'  dengan nomor rekening ',`his-tpa`.`case`.`log_bank_account_no`,'  atas nama ',`his-tpa`.`case`.`log_bank_on_behalf_of`) as char(255) charset utf8mb4),cast(`his-tpa`.`case`.`log_remarks` as char(255) charset utf8mb4)) AS `log_remarks`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,`his-tpa`.`plan_detail`.`name` AS `benefit`,`his-tpa`.`worksheet`.`actual` * `his-tpa`.`case`.`currency_rate` AS `actual`,`his-tpa`.`worksheet`.`cover` * `his-tpa`.`case`.`currency_rate` AS `cover`,cast(`his-tpa`.`worksheet`.`remarks` as char(255) charset utf8) AS `remarks`,cast(substr(`his-tpa`.`worksheet`.`remarks`,256) as char(255) charset utf8) AS `remarks_01`,cast(substr(`his-tpa`.`worksheet`.`remarks`,511) as char(255) charset utf8) AS `remarks_02`,cast(substr(`his-tpa`.`worksheet`.`remarks`,766) as char(255) charset utf8) AS `remarks_03`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1021) as char(255) charset utf8) AS `remarks_04`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1276) as char(255) charset utf8) AS `remarks_05`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1531) as char(255) charset utf8) AS `remarks_06`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1786) as char(255) charset utf8) AS `remarks_07`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2041) as char(255) charset utf8) AS `remarks_08`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2296) as char(255) charset utf8) AS `remarks_09`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2551) as char(255) charset utf8) AS `remarks_10`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2806) as char(255) charset utf8) AS `remarks_11`,`his-tpa`.`plan`.`name` AS `plan` from (((((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) where `his-tpa`.`case`.`client` = 1 and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` in (26,27,28,29,30) and `his-tpa`.`case`.`issue_log` = 2 ;

-- ----------------------------
-- View structure for letter_to_patient_aia_01
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_aia_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_aia_01` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,concat('Bapak/Ibu. ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`)) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,500) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,cast(if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,`his-tpa`.`plan`.`name` AS `plan` from (((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) where `his-tpa`.`case`.`client` = 1 and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` = 2 ;

-- ----------------------------
-- View structure for letter_to_patient_aia_02
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_aia_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_aia_02` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Bapak/Ibu',if(`member_01`.`member_gender` = 1,'Bapak/Ibu','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Bapak/Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak/Ibu','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,concat('Bapak/Ibu. ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`)) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,500) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,cast(if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,`his-tpa`.`plan`.`name` AS `plan` from (((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) where `his-tpa`.`case`.`client` = 1 and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` = 31 and `his-tpa`.`case`.`type` = 1 ;

-- ----------------------------
-- View structure for letter_to_patient_aia_03
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_aia_03`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_aia_03` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/RejectPending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_pending_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,concat('Bapak/Ibu. ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`)) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,255) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,cast(if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,`his-tpa`.`case`.`diagnosis` AS `code_diagnosis`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,`his-tpa`.`case`.`diagnosis` AS `code_diagnosis_01`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `original_bill_checked_remarks_01`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,511) as char(255) charset utf8) AS `original_bill_checked_remarks_02`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,766) as char(255) charset utf8) AS `original_bill_checked_remarks_03`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,1021) as char(255) charset utf8) AS `original_bill_checked_remarks_04`,`his-tpa`.`plan`.`name` AS `plan` from (((((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) where `his-tpa`.`case`.`client` = 1 and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` = 31 ;

-- ----------------------------
-- View structure for letter_to_patient_commlife
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_commlife`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_commlife` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,concat(convert(if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',`his-tpa`.`member`.`member_name`),concat(convert(if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`),'; Ananda ',`his-tpa`.`member`.`member_name`,'.')) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,255) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') AS `policy_expiry_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,if(`his-tpa`.`case`.`log_remarks` is null,cast(concat('Bank ',`his-tpa`.`case`.`log_bank`,' cabang ',`his-tpa`.`case`.`log_bank_branch`,'  kota ',`his-tpa`.`case`.`log_bank_city`,'  dengan nomor rekening ',`his-tpa`.`case`.`log_bank_account_no`,'  atas nama ',`his-tpa`.`case`.`log_bank_on_behalf_of`) as char(255) charset utf8mb4),cast(`his-tpa`.`case`.`log_remarks` as char(255) charset utf8mb4)) AS `log_remarks`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,`his-tpa`.`plan_detail`.`name` AS `benefit`,`his-tpa`.`worksheet`.`actual` * `his-tpa`.`case`.`currency_rate` AS `actual`,`his-tpa`.`worksheet`.`cover` * `his-tpa`.`case`.`currency_rate` AS `cover`,cast(`his-tpa`.`worksheet`.`remarks` as char(255) charset utf8) AS `remarks`,cast(substr(`his-tpa`.`worksheet`.`remarks`,256) as char(255) charset utf8) AS `remarks_01`,cast(substr(`his-tpa`.`worksheet`.`remarks`,511) as char(255) charset utf8) AS `remarks_02`,cast(substr(`his-tpa`.`worksheet`.`remarks`,766) as char(255) charset utf8) AS `remarks_03`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1021) as char(255) charset utf8) AS `remarks_04`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1276) as char(255) charset utf8) AS `remarks_05`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1531) as char(255) charset utf8) AS `remarks_06`,cast(substr(`his-tpa`.`worksheet`.`remarks`,1786) as char(255) charset utf8) AS `remarks_07`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2041) as char(255) charset utf8) AS `remarks_08`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2296) as char(255) charset utf8) AS `remarks_09`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2551) as char(255) charset utf8) AS `remarks_10`,cast(substr(`his-tpa`.`worksheet`.`remarks`,2806) as char(255) charset utf8) AS `remarks_11` from ((((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) where `his-tpa`.`case`.`client` = 31 and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` in (26,27,28,29,30) and `his-tpa`.`case`.`issue_log` = 2 ;

-- ----------------------------
-- View structure for letter_to_patient_commlife_01
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_commlife_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_commlife_01` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,concat(convert(if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',`his-tpa`.`member`.`member_name`),concat(convert(if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`),'; Ananda ',`his-tpa`.`member`.`member_name`,'.')) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,500) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,cast(if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01` from ((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) where `his-tpa`.`case`.`client` = 31 and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` = 2 ;

-- ----------------------------
-- View structure for letter_to_patient_commlife_02
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_commlife_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_commlife_02` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,concat(convert(if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',`his-tpa`.`member`.`member_name`),concat(convert(if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`),'; Ananda ',`his-tpa`.`member`.`member_name`,'.')) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,500) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,cast(if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01` from ((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) where `his-tpa`.`case`.`client` = 31 and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` = 31 and `his-tpa`.`case`.`type` = 1 ;

-- ----------------------------
-- View structure for letter_to_patient_mag
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_mag`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_mag` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/RejectPending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_pending_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,concat(convert(if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',`his-tpa`.`member`.`member_name`),concat(convert(if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`),'; Ananda ',`his-tpa`.`member`.`member_name`,'.')) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,255) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,cast(if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,`his-tpa`.`case`.`diagnosis` AS `code_diagnosis`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,`his-tpa`.`case`.`diagnosis` AS `code_diagnosis_01`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `original_bill_checked_remarks_01`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,511) as char(255) charset utf8) AS `original_bill_checked_remarks_02`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,766) as char(255) charset utf8) AS `original_bill_checked_remarks_03`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,1021) as char(255) charset utf8) AS `original_bill_checked_remarks_04` from ((((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) where `his-tpa`.`case`.`client` = 263 and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`original_bill_checked` = 2 ;

-- ----------------------------
-- View structure for letter_to_patient_mag_01
-- ----------------------------
DROP VIEW IF EXISTS `letter_to_patient_mag_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `letter_to_patient_mag_01` AS select `his-tpa`.`case`.`id` AS `case`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `create_date`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Reject/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Payment/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `payment_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Pending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `pending_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/Waiting/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `waiting_no`,concat(convert(lpad(`his-tpa`.`case`.`id`,6,0) using utf8mb4),'/RejectPending/OPS/AAI/',convert(if(month(curdate()) = 1,'I',if(month(curdate()) = 2,'II',if(month(curdate()) = 3,'III',if(month(curdate()) = 4,'IV',if(month(curdate()) = 5,'V',if(month(curdate()) = 6,'VI',if(month(curdate()) = 7,'VII',if(month(curdate()) = 8,'VIII',if(month(curdate()) = 9,'IX',if(month(curdate()) = 10,'X',if(month(curdate()) = 11,'XI',if(month(curdate()) = 12,'XII','')))))))))))) using utf8mb4),'/',year(curdate())) AS `rejection_pending_no`,if(`his-tpa`.`case`.`client` = 1,'Rawat Inap',if(`his-tpa`.`case`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`case`.`category` = 1,'Rawat Inap',''))) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`member_01`.`member_dob`)),'%Y') + 0 > 17,if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')),'Ananda') AS `salutation_01`,if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`) AS `principle_name`,`his-tpa`.`member`.`member_name` AS `patient_name`,if(date_format(from_days(to_days(current_timestamp()) - to_days(`his-tpa`.`case`.`dob`)),'%Y') + 0 > 17,concat(convert(if(`his-tpa`.`case`.`gender` = 0,'Ibu',if(`his-tpa`.`case`.`gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',`his-tpa`.`member`.`member_name`),concat(convert(if(`member_01`.`member_gender` = 0,'Ibu',if(`member_01`.`member_gender` = 1,'Bapak','Bapak/Ibu')) using utf8),' ',if(`his-tpa`.`member`.`policy_holder` is null,`member_01`.`member_name`,`his-tpa`.`member`.`policy_holder`),'; Ananda ',`his-tpa`.`member`.`member_name`,'.')) AS `member_name`,substr(`his-tpa`.`member`.`member_address`,1,40) AS `member_address`,substr(`his-tpa`.`member`.`member_address`,41,255) AS `member_address_01`,`his-tpa`.`member`.`member_phone` AS `member_phone`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`case`.`policy_no` AS `policy_no`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_revival_date`,'%d/%m/%Y') AS `policy_revival_date`,if(`client`.`id` = 1,'',concat(' - ',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_expiry_date`,cast(if(`his-tpa`.`case`.`provider` in (310,2417,2462),`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 1,convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4),'-') AS `discharge_date`,`his-tpa`.`case`.`diagnosis` AS `code_diagnosis`,cast(`his-tpa`.`diagnosis`.`name` as char(255) charset utf8) AS `diagnosis`,`his-tpa`.`case`.`diagnosis` AS `code_diagnosis_01`,cast(substr(`his-tpa`.`diagnosis`.`name`,256) as char(255) charset utf8) AS `diagnosis_01`,cast(`his-tpa`.`case`.`other_diagnosis` as char(255) charset utf8) AS `other_diagnosis`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,256) as char(255) charset utf8) AS `other_diagnosis_01`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,511) as char(255) charset utf8) AS `other_diagnosis_02`,cast(substr(`his-tpa`.`case`.`other_diagnosis`,766) as char(255) charset utf8) AS `other_diagnosis_03`,`his-tpa`.`country`.`iso-4217` AS `currency`,`worksheet_header`.`total_actual` * `his-tpa`.`case`.`currency_rate` AS `total_actual`,`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate` AS `total_cover`,cast(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)) as char(255) charset utf8) AS `total_cover_01`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),256) as char(255) charset utf8) AS `total_cover_02`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),511) as char(255) charset utf8) AS `total_cover_03`,cast(substr(`terbilang`(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,0)),766) as char(255) charset utf8) AS `total_cover_04`,cast(if(concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4)) = 'KOMA ','',concat('KOMA ',convert(`terbilang`(right(round(`worksheet_header`.`total_cover` * `his-tpa`.`case`.`currency_rate`,2),2)) using utf8mb4))) as char(255) charset utf8) AS `total_cover_05`,`his-tpa`.`member`.`bank` AS `bank`,`his-tpa`.`member`.`location` AS `location`,`his-tpa`.`member`.`account_no` AS `account_no`,`his-tpa`.`member`.`on_behalf_of` AS `on_behalf_of`,cast(`his-tpa`.`case`.`original_bill_checked_remarks` as char(255) charset utf8) AS `required_doc`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `required_doc_01`,cast(`his-tpa`.`case`.`reject_reason` as char(255) charset utf8) AS `reject_reason`,cast(substr(`his-tpa`.`case`.`reject_reason`,256) as char(255) charset utf8) AS `reject_reason_01`,cast(substr(`his-tpa`.`case`.`reject_reason`,511) as char(255) charset utf8) AS `reject_reason_02`,cast(substr(`his-tpa`.`case`.`reject_reason`,766) as char(255) charset utf8) AS `reject_reason_03`,cast(substr(`his-tpa`.`case`.`reject_reason`,1021) as char(255) charset utf8) AS `reject_reason_04`,cast(`his-tpa`.`case`.`reject_remarks` as char(255) charset utf8) AS `reject_remarks`,cast(substr(`his-tpa`.`case`.`reject_remarks`,256) as char(255) charset utf8) AS `reject_remarks_01`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,256) as char(255) charset utf8) AS `original_bill_checked_remarks_01`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,511) as char(255) charset utf8) AS `original_bill_checked_remarks_02`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,766) as char(255) charset utf8) AS `original_bill_checked_remarks_03`,cast(substr(`his-tpa`.`case`.`original_bill_checked_remarks`,1021) as char(255) charset utf8) AS `original_bill_checked_remarks_04` from ((((((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) where `his-tpa`.`case`.`client` = 263 and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` = 31 ;

-- ----------------------------
-- View structure for log
-- ----------------------------
DROP VIEW IF EXISTS `log`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `log` AS select `provider`.`full_name` AS `provider`,if(`provider`.`type` = '1','rumah sakit',if(`provider`.`type` = '2','klinik','ERROR')) AS `provider_type`,concat(`provider`.`fax`,' / ',`provider`.`email`) AS `fax_email`,if(`his-tpa`.`case`.`category` = 0,'Admin Rawat Jalan',if(`his-tpa`.`case`.`category` = 0,'Admin Rawat Inap','Admin Rumah Sakit')) AS `recipient`,date_format(`his-tpa`.`case`.`log_issue_date`,'%d/%m/%Y') AS `issue_date`,`his-tpa`.`case`.`id` AS `case`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`plan`.`name` AS `plan`,'Surat Jaminan Akhir' AS `log_type`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`case`.`policy_no` AS `policy_no`,concat(convert(date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4)) AS `policy_period`,`client`.`full_name` AS `client`,concat(convert(date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4)) AS `treatment_period`,concat(to_days(`his-tpa`.`case`.`discharge_date`) - to_days(`his-tpa`.`case`.`admission_date`) + 1,' Hari') AS `days_of_treatment`,if(`his-tpa`.`case`.`category` = 0,'rawat jalan',if(`his-tpa`.`case`.`category` = 1,'rawat inap','ERROR')) AS `treatment_type`,cast(concat(`his-tpa`.`diagnosis`.`code`,'. ',`his-tpa`.`diagnosis`.`name`,if(`his-tpa`.`case`.`other_diagnosis` is null,'',concat('; ',`his-tpa`.`case`.`other_diagnosis`))) as char(255) charset utf8) AS `diagnosis`,`his-tpa`.`country`.`iso-4217` AS `currency`,sum(`his-tpa`.`worksheet`.`actual`) AS `total_actual`,sum(`his-tpa`.`worksheet`.`cover`) AS `total_cover`,sum(`his-tpa`.`worksheet`.`excess`) AS `total_excess`,cast(left(group_concat(`his-tpa`.`worksheet`.`remarks` order by `his-tpa`.`worksheet`.`id` ASC separator '; '),255) as char(255) charset utf8) AS `remarks`,cast(substr(group_concat(`his-tpa`.`worksheet`.`remarks` order by `his-tpa`.`worksheet`.`id` ASC separator '; '),256) as char(255) charset utf8) AS `remarks_01`,cast(substr(group_concat(`his-tpa`.`worksheet`.`remarks` order by `his-tpa`.`worksheet`.`id` ASC separator '; '),511) as char(255) charset utf8) AS `remarks_02`,cast(substr(group_concat(`his-tpa`.`worksheet`.`remarks` order by `his-tpa`.`worksheet`.`id` ASC separator '; '),766) as char(255) charset utf8) AS `remarks_03`,cast(substr(group_concat(`his-tpa`.`worksheet`.`remarks` order by `his-tpa`.`worksheet`.`id` ASC separator '; '),1021) as char(255) charset utf8) AS `remarks_04`,`his-tpa`.`users`.`full_name` AS `issued_by`,`his-tpa`.`users`.`signature` AS `signature`,'80' AS `height`,concat('HC-',if(`his-tpa`.`case`.`category` = 0,'OP-',if(`his-tpa`.`case`.`category` = 1,'IP-','')),`his-tpa`.`case`.`id`) AS `log_code`,`his-tpa`.`case`.`id` AS `barcode` from ((((((((`his-tpa`.`case` join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`users` on(convert(`his-tpa`.`case`.`log_issued_by` using utf8) = `his-tpa`.`users`.`username`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) where `his-tpa`.`case`.`status` not in (99,98) and `his-tpa`.`case`.`issue_log` = 2 group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for log_detail
-- ----------------------------
DROP VIEW IF EXISTS `log_detail`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `log_detail` AS select `automation_report`.`code` AS `code`,`automation_report`.`case` AS `case`,`automation_report`.`remarks` AS `remarks`,`automation_report`.`process_date` AS `process_date` from `automation_report` where `automation_report`.`client` <> 238 ;

-- ----------------------------
-- View structure for log_header
-- ----------------------------
DROP VIEW IF EXISTS `log_header`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `log_header` AS select `client`.`full_name` AS `client`,if(`her-tpa`.`log_automation`.`category` = 1,'Report',if(`her-tpa`.`log_automation`.`category` = 2,'Notification','Error')) AS `category`,`her-tpa`.`automation_type`.`name` AS `type`,`her-tpa`.`log_automation`.`name` AS `name`,if(`her-tpa`.`log_automation`.`method` = 1,'Email',if(`her-tpa`.`log_automation`.`method` = 2,'Z Folder',if(`her-tpa`.`log_automation`.`method` = 3,'Sftp','Error'))) AS `method`,`her-tpa`.`log_automation`.`code` AS `code`,`her-tpa`.`log_automation`.`process_date` AS `report_date`,`her-tpa`.`log_automation`.`send_date` AS `send_date`,`her-tpa`.`log_automation`.`status` AS `status` from ((`her-tpa`.`log_automation` left join `her-tpa`.`client` on(`her-tpa`.`log_automation`.`client` = `client`.`id`)) join `her-tpa`.`automation_type` on(`her-tpa`.`log_automation`.`type` = `her-tpa`.`automation_type`.`id`)) where `her-tpa`.`log_automation`.`client` <> 238 ;

-- ----------------------------
-- View structure for medical_enquiries
-- ----------------------------
DROP VIEW IF EXISTS `medical_enquiries`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `medical_enquiries` AS select `his-tpa`.`case`.`id` AS `case`,date_format(curdate(),'%d/%m/%Y') AS `letter_date`,`his-tpa`.`member`.`member_name` AS `member_name`,date_format(`his-tpa`.`case`.`dob`,'%d/%m/%Y') AS `member_dob`,`client`.`full_name` AS `client`,cast(if(`his-tpa`.`case`.`provider` = 310,`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) as char(255) charset utf8) AS `medical_provider` from (((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) ;

-- ----------------------------
-- View structure for member_count_per_client
-- ----------------------------
DROP VIEW IF EXISTS `member_count_per_client`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `member_count_per_client` AS select `his-tpa`.`member`.`client` AS `client_id`,`client`.`full_name` AS `client_name`,year(curdate()) AS `year`,count(`his-tpa`.`member`.`id`) AS `total_member` from (`his-tpa`.`member` join `his-tpa`.`client` on(`his-tpa`.`member`.`client` = `client`.`id`)) where `his-tpa`.`member`.`policy_status` = 1 group by `his-tpa`.`member`.`client` ;

-- ----------------------------
-- View structure for monthly_aceg
-- ----------------------------
DROP VIEW IF EXISTS `monthly_aceg`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `monthly_aceg` AS select if(`his-tpa`.`case`.`type` = 1,`his-tpa`.`case`.`original_bill_upload_date`,if(`his-tpa`.`case`.`type` = 2,`his-tpa`.`case`.`bill_upload_date`,if(`his-tpa`.`case`.`type` = 3,`his-tpa`.`case`.`bill_upload_date`,if(`his-tpa`.`case`.`type` = 4,`his-tpa`.`case`.`original_bill_upload_date`,NULL)))) AS `filter_01`,`his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','')) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`plan`.`name` AS `plan`,coalesce(`his-tpa`.`member`.`member_name`,`member_01`.`member_name`) AS `policy_holder`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`member`.`member_name` AS `policy_insured`,if(`his-tpa`.`case`.`gender` = 0,'Female',if(`his-tpa`.`case`.`gender` = 1,'Male','')) AS `gender`,date_format(`his-tpa`.`case`.`dob`,'%d/%m/%Y') AS `dob`,`his-tpa`.`company`.`name` AS `policy_group`,date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') AS `policy_effective_date`,date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') AS `policy_expiry_date`,if(`his-tpa`.`case`.`provider` = 310,`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) AS `provider`,`provider`.`country` AS `country`,date_format(`his-tpa`.`case`.`create_date`,'%d/%m/%Y') AS `receive_date`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') AS `discharge_date`,`worksheet_header`.`total_actual` AS `total_actual`,`worksheet_header`.`total_cover` AS `total_cover`,`worksheet_header`.`total_excess` AS `total_excess`,0 AS `collect_from_company`,0 AS `paid_by_patient`,date_format(`his-tpa`.`case`.`payment_date`,'%d/%m/%Y') AS `payment_date`,concat(`his-tpa`.`case`.`diagnosis`,', ',`his-tpa`.`diagnosis`.`name`) AS `diagnosis`,`his-tpa`.`country`.`iso-4217` AS `currency`,`his-tpa`.`case`.`currency_rate` AS `currency_rate`,'' AS `remarks`,if(`his-tpa`.`case`.`status` = 1,'01. Admission - New (Pending Upload HAF & Supporting Document)',if(`his-tpa`.`case`.`status` = 2,'02. Admission - Pending HAF & Supporting Document Completeness Approval',if(`his-tpa`.`case`.`status` = 3,'03. Admission - Pending Issue Initial LOG',if(`his-tpa`.`case`.`status` = 4,'04. Admission - Completed (Discharge - Pending Upload Softcopy Bill)',if(`his-tpa`.`case`.`status` = 5,'05. Discharge - Pending Softcopy Bill Completeness Approval',if(`his-tpa`.`case`.`status` = 6,'06. Discharge - Pending WS Process',if(`his-tpa`.`case`.`status` = 7,'07. Discharge - Pending WS Approval',if(`his-tpa`.`case`.`status` = 8,'08. Discharge - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 9,'09. Discharge - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 10,'10. Discharge - Pending Issue Final LOG',if(`his-tpa`.`case`.`status` = 11,'11. Discharge - Completed (Administration - Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 12,'12. Administration - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 13,'13. Administration - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 14,'14. Administration - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 15,'15. Administration - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 16,'16. Administration - Pending Payment Process',if(`his-tpa`.`case`.`status` = 17,'17. Administration - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 18,'18. Administration - Pending Document Received by Client',if(`his-tpa`.`case`.`status` = 19,'19. Reimbursement - New (Pending Upload Original Bill)',if(`his-tpa`.`case`.`status` = 20,'20. Reimbursement - Pending Original Bill Checking',if(`his-tpa`.`case`.`status` = 21,'21. Reimbursement - Pending WS Process',if(`his-tpa`.`case`.`status` = 22,'22. Reimbursement - Pending WS Approval',if(`his-tpa`.`case`.`status` = 23,'23. Reimbursement - Pending WS Process (Revision)',if(`his-tpa`.`case`.`status` = 24,'24. Reimbursement - Pending WS Approval (Revision)',if(`his-tpa`.`case`.`status` = 25,'25. Reimbursement - Pending Issue LOG/ Non LOG',if(`his-tpa`.`case`.`status` = 26,'26. Reimbursement - Pending Original Bill Verification',if(`his-tpa`.`case`.`status` = 27,'27. Reimbursement - Pending Payment Process',if(`his-tpa`.`case`.`status` = 28,'28. Reimbursement - Pending Document Send Back to Client',if(`his-tpa`.`case`.`status` = 29,'29. Reimbursement - Pending Document Received by Client',if(`his-tpa`.`case`.`status` = 30,'30. Case Closed - Guaranteed',if(`his-tpa`.`case`.`status` = 31,'31. Case Closed - Declined by AA',if(`his-tpa`.`case`.`status` = 32,'32. Case Closed - Declined by Patient','ERROR')))))))))))))))))))))))))))))))) AS `status` from ((((((((`his-tpa`.`case` join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) where `his-tpa`.`case`.`client` = 17 and if(`his-tpa`.`case`.`type` = 1,`his-tpa`.`case`.`original_bill_upload_date`,if(`his-tpa`.`case`.`type` = 2,`his-tpa`.`case`.`bill_upload_date`,if(`his-tpa`.`case`.`type` = 3,`his-tpa`.`case`.`bill_upload_date`,if(`his-tpa`.`case`.`type` = 4,`his-tpa`.`case`.`original_bill_upload_date`,NULL)))) is not null ;

-- ----------------------------
-- View structure for nonlog
-- ----------------------------
DROP VIEW IF EXISTS `nonlog`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog` AS select `provider`.`full_name` AS `provider`,if(`provider`.`type` = '1','rumah sakit',if(`provider`.`type` = '2','klinik','ERROR')) AS `provider_type`,concat(`provider`.`fax`,' / ',`provider`.`email`) AS `fax_email`,if(`his-tpa`.`case`.`category` = 0,'Admin Rawat Jalan',if(`his-tpa`.`case`.`category` = 0,'Admin Rawat Inap','Admin Rumah Sakit')) AS `recipient`,if(`his-tpa`.`case`.`log_issue_date` is null,date_format(`his-tpa`.`case`.`initial_log_issue_date`,'%d/%m/%Y'),date_format(`his-tpa`.`case`.`log_issue_date`,'%d/%m/%Y')) AS `issue_date`,`his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`claim_no` = '',`his-tpa`.`case`.`initial_claim_no`,if(`his-tpa`.`case`.`claim_no` is null,`his-tpa`.`case`.`initial_claim_no`,`his-tpa`.`case`.`claim_no`)) AS `claim_no`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`case`.`policy_no` AS `policy_no`,if(`his-tpa`.`case`.`client` = 1,convert(date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') using utf8mb4),concat(convert(date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4))) AS `policy_period`,`client`.`full_name` AS `client`,date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') AS `admission_date`,if(`his-tpa`.`case`.`category` = 0,'rawat jalan',if(`his-tpa`.`case`.`category` = 1,'rawat inap','ERROR')) AS `admission_type`,coalesce(`users_01`.`full_name`,`his-tpa`.`users`.`full_name`) AS `issued_by`,`nonlog_reason`.`id` AS `nonlog_reason_id`,`nonlog_reason`.`checklist` AS `nonlog_reason_checklist`,`nonlog_reason`.`reason` AS `nonlog_reason_description`,cast(`his-tpa`.`case`.`nonlog_remarks` as char(255) charset utf8) AS `nonlog_remarks`,coalesce(`users_01`.`signature`,`his-tpa`.`users`.`signature`) AS `signature` from (((((((`his-tpa`.`case` join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `her-tpa`.`nonlog_reason` on(`his-tpa`.`case`.`id` = `nonlog_reason`.`case`)) left join `his-tpa`.`users` on(convert(`his-tpa`.`case`.`initial_log_issued_by` using utf8) = `his-tpa`.`users`.`username`)) left join `his-tpa`.`users` `users_01` on(convert(`his-tpa`.`case`.`log_issued_by` using utf8) = `users_01`.`username`)) where `his-tpa`.`case`.`status` not in (99,98) and (`his-tpa`.`case`.`issue_initial_log` = 3 or `his-tpa`.`case`.`issue_log` = 3) group by `his-tpa`.`case`.`id`,`nonlog_reason`.`id` ;

-- ----------------------------
-- View structure for nonlog_reason
-- ----------------------------
DROP VIEW IF EXISTS `nonlog_reason`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog_reason` AS select `nonlog_reason_01`.`case` AS `case`,`nonlog_reason_01`.`id` AS `id`,`nonlog_reason_01`.`checklist` AS `checklist`,`nonlog_reason_01`.`reason` AS `reason` from `her-tpa`.`nonlog_reason_01` union all select `nonlog_reason_02`.`case` AS `case`,`nonlog_reason_02`.`id` AS `id`,`nonlog_reason_02`.`checklist` AS `checklist`,`nonlog_reason_02`.`reason` AS `reason` from `her-tpa`.`nonlog_reason_02` union all select `nonlog_reason_03`.`case` AS `case`,`nonlog_reason_03`.`id` AS `id`,`nonlog_reason_03`.`checklist` AS `checklist`,`nonlog_reason_03`.`reason` AS `reason` from `her-tpa`.`nonlog_reason_03` union all select `nonlog_reason_04`.`case` AS `case`,`nonlog_reason_04`.`id` AS `id`,`nonlog_reason_04`.`checklist` AS `checklist`,`nonlog_reason_04`.`reason` AS `reason` from `her-tpa`.`nonlog_reason_04` union all select `nonlog_reason_05`.`case` AS `case`,`nonlog_reason_05`.`id` AS `id`,`nonlog_reason_05`.`checklist` AS `checklist`,`nonlog_reason_05`.`reason` AS `reason` from `her-tpa`.`nonlog_reason_05` union all select `nonlog_reason_06`.`case` AS `case`,`nonlog_reason_06`.`id` AS `id`,`nonlog_reason_06`.`checklist` AS `checklist`,`nonlog_reason_06`.`reason` AS `reason` from `her-tpa`.`nonlog_reason_06` union all select `nonlog_reason_07`.`case` AS `case`,`nonlog_reason_07`.`id` AS `id`,`nonlog_reason_07`.`checklist` AS `checklist`,`nonlog_reason_07`.`reason` AS `reason` from `her-tpa`.`nonlog_reason_07` union all select `nonlog_reason_08`.`case` AS `case`,`nonlog_reason_08`.`id` AS `id`,`nonlog_reason_08`.`checklist` AS `checklist`,`nonlog_reason_08`.`reason` AS `reason` from `her-tpa`.`nonlog_reason_08` ;

-- ----------------------------
-- View structure for nonlog_reason_01
-- ----------------------------
DROP VIEW IF EXISTS `nonlog_reason_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog_reason_01` AS select `his-tpa`.`case`.`id` AS `case`,'1' AS `id`,if(`his-tpa`.`case`.`nonlog_reason` like '%1%','x',NULL) AS `checklist`,'Formulir rumah sakit yang tidak diisi lengkap oleh dokter anda.' AS `reason` from `his-tpa`.`case` ;

-- ----------------------------
-- View structure for nonlog_reason_02
-- ----------------------------
DROP VIEW IF EXISTS `nonlog_reason_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog_reason_02` AS select `his-tpa`.`case`.`id` AS `case`,'2' AS `id`,if(`his-tpa`.`case`.`nonlog_reason` like '%2%','x',NULL) AS `checklist`,'Informasi medis tambahan / penjelasan sangat diperlukan dari dokter anda.' AS `reason` from `his-tpa`.`case` ;

-- ----------------------------
-- View structure for nonlog_reason_03
-- ----------------------------
DROP VIEW IF EXISTS `nonlog_reason_03`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog_reason_03` AS select `his-tpa`.`case`.`id` AS `case`,'3' AS `id`,if(`his-tpa`.`case`.`nonlog_reason` like '%3%','x',NULL) AS `checklist`,'Sejarah penyakit sangat diperlukan dari keluarga / dokter yang merujuk anda.' AS `reason` from `his-tpa`.`case` ;

-- ----------------------------
-- View structure for nonlog_reason_04
-- ----------------------------
DROP VIEW IF EXISTS `nonlog_reason_04`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog_reason_04` AS select `his-tpa`.`case`.`id` AS `case`,'4' AS `id`,if(`his-tpa`.`case`.`nonlog_reason` like '%4%','x',NULL) AS `checklist`,'Perincian dari kuitansi anda sangat dibutuhkan.' AS `reason` from `his-tpa`.`case` ;

-- ----------------------------
-- View structure for nonlog_reason_05
-- ----------------------------
DROP VIEW IF EXISTS `nonlog_reason_05`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog_reason_05` AS select `his-tpa`.`case`.`id` AS `case`,'5' AS `id`,if(`his-tpa`.`case`.`nonlog_reason` like '%5%','x',NULL) AS `checklist`,'Polis anda sudah habis limit manfaatnya.' AS `reason` from `his-tpa`.`case` ;

-- ----------------------------
-- View structure for nonlog_reason_06
-- ----------------------------
DROP VIEW IF EXISTS `nonlog_reason_06`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog_reason_06` AS select `his-tpa`.`case`.`id` AS `case`,'6' AS `id`,if(`his-tpa`.`case`.`nonlog_reason` like '%6%','x',NULL) AS `checklist`,'Polis anda dalam masa tunggu.' AS `reason` from `his-tpa`.`case` ;

-- ----------------------------
-- View structure for nonlog_reason_07
-- ----------------------------
DROP VIEW IF EXISTS `nonlog_reason_07`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog_reason_07` AS select `his-tpa`.`case`.`id` AS `case`,'7' AS `id`,if(`his-tpa`.`case`.`nonlog_reason` like '%7%','x',NULL) AS `checklist`,'Kondisi medis anda, di luar tabel manfaat untuk menjaminnya.' AS `reason` from `his-tpa`.`case` ;

-- ----------------------------
-- View structure for nonlog_reason_08
-- ----------------------------
DROP VIEW IF EXISTS `nonlog_reason_08`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `nonlog_reason_08` AS select `his-tpa`.`case`.`id` AS `case`,'8' AS `id`,if(`his-tpa`.`case`.`nonlog_reason` like '%8%','x',NULL) AS `checklist`,'Fasilitas jaminan dinon-aktifkan / diberhentikan atas perintah dari pihak penanggung, silahkan hubungi lebih lanjut pihak penanggung anda.' AS `reason` from `his-tpa`.`case` ;

-- ----------------------------
-- View structure for payment_claim_detail
-- ----------------------------
DROP VIEW IF EXISTS `payment_claim_detail`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `payment_claim_detail` AS select coalesce(`his-tpa`.`case`.`create_date_01`,`his-tpa`.`case`.`create_date`) AS `RECEIVED_DATE`,`client`.`id` AS `CLIENT_ID`,`client`.`full_name` AS `CLIENT_NAME`,`his-tpa`.`case`.`policy_no` AS `POLICY_NO`,`his-tpa`.`program`.`name` AS `PROGRAM`,`his-tpa`.`plan`.`name` AS `PLAN_ID`,`his-tpa`.`case`.`id` AS `CLAIM_REF`,`his-tpa`.`member`.`member_name` AS `PATIENT`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `GENDER`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `CATEGORY`,`his-tpa`.`plan_detail`.`name` AS `NAME_OF_BENEFIT`,`his-tpa`.`diagnosis`.`code` AS `DIAGNOSIS_CODE`,`his-tpa`.`diagnosis`.`name` AS `DIAGNOSIS_DESC`,`provider`.`full_name` AS `HOSPITAL`,`his-tpa`.`case`.`other_provider` AS `OTHER_HOSPITAL`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `TYPE`,`his-tpa`.`case`.`admission_date` AS `ADMISSION_DATE`,cast(`his-tpa`.`case`.`discharge_date` as date) AS `DISCHARGE_DATE`,`his-tpa`.`country`.`name` AS `CURRENCY_01`,`his-tpa`.`country`.`name` AS `CURRENCY_02`,`his-tpa`.`worksheet`.`actual` AS `TOTAL_AMOUNT_INCURRED`,`his-tpa`.`worksheet`.`cover` AS `TOTAL_AMOUNT_APPROVED`,`his-tpa`.`worksheet`.`excess` AS `TOTAL_AMOUNT_NOT_APPROVED`,cast(`his-tpa`.`case`.`payment_date` as date) AS `PAYMENT_DATE`,'Paid' AS `Status`,`his-tpa`.`case_status`.`name` AS `CASE_STATUS`,`his-tpa`.`worksheet`.`remarks` AS `REMARKS` from ((((((((((((((`his-tpa`.`case` left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`client` <> 8 and `his-tpa`.`case`.`issue_log` = 2 and `his-tpa`.`case`.`status` not in (99,96) group by `his-tpa`.`worksheet`.`id` ;

-- ----------------------------
-- View structure for payment_claim_detail_fullcover
-- ----------------------------
DROP VIEW IF EXISTS `payment_claim_detail_fullcover`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `payment_claim_detail_fullcover` AS select coalesce(`his-tpa`.`case`.`create_date_01`,`his-tpa`.`case`.`create_date`) AS `RECEIVED_DATE`,`client`.`id` AS `CLIENT_ID`,`client`.`full_name` AS `CLIENT_NAME`,`his-tpa`.`case`.`policy_no` AS `POLICY_NO`,`his-tpa`.`program`.`name` AS `PROGRAM`,`his-tpa`.`plan`.`name` AS `PLAN_ID`,`his-tpa`.`case`.`id` AS `CLAIM_REF`,`his-tpa`.`member`.`member_name` AS `PATIENT`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `GENDER`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `CATEGORY`,`his-tpa`.`plan_detail`.`name` AS `NAME_OF_BENEFIT`,`his-tpa`.`diagnosis`.`code` AS `DIAGNOSIS_CODE`,`his-tpa`.`diagnosis`.`name` AS `DIAGNOSIS_DESC`,`provider`.`full_name` AS `HOSPITAL`,`his-tpa`.`case`.`other_provider` AS `OTHER_HOSPITAL`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `TYPE`,`his-tpa`.`case`.`admission_date` AS `ADMISSION_DATE`,cast(`his-tpa`.`case`.`discharge_date` as date) AS `DISCHARGE_DATE`,`his-tpa`.`country`.`name` AS `CURRENCY_01`,`his-tpa`.`country`.`name` AS `CURRENCY_02`,`his-tpa`.`worksheet_01`.`actual` AS `TOTAL_AMOUNT_INCURRED`,`his-tpa`.`worksheet_01`.`cover` AS `TOTAL_AMOUNT_APPROVED`,`his-tpa`.`worksheet_01`.`excess` AS `TOTAL_AMOUNT_NOT_APPROVED`,cast(`his-tpa`.`case`.`payment_date` as date) AS `PAYMENT_DATE`,'Paid' AS `Status`,`his-tpa`.`case_status`.`name` AS `CASE_STATUS`,`his-tpa`.`worksheet_01`.`remarks` AS `REMARKS` from ((((((((((((((`his-tpa`.`case` left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`worksheet_01` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet_01`.`case`)) join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet_01`.`header` = `his-tpa`.`plan_header`.`id`)) join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet_01`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`issue_log` = 2 and `his-tpa`.`case`.`issue_log_option` in (1,2) group by `his-tpa`.`worksheet_01`.`id` ;

-- ----------------------------
-- View structure for payment_claim_header
-- ----------------------------
DROP VIEW IF EXISTS `payment_claim_header`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `payment_claim_header` AS select coalesce(`his-tpa`.`case`.`create_date_01`,`his-tpa`.`case`.`create_date`) AS `RECEIVED_DATE`,`client`.`id` AS `CLIENT_ID`,`client`.`full_name` AS `CLIENT_NAME`,`his-tpa`.`case`.`policy_no` AS `POLICY_NO`,`his-tpa`.`case`.`policy_effective_date` AS `POLICY_EFFECTIVE_DATE`,`his-tpa`.`case`.`policy_expiry_date` AS `POLICY_EXPIRY_DATE`,case `his-tpa`.`case`.`policy_status` when 0 then 'Disable' when 1 then 'Enable' else 'N/A' end AS `POLICY_STATUS`,`his-tpa`.`case`.`member_id` AS `MEMBER_ID`,`his-tpa`.`case`.`member_card` AS `MEMBER_CARD`,`his-tpa`.`program`.`name` AS `PROGRAM`,`his-tpa`.`plan`.`name` AS `PLAN`,`his-tpa`.`case`.`rider` AS `RIDER`,`his-tpa`.`company`.`name` AS `COMPANY`,`his-tpa`.`case`.`policy_holder` AS `PRINCIPLE`,`his-tpa`.`member`.`member_name` AS `PATIENT`,case `his-tpa`.`case`.`relation` when 1 then 'Principle' when 2 then 'Spouse' when 3 then 'Child' when 4 then 'Dependant' else 'N/A' end AS `RELATION`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `GENDER`,`his-tpa`.`case`.`id` AS `CASE_ID`,`his-tpa`.`case`.`admission_date` AS `ADMISSION_DATE`,cast(`his-tpa`.`case`.`discharge_date` as date) AS `DISCHARGE_DATE`,`his-tpa`.`diagnosis`.`code` AS `DIAGNOSIS_CODE`,`his-tpa`.`diagnosis`.`name` AS `DIAGNOSIS_DESC`,`provider`.`full_name` AS `HOSPITAL`,`his-tpa`.`case`.`other_provider` AS `OTHER_HOSPITAL`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `CATEGORY`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `TYPE`,`his-tpa`.`country`.`name` AS `CURRENCY_01`,`his-tpa`.`country`.`name` AS `CURRENCY_02`,(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `ACTUAL`,(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `COVER`,(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `EXCESS`,cast(`his-tpa`.`case`.`original_bill_upload_date` as date) AS `DOC_RECEIVE_DATE`,cast(`his-tpa`.`case`.`log_issue_date` as date) AS `PROCESS_DATE`,cast(`his-tpa`.`case`.`original_bill_checked_date` + interval 1 day as date) AS `SUBMIT_APPROVAL_DATE`,cast(`his-tpa`.`case`.`original_bill_verified_date` as date) AS `APPROVAL_DATE_FROM_CLIENT`,cast(`his-tpa`.`case`.`payment_date` as date) AS `PAYMENT_DATE`,`his-tpa`.`country`.`name` AS `BRANCH`,`his-tpa`.`case`.`created_by` AS `CREATED_BY`,`his-tpa`.`case_status`.`name` AS `CASE_STATUS`,`his-tpa`.`case`.`ref` AS `REF` from ((((((((((((((`his-tpa`.`case` left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`client` <> 8 and `his-tpa`.`case`.`issue_log` = 2 and `his-tpa`.`case`.`status` not in (99,96) group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for payment_claim_header_fullcover
-- ----------------------------
DROP VIEW IF EXISTS `payment_claim_header_fullcover`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `payment_claim_header_fullcover` AS select coalesce(`his-tpa`.`case`.`create_date_01`,`his-tpa`.`case`.`create_date`) AS `RECEIVED_DATE`,`client`.`id` AS `CLIENT_ID`,`client`.`full_name` AS `CLIENT_NAME`,`his-tpa`.`case`.`policy_no` AS `POLICY_NO`,`his-tpa`.`case`.`policy_effective_date` AS `POLICY_EFFECTIVE_DATE`,`his-tpa`.`case`.`policy_expiry_date` AS `POLICY_EXPIRY_DATE`,case `his-tpa`.`case`.`policy_status` when 0 then 'Disable' when 1 then 'Enable' else 'N/A' end AS `POLICY_STATUS`,`his-tpa`.`case`.`member_id` AS `MEMBER_ID`,`his-tpa`.`case`.`member_card` AS `MEMBER_CARD`,`his-tpa`.`program`.`name` AS `PROGRAM`,`his-tpa`.`plan`.`name` AS `PLAN`,`his-tpa`.`case`.`rider` AS `RIDER`,`his-tpa`.`company`.`name` AS `COMPANY`,`his-tpa`.`case`.`policy_holder` AS `PRINCIPLE`,`his-tpa`.`member`.`member_name` AS `PATIENT`,case `his-tpa`.`case`.`relation` when 1 then 'Principle' when 2 then 'Spouse' when 3 then 'Child' when 4 then 'Dependant' else 'N/A' end AS `RELATION`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `GENDER`,`his-tpa`.`case`.`id` AS `CASE_ID`,`his-tpa`.`case`.`admission_date` AS `ADMISSION_DATE`,cast(`his-tpa`.`case`.`discharge_date` as date) AS `DISCHARGE_DATE`,`his-tpa`.`diagnosis`.`code` AS `DIAGNOSIS_CODE`,`his-tpa`.`diagnosis`.`name` AS `DIAGNOSIS_DESC`,`provider`.`full_name` AS `HOSPITAL`,`his-tpa`.`case`.`other_provider` AS `OTHER_HOSPITAL`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `CATEGORY`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `TYPE`,`his-tpa`.`country`.`name` AS `CURRENCY_01`,`his-tpa`.`country`.`name` AS `CURRENCY_02`,(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `ACTUAL`,(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `COVER`,(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `EXCESS`,cast(`his-tpa`.`case`.`original_bill_upload_date` as date) AS `DOC_RECEIVE_DATE`,cast(`his-tpa`.`case`.`log_issue_date` as date) AS `PROCESS_DATE`,cast(`his-tpa`.`case`.`original_bill_checked_date` + interval 1 day as date) AS `SUBMIT_APPROVAL_DATE`,cast(`his-tpa`.`case`.`original_bill_verified_date` as date) AS `APPROVAL_DATE_FROM_CLIENT`,cast(`his-tpa`.`case`.`payment_date` as date) AS `PAYMENT_DATE`,`his-tpa`.`country`.`name` AS `BRANCH`,`his-tpa`.`case`.`created_by` AS `CREATED_BY`,`his-tpa`.`case_status`.`name` AS `CASE_STATUS`,`his-tpa`.`case`.`ref` AS `REF` from ((((((((((((((`his-tpa`.`case` left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`issue_log` = 2 and `his-tpa`.`case`.`issue_log_option` in (1,2) group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for process_claim
-- ----------------------------
DROP VIEW IF EXISTS `process_claim`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `process_claim` AS select coalesce(`his-tpa`.`case`.`create_date_01`,`his-tpa`.`case`.`create_date`) AS `RECEIVED_DATE`,`client`.`id` AS `CLIENT_ID`,`client`.`full_name` AS `CLIENT_NAME`,`his-tpa`.`case`.`policy_no` AS `POLICY_NO`,`his-tpa`.`case`.`policy_effective_date` AS `POLICY_EFFECTIVE_DATE`,`his-tpa`.`case`.`policy_expiry_date` AS `POLICY_EXPIRY_DATE`,case `his-tpa`.`case`.`policy_status` when 0 then 'Disable' when 1 then 'Enable' else 'N/A' end AS `POLICY_STATUS`,`his-tpa`.`case`.`member_id` AS `MEMBER_ID`,`his-tpa`.`case`.`member_card` AS `MEMBER_CARD`,`his-tpa`.`program`.`name` AS `PROGRAM`,`his-tpa`.`plan`.`name` AS `PLAN`,`his-tpa`.`case`.`rider` AS `RIDER`,`his-tpa`.`company`.`name` AS `COMPANY_NAME`,`his-tpa`.`case`.`policy_holder` AS `PRINCIPLE`,`his-tpa`.`member`.`member_name` AS `PATIENT`,case `his-tpa`.`case`.`relation` when 1 then 'Principle' when 2 then 'Spouse' when 3 then 'Child' when 4 then 'Dependant' else 'N/A' end AS `RELATION`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `GENDER`,`his-tpa`.`case`.`id` AS `CASE_ID`,`his-tpa`.`case`.`admission_date` AS `ADMISSION_DATE`,cast(`his-tpa`.`case`.`discharge_date` as date) AS `DISCHARGE_DATE`,`his-tpa`.`diagnosis`.`code` AS `DIAGNOSIS_CODE`,`his-tpa`.`diagnosis`.`name` AS `DIAGNOSIS_DESC`,`provider`.`full_name` AS `HOSPITAL`,`his-tpa`.`case`.`other_provider` AS `OTHER_HOSPITAL`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `CATEGORY`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `TYPE`,`his-tpa`.`country`.`name` AS `CURRENCY_01`,`his-tpa`.`country`.`name` AS `CURRENCY_02`,(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `actual`,(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `cover`,(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) AS `excess`,cast(`his-tpa`.`case`.`original_bill_upload_date` as date) AS `DOC_RECEIVE_DATE`,cast(`his-tpa`.`case`.`log_issue_date` as date) AS `PROCESS_DATE`,`his-tpa`.`country`.`name` AS `BRANCH`,`his-tpa`.`case`.`created_by` AS `CREATED_BY`,`his-tpa`.`case_status`.`name` AS `CASE_STATUS`,`his-tpa`.`case`.`ref` AS `REF` from ((((((((((((((`his-tpa`.`case` left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` not in (30,31,32,98,99) and `his-tpa`.`case`.`status` in (1,2,3,4,5,6,7,8,9,10,11,12,13,14,19,20,21,22,23,24,25) and `his-tpa`.`case`.`payment_date` is null group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for program_provider_inpatient_aso
-- ----------------------------
DROP VIEW IF EXISTS `program_provider_inpatient_aso`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `program_provider_inpatient_aso` AS select `his-tpa`.`program`.`id` AS `id`,`his-tpa`.`program`.`name` AS `name`,`his-tpa`.`program`.`provider_01` AS `provider_01` from `his-tpa`.`program` where `his-tpa`.`program`.`id` = 64 ;

-- ----------------------------
-- View structure for program_provider_outpatient_aso
-- ----------------------------
DROP VIEW IF EXISTS `program_provider_outpatient_aso`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `program_provider_outpatient_aso` AS select `his-tpa`.`program`.`id` AS `id`,`his-tpa`.`program`.`name` AS `name`,`his-tpa`.`program`.`provider` AS `provider` from `his-tpa`.`program` where `his-tpa`.`program`.`id` = 64 ;

-- ----------------------------
-- View structure for provider
-- ----------------------------
DROP VIEW IF EXISTS `provider`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `provider` AS select `provider`.`id` AS `id`,`provider`.`status` AS `status`,`provider`.`full_name` AS `full_name`,`provider`.`abbreviation_name` AS `abbreviation_name`,`provider`.`ranking` AS `ranking`,`provider`.`pks_no` AS `pks_no`,`provider`.`type` AS `type`,`provider`.`service` AS `service`,`provider`.`24_hours` AS `24_hours`,`provider`.`discount` AS `discount`,`provider`.`penalty` AS `penalty`,`provider`.`payment_turnaround_day` AS `payment_turnaround_day`,`provider`.`invoice_expiry_day` AS `invoice_expiry_day`,`provider`.`area_code` AS `area_code`,`provider`.`address` AS `address`,`provider`.`city` AS `city`,`provider`.`province` AS `province`,`provider`.`country` AS `country`,`provider`.`postal` AS `postal`,`provider`.`phone` AS `phone`,`provider`.`fax` AS `fax`,`provider`.`email` AS `email`,`provider`.`website` AS `website`,`provider`.`bank` AS `bank`,`provider`.`location` AS `location`,`provider`.`account_no` AS `account_no`,`provider`.`on_behalf_of` AS `on_behalf_of`,`provider`.`created_by` AS `created_by`,`provider`.`create_date` AS `create_date`,`provider`.`edited_by` AS `edited_by`,`provider`.`edit_date` AS `edit_date`,`provider`.`latitude` AS `latitude`,`provider`.`longitude` AS `longitude`,`provider`.`name_of_assistance_company` AS `name_of_assistance_company`,`provider`.`phone_of_assistance_company` AS `phone_of_assistance_company`,`provider`.`pic_of_assistance_company` AS `pic_of_assistance_company`,`provider`.`category` AS `category`,`provider`.`account_no_01` AS `account_no_01` from `his-tpa`.`provider` ;

-- ----------------------------
-- View structure for provider_01
-- ----------------------------
DROP VIEW IF EXISTS `provider_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `provider_01` AS select `provider`.`id` AS `id`,`provider`.`id_edc` AS `id_edc`,`provider`.`abbreviation_name` AS `abbreviation_name`,`provider`.`full_name` AS `full_name`,`provider`.`address` AS `address`,`provider`.`city` AS `city`,`provider`.`province` AS `province`,100 AS `height` from `his-tpa`.`provider` ;

-- ----------------------------
-- View structure for qc_document_initial_inpatient
-- ----------------------------
DROP VIEW IF EXISTS `qc_document_initial_inpatient`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `qc_document_initial_inpatient` AS select date_format(`guarantee_cashless_inpatient`.`create_date`,'%Y') AS `years`,date_format(`guarantee_cashless_inpatient`.`create_date`,'%M') AS `month`,`guarantee_cashless_inpatient`.`client` AS `client`,`guarantee_cashless_inpatient`.`Document_InitialLOG_Hours` AS `Document_InitialLOG_Hours`,`guarantee_cashless_inpatient`.`ProviderDomicile` AS `ProviderDomicile`,sum(if(`guarantee_cashless_inpatient`.`ProviderDomicile` = 'Domestic',1,0)) AS `Domestic`,sum(if(`guarantee_cashless_inpatient`.`ProviderDomicile` = 'Overseas',1,0)) AS `Overseas` from `her-tpa`.`guarantee_cashless_inpatient` where `guarantee_cashless_inpatient`.`status_01` not in (1,2) group by date_format(`guarantee_cashless_inpatient`.`create_date`,'%Y'),date_format(`guarantee_cashless_inpatient`.`create_date`,'%m'),`guarantee_cashless_inpatient`.`Document_InitialLOG_Hours`,`guarantee_cashless_inpatient`.`client`,`guarantee_cashless_inpatient`.`ProviderDomicile` order by NULL ;

-- ----------------------------
-- View structure for qc_document_initial_log
-- ----------------------------
DROP VIEW IF EXISTS `qc_document_initial_log`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `qc_document_initial_log` AS select date_format(`guarantee_cashless_inpatient`.`create_date`,'%Y') AS `years`,date_format(`guarantee_cashless_inpatient`.`create_date`,'%M') AS `month`,`guarantee_cashless_inpatient`.`client` AS `client`,`guarantee_cashless_inpatient`.`ProviderDomicile` AS `ProviderDomicile`,sum(if(`guarantee_cashless_inpatient`.`ProviderDomicile` = 'Domestic',1,0)) AS `Domestic`,sum(if(`guarantee_cashless_inpatient`.`ProviderDomicile` = 'Overseas',1,0)) AS `Overseas`,`guarantee_cashless_inpatient`.`Initial_LOG_Minutes` AS `Initial_LOG_Minutes` from `her-tpa`.`guarantee_cashless_inpatient` where `guarantee_cashless_inpatient`.`status_01` not in (1,2,3) group by date_format(`guarantee_cashless_inpatient`.`create_date`,'%Y'),date_format(`guarantee_cashless_inpatient`.`create_date`,'%m'),`guarantee_cashless_inpatient`.`Document_InitialLOG_Hours`,`guarantee_cashless_inpatient`.`client`,`guarantee_cashless_inpatient`.`ProviderDomicile` order by NULL ;

-- ----------------------------
-- View structure for reimbursement_case_tat
-- ----------------------------
DROP VIEW IF EXISTS `reimbursement_case_tat`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `reimbursement_case_tat` AS select `his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`member`.`member_name` AS `patient`,cast(`his-tpa`.`member`.`member_dob` as datetime) AS `dob`,`his-tpa`.`member`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,`provider`.`full_name` AS `provider`,cast(`his-tpa`.`case`.`create_date` as date) AS `create_date`,cast(`his-tpa`.`case`.`original_bill_upload_date` as date) AS `original_bill_upload_date`,cast(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) as datetime) AS `admission_date`,'' AS `target_01`,'' AS `tat_01`,cast(`his-tpa`.`case`.`discharge_date` as datetime) AS `discharge_date`,'' AS `target_02`,'' AS `tat_02`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `ws_process_finished_date`,'00:30:00' AS `target_03`,coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') AS `tat_03`,cast(`his-tpa`.`case`.`ws_approval_date` as datetime) AS `ws_process_approved_date`,'00:20:00' AS `target_04`,coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'N/A') AS `tat_04`,cast(`activity_log_status_24`.`datetime` as datetime) AS `ws_revise_finished_date`,'00:15:00' AS `target_05`,coalesce(timediff(`activity_log_status_24`.`datetime`,`activity_log_status_23`.`datetime`),'N/A') AS `tat_05`,cast(`activity_log_status_25`.`datetime` as datetime) AS `ws_revise_approved_date`,'00:15:00' AS `target_06`,coalesce(timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`),'N/A') AS `tat_06`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `original_bill_checked_date`,`his-tpa`.`case`.`original_bill_checked_by` AS `pic_07`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `date_07`,'00:35:00' AS `target_07`,coalesce(addtime(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`)),'N/A') AS `tat_07`,coalesce(if(timediff('288:00:00',addtime(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`))) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_07`,cast(`his-tpa`.`case`.`original_bill_verified_date` as datetime) AS `original_bill_verified_date`,'00:15:00' AS `target_08`,coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,coalesce(`activity_log_status_25`.`datetime`,`his-tpa`.`case`.`ws_approval_date`)),'N/A') AS `tat_08`,cast(`his-tpa`.`case`.`payment_date` as datetime) AS `payment_date`,'00:15:00' AS `target_09`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'N/A') AS `tat_09`,coalesce(addtime(addtime(addtime(coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'00:00:00')),addtime(coalesce(timediff(`activity_log_status_24`.`datetime`,`activity_log_status_23`.`datetime`),'00:00:00'),coalesce(timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`),'00:00:00'))),addtime(addtime(coalesce(addtime(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`)),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,coalesce(`activity_log_status_25`.`datetime`,`his-tpa`.`case`.`ws_approval_date`)),'00:00:00')),coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'00:00:00'))),'N/A') AS `total_tat`,`his-tpa`.`case`.`ws_finished_by` AS `pic_10`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `date_10`,'288:00:00' AS `target_10`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,coalesce(`activity_log_status_23`.`datetime`,`his-tpa`.`case`.`ws_finished_date`)),'N/A') AS `tat_10`,coalesce(if(timediff('288:00:00',timediff(`his-tpa`.`case`.`payment_date`,coalesce(`activity_log_status_23`.`datetime`,`his-tpa`.`case`.`ws_finished_date`))) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_10` from (((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `her-tpa`.`activity_log_status_23` on(`his-tpa`.`case`.`id` = `activity_log_status_23`.`case`)) left join `her-tpa`.`activity_log_status_24` on(`his-tpa`.`case`.`id` = `activity_log_status_24`.`case`)) left join `her-tpa`.`activity_log_status_25` on(`his-tpa`.`case`.`id` = `activity_log_status_25`.`case`)) left join `her-tpa`.`activity_log_status_15` on(`his-tpa`.`case`.`id` = `activity_log_status_15`.`case`)) where `his-tpa`.`case`.`type` <> 2 and `his-tpa`.`case`.`status` not in (99,98,32,31) ;

-- ----------------------------
-- View structure for reimbursement_case_tat_01
-- ----------------------------
DROP VIEW IF EXISTS `reimbursement_case_tat_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `reimbursement_case_tat_01` AS select `his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`category` = 0,'Outpatient',if(`his-tpa`.`case`.`category` = 1,'Inpatient','ERROR')) AS `category`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`member`.`member_dob` AS `dob`,`his-tpa`.`member`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,`provider`.`full_name` AS `provider`,cast(`his-tpa`.`case`.`create_date` as datetime) AS `create_date`,cast(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) as datetime) AS `admission_date`,cast(`his-tpa`.`case`.`discharge_date` as datetime) AS `discharge_date`,`his-tpa`.`case`.`created_by` AS `pic_01a`,`his-tpa`.`case`.`log_issued_by` AS `pic_01b`,cast(`his-tpa`.`case`.`create_date` as datetime) AS `date_01a`,cast(`his-tpa`.`case`.`log_issue_date` as datetime) AS `date_01b`,'3' AS `target_01`,coalesce(`getworkingday`(`his-tpa`.`case`.`create_date`,`his-tpa`.`case`.`log_issue_date`,'work_days'),'N/A') AS `tat_01`,if(coalesce(`getworkingday`(`his-tpa`.`case`.`create_date`,`his-tpa`.`case`.`log_issue_date`,'work_days'),'N/A') = 'N/A','N/A',if(coalesce(`getworkingday`(`his-tpa`.`case`.`create_date`,`his-tpa`.`case`.`log_issue_date`,'work_days'),'N/A') > 5,'Not Achieved',if(coalesce(`getworkingday`(`his-tpa`.`case`.`create_date`,`his-tpa`.`case`.`log_issue_date`,'work_days'),'N/A') < 5,'Achieved','ERROR'))) AS `achievement_01`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `pic_02a`,`his-tpa`.`case`.`log_issued_by` AS `pic_02b`,cast(`his-tpa`.`case`.`original_bill_upload_date` as datetime) AS `date_02a`,cast(`his-tpa`.`case`.`log_issue_date` as datetime) AS `date_02b`,'3' AS `target_02`,coalesce(`getworkingday`(`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`log_issue_date`,'work_days'),'N/A') AS `tat_02`,if(coalesce(`getworkingday`(`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`log_issue_date`,'work_days'),'N/A') = 'N/A','N/A',if(coalesce(`getworkingday`(`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`log_issue_date`,'work_days'),'N/A') > 5,'Not Achieved',if(coalesce(`getworkingday`(`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`log_issue_date`,'work_days'),'N/A') < 5,'Achieved','ERROR'))) AS `achievement_02`,if(`his-tpa`.`case`.`is_clean` = 0,'No',if(`his-tpa`.`case`.`is_clean` = 1,'Yes','ERROR')) AS `is_clean` from (((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) where `his-tpa`.`case`.`type` <> 2 and `his-tpa`.`case`.`status` not in (99,98,32,31) and `his-tpa`.`case`.`ws_approval` = 3 ;

-- ----------------------------
-- View structure for reimbursement_case_tat_period
-- ----------------------------
DROP VIEW IF EXISTS `reimbursement_case_tat_period`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `reimbursement_case_tat_period` AS select `his-tpa`.`case`.`id` AS `case`,`his-tpa`.`member`.`member_name` AS `patient`,cast(`his-tpa`.`member`.`member_dob` as datetime) AS `dob`,`his-tpa`.`member`.`policy_no` AS `policy_no`,`client`.`full_name` AS `client`,`provider`.`full_name` AS `provider`,cast(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) as datetime) AS `admission_date`,'' AS `target_01`,'' AS `tat_01`,cast(`his-tpa`.`case`.`discharge_date` as datetime) AS `discharge_date`,'' AS `target_02`,'' AS `tat_02`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `ws_process_finished_date`,'00:30:00' AS `target_03`,coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'N/A') AS `tat_03`,cast(`his-tpa`.`case`.`ws_approval_date` as datetime) AS `ws_process_approved_date`,'00:20:00' AS `target_04`,coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'N/A') AS `tat_04`,cast(`activity_log_status_24`.`datetime` as datetime) AS `ws_revise_finished_date`,'00:15:00' AS `target_05`,coalesce(timediff(`activity_log_status_24`.`datetime`,`activity_log_status_23`.`datetime`),'N/A') AS `tat_05`,cast(`activity_log_status_25`.`datetime` as datetime) AS `ws_revise_approved_date`,'00:15:00' AS `target_06`,coalesce(timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`),'N/A') AS `tat_06`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `original_bill_checked_date`,`his-tpa`.`case`.`original_bill_checked_by` AS `pic_07`,cast(`his-tpa`.`case`.`original_bill_checked_date` as datetime) AS `date_07`,'00:35:00' AS `target_07`,coalesce(addtime(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`)),'N/A') AS `tat_07`,coalesce(if(timediff('288:00:00',addtime(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`))) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_07`,cast(`his-tpa`.`case`.`original_bill_verified_date` as datetime) AS `original_bill_verified_date`,'00:15:00' AS `target_08`,coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,coalesce(`activity_log_status_25`.`datetime`,`his-tpa`.`case`.`ws_approval_date`)),'N/A') AS `tat_08`,cast(`his-tpa`.`case`.`payment_date` as datetime) AS `payment_date`,'00:15:00' AS `target_09`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'N/A') AS `tat_09`,coalesce(addtime(addtime(addtime(coalesce(timediff(`his-tpa`.`case`.`ws_finished_date`,`his-tpa`.`case`.`bill_completed_date`),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),'00:00:00')),addtime(coalesce(timediff(`activity_log_status_24`.`datetime`,`activity_log_status_23`.`datetime`),'00:00:00'),coalesce(timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`),'00:00:00'))),addtime(addtime(coalesce(addtime(timediff(`his-tpa`.`case`.`ws_approval_date`,`his-tpa`.`case`.`ws_finished_date`),timediff(`activity_log_status_25`.`datetime`,`activity_log_status_24`.`datetime`)),'00:00:00'),coalesce(timediff(`his-tpa`.`case`.`original_bill_verified_date`,coalesce(`activity_log_status_25`.`datetime`,`his-tpa`.`case`.`ws_approval_date`)),'00:00:00')),coalesce(timediff(`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`original_bill_verified_date`),'00:00:00'))),'N/A') AS `total_tat`,`his-tpa`.`case`.`ws_finished_by` AS `pic_10`,cast(`his-tpa`.`case`.`ws_finished_date` as datetime) AS `date_10`,'288:00:00' AS `target_10`,coalesce(timediff(`his-tpa`.`case`.`payment_date`,coalesce(`activity_log_status_23`.`datetime`,`his-tpa`.`case`.`ws_finished_date`)),'N/A') AS `tat_10`,coalesce(if(timediff('288:00:00',timediff(`his-tpa`.`case`.`payment_date`,coalesce(`activity_log_status_23`.`datetime`,`his-tpa`.`case`.`ws_finished_date`))) < 0,'Not Achieved','Achieved'),'N/A') AS `achievement_10` from (((((((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `her-tpa`.`activity_log_status_23` on(`his-tpa`.`case`.`id` = `activity_log_status_23`.`case`)) left join `her-tpa`.`activity_log_status_24` on(`his-tpa`.`case`.`id` = `activity_log_status_24`.`case`)) left join `her-tpa`.`activity_log_status_25` on(`his-tpa`.`case`.`id` = `activity_log_status_25`.`case`)) left join `her-tpa`.`activity_log_status_15` on(`his-tpa`.`case`.`id` = `activity_log_status_15`.`case`)) where `his-tpa`.`case`.`type` <> 2 and `his-tpa`.`case`.`status` not in (99,98,97,32,31) and year(`his-tpa`.`case`.`create_date`) = 2016 and month(`his-tpa`.`case`.`create_date`) in (2,3) ;

-- ----------------------------
-- View structure for reimbursement_original_bill_checked_productivity
-- ----------------------------
DROP VIEW IF EXISTS `reimbursement_original_bill_checked_productivity`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `reimbursement_original_bill_checked_productivity` AS select `reimbursement_case_tat`.`pic_07` AS `pic_07`,cast(`reimbursement_case_tat`.`date_07` as date) AS `date_07`,`reimbursement_case_tat`.`achievement_07` AS `achievement_07`,count(`reimbursement_case_tat`.`case`) AS `case_count` from `her-tpa`.`reimbursement_case_tat` where `reimbursement_case_tat`.`pic_07` <> '' group by `reimbursement_case_tat`.`pic_07`,date_format(`reimbursement_case_tat`.`date_07`,'%d/%m/%Y'),`reimbursement_case_tat`.`achievement_07` ;

-- ----------------------------
-- View structure for reimbursement_original_bill_productivity
-- ----------------------------
DROP VIEW IF EXISTS `reimbursement_original_bill_productivity`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `reimbursement_original_bill_productivity` AS select `reimbursement_case_tat`.`pic_10` AS `pic_10`,cast(`reimbursement_case_tat`.`date_10` as date) AS `date_10`,`reimbursement_case_tat`.`achievement_10` AS `achievement_10`,count(`reimbursement_case_tat`.`case`) AS `case_count` from `her-tpa`.`reimbursement_case_tat` where `reimbursement_case_tat`.`pic_10` <> '' group by `reimbursement_case_tat`.`pic_10`,date_format(`reimbursement_case_tat`.`date_10`,'%d/%m/%Y'),`reimbursement_case_tat`.`achievement_10` ;

-- ----------------------------
-- View structure for report_guarantee_cashless_inpatient
-- ----------------------------
DROP VIEW IF EXISTS `report_guarantee_cashless_inpatient`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `report_guarantee_cashless_inpatient` AS select `guarantee_cashless_inpatient`.`id` AS `id`,`guarantee_cashless_inpatient`.`created_by` AS `created_by`,`guarantee_cashless_inpatient`.`create_date` AS `create_date`,`guarantee_cashless_inpatient`.`DocReceieveDate` AS `DocReceieveDate`,`guarantee_cashless_inpatient`.`status` AS `status`,`guarantee_cashless_inpatient`.`Source` AS `Source`,`guarantee_cashless_inpatient`.`category` AS `category`,`guarantee_cashless_inpatient`.`type` AS `type`,`guarantee_cashless_inpatient`.`ref` AS `ref`,`guarantee_cashless_inpatient`.`member_name` AS `member_name`,`guarantee_cashless_inpatient`.`dob` AS `dob`,`guarantee_cashless_inpatient`.`gender` AS `gender`,`guarantee_cashless_inpatient`.`member_id` AS `member_id`,`guarantee_cashless_inpatient`.`member_card` AS `member_card`,`guarantee_cashless_inpatient`.`relation` AS `relation`,`guarantee_cashless_inpatient`.`client` AS `client`,`guarantee_cashless_inpatient`.`branch` AS `branch`,`guarantee_cashless_inpatient`.`company` AS `company`,`guarantee_cashless_inpatient`.`DEPARTMENT` AS `DEPARTMENT`,`guarantee_cashless_inpatient`.`policy_status` AS `policy_status`,`guarantee_cashless_inpatient`.`policy_no` AS `policy_no`,`guarantee_cashless_inpatient`.`policy_holder` AS `policy_holder`,`guarantee_cashless_inpatient`.`policy_effective_date` AS `policy_effective_date`,`guarantee_cashless_inpatient`.`policy_expiry_date` AS `policy_expiry_date`,`guarantee_cashless_inpatient`.`policy_issue_date` AS `policy_issue_date`,`guarantee_cashless_inpatient`.`policy_declare_date` AS `policy_declare_date`,`guarantee_cashless_inpatient`.`policy_lapse_date` AS `policy_lapse_date`,`guarantee_cashless_inpatient`.`policy_revival_date` AS `policy_revival_date`,`guarantee_cashless_inpatient`.`policy_termination_date` AS `policy_termination_date`,`guarantee_cashless_inpatient`.`special_condition` AS `special_condition`,`guarantee_cashless_inpatient`.`program` AS `program`,`guarantee_cashless_inpatient`.`plan` AS `plan`,`guarantee_cashless_inpatient`.`plan_external` AS `plan_external`,`guarantee_cashless_inpatient`.`plan_attach_date` AS `plan_attach_date`,`guarantee_cashless_inpatient`.`plan_expiry_date` AS `plan_expiry_date`,`guarantee_cashless_inpatient`.`rider` AS `rider`,`guarantee_cashless_inpatient`.`rider_attach_date` AS `rider_attach_date`,`guarantee_cashless_inpatient`.`rider_expiry_date` AS `rider_expiry_date`,`guarantee_cashless_inpatient`.`provider` AS `provider`,`guarantee_cashless_inpatient`.`city` AS `city`,`guarantee_cashless_inpatient`.`counttr` AS `counttr`,`guarantee_cashless_inpatient`.`ProviderDomicile` AS `ProviderDomicile`,`guarantee_cashless_inpatient`.`other_provider` AS `other_provider`,`guarantee_cashless_inpatient`.`admission_date` AS `admission_date`,`guarantee_cashless_inpatient`.`admission_time` AS `admission_time`,`guarantee_cashless_inpatient`.`admission_doctor` AS `admission_doctor`,`guarantee_cashless_inpatient`.`symptom` AS `symptom`,`guarantee_cashless_inpatient`.`symptom_since` AS `symptom_since`,`guarantee_cashless_inpatient`.`vital_sign` AS `vital_sign`,`guarantee_cashless_inpatient`.`initial_diagnosis` AS `initial_diagnosis`,`guarantee_cashless_inpatient`.`treatment_plan` AS `treatment_plan`,`guarantee_cashless_inpatient`.`upload_haf` AS `upload_haf`,`guarantee_cashless_inpatient`.`haf_uploaded_by` AS `haf_uploaded_by`,`guarantee_cashless_inpatient`.`haf_upload_date` AS `haf_upload_date`,`guarantee_cashless_inpatient`.`upload_doc` AS `upload_doc`,`guarantee_cashless_inpatient`.`doc_uploaded_by` AS `doc_uploaded_by`,`guarantee_cashless_inpatient`.`doc_upload_date` AS `doc_upload_date`,`guarantee_cashless_inpatient`.`upload_haf_doc_finished` AS `upload_haf_doc_finished`,`guarantee_cashless_inpatient`.`upload_haf_doc_finished_by` AS `upload_haf_doc_finished_by`,`guarantee_cashless_inpatient`.`upload_haf_doc_finished_date` AS `upload_haf_doc_finished_date`,`guarantee_cashless_inpatient`.`haf_doc_completed` AS `haf_doc_completed`,`guarantee_cashless_inpatient`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`guarantee_cashless_inpatient`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`guarantee_cashless_inpatient`.`haf_doc_completed_date` AS `haf_doc_completed_date`,`guarantee_cashless_inpatient`.`issue_initial_log` AS `issue_initial_log`,`guarantee_cashless_inpatient`.`initial_log_issued_by` AS `initial_log_issued_by`,`guarantee_cashless_inpatient`.`initial_log_issue_date` AS `initial_log_issue_date`,`guarantee_cashless_inpatient`.`initial_claim_no` AS `initial_claim_no`,`guarantee_cashless_inpatient`.`initial_log_remarks` AS `initial_log_remarks`,`guarantee_cashless_inpatient`.`initial_log_approval` AS `initial_log_approval`,`guarantee_cashless_inpatient`.`discharge_date` AS `discharge_date`,`guarantee_cashless_inpatient`.`discharge_plan` AS `discharge_plan`,`guarantee_cashless_inpatient`.`discharge_doctor` AS `discharge_doctor`,`guarantee_cashless_inpatient`.`actual_treatment` AS `actual_treatment`,`guarantee_cashless_inpatient`.`diagnosis` AS `diagnosis`,`guarantee_cashless_inpatient`.`other_diagnosis` AS `other_diagnosis`,`guarantee_cashless_inpatient`.`exclusion` AS `exclusion`,`guarantee_cashless_inpatient`.`bill_received` AS `bill_received`,`guarantee_cashless_inpatient`.`bill_received_by` AS `bill_received_by`,`guarantee_cashless_inpatient`.`bill_received_date` AS `bill_received_date`,`guarantee_cashless_inpatient`.`upload_bill` AS `upload_bill`,`guarantee_cashless_inpatient`.`bill_uploaded_by` AS `bill_uploaded_by`,`guarantee_cashless_inpatient`.`bill_upload_date` AS `bill_upload_date`,`guarantee_cashless_inpatient`.`upload_bill_finished_by` AS `upload_bill_finished_by`,`guarantee_cashless_inpatient`.`upload_bill_finished_date` AS `upload_bill_finished_date`,`guarantee_cashless_inpatient`.`upload_bill_finished` AS `upload_bill_finished`,`guarantee_cashless_inpatient`.`bill_completed` AS `bill_completed`,`guarantee_cashless_inpatient`.`bill_completed_remarks` AS `bill_completed_remarks`,`guarantee_cashless_inpatient`.`bill_completed_by` AS `bill_completed_by`,`guarantee_cashless_inpatient`.`bill_completed_date` AS `bill_completed_date`,`guarantee_cashless_inpatient`.`BillCompleteBy_M` AS `BillCompleteBy_M`,`guarantee_cashless_inpatient`.`BillCompleteDate_M` AS `BillCompleteDate_M`,`guarantee_cashless_inpatient`.`ws_type` AS `ws_type`,`guarantee_cashless_inpatient`.`ws_finished` AS `ws_finished`,`guarantee_cashless_inpatient`.`ws_finished_by` AS `ws_finished_by`,`guarantee_cashless_inpatient`.`ws_finished_date` AS `ws_finished_date`,`guarantee_cashless_inpatient`.`ws_approval` AS `ws_approval`,`guarantee_cashless_inpatient`.`ws_approval_remarks` AS `ws_approval_remarks`,`guarantee_cashless_inpatient`.`ws_approval_by` AS `ws_approval_by`,`guarantee_cashless_inpatient`.`ws_approval_date` AS `ws_approval_date`,`guarantee_cashless_inpatient`.`issuance_limit` AS `issuance_limit`,`guarantee_cashless_inpatient`.`issue_log` AS `issue_log`,`guarantee_cashless_inpatient`.`log_issued_by` AS `log_issued_by`,`guarantee_cashless_inpatient`.`log_issue_date` AS `log_issue_date`,`guarantee_cashless_inpatient`.`LogIssued_M` AS `LogIssued_M`,`guarantee_cashless_inpatient`.`LogIssueDate_M` AS `LogIssueDate_M`,`guarantee_cashless_inpatient`.`claim_no` AS `claim_no`,`guarantee_cashless_inpatient`.`log_remarks` AS `log_remarks`,`guarantee_cashless_inpatient`.`log_approval` AS `log_approval`,`guarantee_cashless_inpatient`.`nonlog_reason` AS `nonlog_reason`,`guarantee_cashless_inpatient`.`nonlog_remarks` AS `nonlog_remarks`,`guarantee_cashless_inpatient`.`reject_reason` AS `reject_reason`,`guarantee_cashless_inpatient`.`reject_remarks` AS `reject_remarks`,`guarantee_cashless_inpatient`.`bill_no` AS `bill_no`,`guarantee_cashless_inpatient`.`bill_issue_date` AS `bill_issue_date`,`guarantee_cashless_inpatient`.`bill_due_date` AS `bill_due_date`,`guarantee_cashless_inpatient`.`upload_original_bill` AS `upload_original_bill`,`guarantee_cashless_inpatient`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`guarantee_cashless_inpatient`.`original_bill_upload_date` AS `original_bill_upload_date`,`guarantee_cashless_inpatient`.`original_bill_checked` AS `original_bill_checked`,`guarantee_cashless_inpatient`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`guarantee_cashless_inpatient`.`original_bill_checked_by` AS `original_bill_checked_by`,`guarantee_cashless_inpatient`.`original_bill_checked_date` AS `original_bill_checked_date`,`guarantee_cashless_inpatient`.`close_case_option` AS `close_case_option`,`guarantee_cashless_inpatient`.`original_bill_verified` AS `original_bill_verified`,`guarantee_cashless_inpatient`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`guarantee_cashless_inpatient`.`original_bill_verified_by` AS `original_bill_verified_by`,`guarantee_cashless_inpatient`.`original_bill_verified_date` AS `original_bill_verified_date`,`guarantee_cashless_inpatient`.`payment_date` AS `payment_date`,`guarantee_cashless_inpatient`.`paid_by` AS `paid_by`,`guarantee_cashless_inpatient`.`upload_proof_of_payment` AS `upload_proof_of_payment`,`guarantee_cashless_inpatient`.`doc_send_back_to_client_required` AS `doc_send_back_to_client_required`,`guarantee_cashless_inpatient`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`guarantee_cashless_inpatient`.`doc_received_by_client_date` AS `doc_received_by_client_date`,`guarantee_cashless_inpatient`.`edited_by` AS `edited_by`,`guarantee_cashless_inpatient`.`edit_date` AS `edit_date`,`guarantee_cashless_inpatient`.`actual` AS `actual`,`guarantee_cashless_inpatient`.`cover` AS `cover`,`guarantee_cashless_inpatient`.`excess` AS `excess`,`guarantee_cashless_inpatient`.`BillReceieveDate` AS `BillReceieveDate`,`guarantee_cashless_inpatient`.`Document_InitialLOG_Hours` AS `Document_InitialLOG_Hours`,`guarantee_cashless_inpatient`.`Initial_LOG_Minutes` AS `Initial_LOG_Minutes`,`guarantee_cashless_inpatient`.`Provider_Discharge_Hours` AS `Provider_Discharge_Hours`,`guarantee_cashless_inpatient`.`Document_FinalLOG_Hours` AS `Document_FinalLOG_Hours`,`guarantee_cashless_inpatient`.`Final_LOG_Hours` AS `Final_LOG_Hours`,`guarantee_cashless_inpatient`.`Document_OB_Hosp_Days` AS `Document_OB_Hosp_Days`,`guarantee_cashless_inpatient`.`Document_OB_Days` AS `Document_OB_Days`,`guarantee_cashless_inpatient`.`Document_OBCheck_Days` AS `Document_OBCheck_Days`,`guarantee_cashless_inpatient`.`Document_OBVerified_Days` AS `Document_OBVerified_Days`,`guarantee_cashless_inpatient`.`Document_Payment_Days` AS `Document_Payment_Days`,`guarantee_cashless_inpatient`.`Document_Sendback_Days` AS `Document_Sendback_Days`,`guarantee_cashless_inpatient`.`Document_ClientReceive_Days` AS `Document_ClientReceive_Days`,`guarantee_cashless_inpatient`.`status_01` AS `status_01` from `his-tpa`.`guarantee_cashless_inpatient` ;

-- ----------------------------
-- View structure for report_guarantee_cashless_nonlog
-- ----------------------------
DROP VIEW IF EXISTS `report_guarantee_cashless_nonlog`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `report_guarantee_cashless_nonlog` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case`.`create_date_01` AS `DocReceieveDate`,`his-tpa`.`case_status`.`name` AS `status`,case `his-tpa`.`case`.`source` when 1 then 'Medisclick' when 2 then 'Medisclick' when 3 then 'eCentrix' when 4 then 'eReimbursement' when 5 then 'Hospital Portal' else 'Healthcare' end AS `Source`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `category`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `type`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`member`.`member_name` AS `member_name`,`his-tpa`.`case`.`dob` AS `dob`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `gender`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,case `his-tpa`.`case`.`relation` when 1 then 'Principle' when 2 then 'Spouse' when 3 then 'Child' when 4 then 'Dependant' else 'N/A' end AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`department`.`name` AS `DEPARTMENT`,case `his-tpa`.`case`.`policy_status` when 1 then 'Enable' when 0 then 'Disable' else 'N/A' end AS `policy_status`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_holder` AS `policy_holder`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`member`.`plan_external` AS `plan_external`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`rider`.`name` AS `rider`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,case `provider`.`full_name` when 'NON PARTICIPATING HOSPITAL' then concat(`his-tpa`.`case`.`other_provider`,' (Non Panel)') else `provider`.`full_name` end AS `provider`,`provider`.`city` AS `city`,`his-tpa`.`country`.`name` AS `counttr`,case `his-tpa`.`country`.`name` when 'Indonesia' then 'Domestic' else 'Overseas' end AS `ProviderDomicile`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,case `his-tpa`.`case`.`upload_haf_doc_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `upload_haf_doc_finished`,`his-tpa`.`case`.`upload_haf_doc_finished_by` AS `upload_haf_doc_finished_by`,`his-tpa`.`case`.`upload_haf_doc_finished_date` AS `upload_haf_doc_finished_date`,case `his-tpa`.`case`.`haf_doc_completed` when 1 then 'Pending' when 2 then 'Not Complete' when 3 then 'Complete' else 'N/A' end AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,case `his-tpa`.`case`.`issue_initial_log` when 1 then 'Pending' when 2 then 'LOG' when 3 then 'Non-LOG' else 'N/A' end AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_remarks` AS `initial_log_remarks`,case `his-tpa`.`case`.`initial_log_approval` when 0 then 'Disagree' when 1 then 'Agree' else 'N/A' end AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_plan` AS `discharge_plan`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,concat_ws(',',`his-tpa`.`diagnosis`.`code`,`his-tpa`.`diagnosis`.`name`) AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`exclusion` AS `exclusion`,case `his-tpa`.`case`.`bill_received` when 0 then 'Not Received' when 1 then 'Received' else 'N/A' end AS `bill_received`,`his-tpa`.`case`.`bill_received_by` AS `bill_received_by`,`his-tpa`.`case`.`bill_received_date` AS `bill_received_date`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`upload_bill_finished_by` AS `upload_bill_finished_by`,`his-tpa`.`case`.`upload_bill_finished_date` AS `upload_bill_finished_date`,case `his-tpa`.`case`.`upload_bill_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `upload_bill_finished`,case `his-tpa`.`case`.`bill_completed` when 1 then 'Pending' when 2 then 'Not Complete' when 3 then 'Complete' else 'N/A' end AS `bill_completed`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,`his-tpa`.`case`.`bill_completed_by_01` AS `BillCompleteBy_M`,`his-tpa`.`case`.`bill_completed_date_01` AS `BillCompleteDate_M`,`his-tpa`.`case`.`ws_type` AS `ws_type`,case `his-tpa`.`case`.`ws_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,case `his-tpa`.`case`.`ws_approval` when 0 then 'Pending' when 1 then 'Not Approve' when 2 then 'Approve' else 'N/A' end AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,case `his-tpa`.`case`.`issue_log` when 1 then 'Pending' when 2 then 'LOG' when 3 then 'Non-LOG' else 'N/A' end AS `issue_log`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`log_issued_by_01` AS `LogIssued_M`,`his-tpa`.`case`.`log_issue_date_01` AS `LogIssueDate_M`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_remarks` AS `log_remarks`,case `his-tpa`.`case`.`log_approval` when 0 then 'Disagree' when 1 then 'Agree' else 'N/A' end AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`reject_reason` AS `reject_reason`,`his-tpa`.`case`.`reject_remarks` AS `reject_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,case `his-tpa`.`case`.`original_bill_checked` when 1 then 'Pending' when 2 then 'Original Bill Not Complete' when 3 then 'WS Revision' when 4 then 'OK' when 5 then 'Close Case' else 'N/A' end AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,case `his-tpa`.`case`.`close_case_option` when 1 then 'By Document Send Back' when 2 then 'By Payment' else 'N/A' end AS `close_case_option`,case `his-tpa`.`case`.`original_bill_verified` when 1 then 'Pending' when 2 then 'Original Bill Not Complete' when 3 then 'WS Revision' when 4 then 'OK' when 5 then 'Close Case' else 'N/A' end AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,case `his-tpa`.`case`.`doc_send_back_to_client_required` when 1 then 'Required' when 0 then 'Not Required' else 'N/A' end AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,`his-tpa`.`case`.`edited_by` AS `edited_by`,`his-tpa`.`case`.`edit_date` AS `edit_date`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`actual`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`actual`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `actual`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`cover`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`cover`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `cover`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`excess`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`excess`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `excess`,`his-tpa`.`case`.`bill_issue_date` AS `BillReceieveDate`,'' AS `Document_InitialLOG_Hours`,'' AS `Initial_LOG_Minutes`,'' AS `Provider_Discharge_Hours`,'' AS `Document_FinalLOG_Hours`,'' AS `Final_LOG_Hours`,if(`his-tpa`.`case`.`status` = 19,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`discharge_date`,`his-tpa`.`case`.`bill_issue_date`)) AS `Document_OB_Hosp_Days`,if(`his-tpa`.`case`.`status` = 19,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`bill_issue_date`,`his-tpa`.`case`.`original_bill_upload_date`)) AS `Document_OB_Days`,if(`his-tpa`.`case`.`status` = 20 or `his-tpa`.`case`.`status` = 21 or `his-tpa`.`case`.`status` = 22 or `his-tpa`.`case`.`status` = 23 or `his-tpa`.`case`.`status` = 24 or `his-tpa`.`case`.`status` = 25,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`original_bill_checked_date`)) AS `Document_OBCheck_Days`,if(`his-tpa`.`case`.`status` = 26,9999999 * -1,if(`his-tpa`.`case`.`close_case_option` = 1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_checked_date`,`his-tpa`.`case`.`original_bill_verified_date`),timestampdiff(DAY,`his-tpa`.`case`.`doc_send_back_to_client_date`,`his-tpa`.`case`.`original_bill_verified_date`))) AS `Document_OBVerified_Days`,if(`his-tpa`.`case`.`status` = 27,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_verified_date`,`his-tpa`.`case`.`payment_date`)) AS `Document_Payment_Days`,if(`his-tpa`.`case`.`status` = 28,9999999 * -1,if(`his-tpa`.`case`.`close_case_option` = 1,timestampdiff(DAY,`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`doc_send_back_to_client_date`),timestampdiff(DAY,`his-tpa`.`case`.`original_bill_checked_date`,`his-tpa`.`case`.`doc_send_back_to_client_date`))) AS `Document_Sendback_Days`,if(`his-tpa`.`case`.`status` = 29,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date`)) AS `Document_ClientReceive_Days` from ((((((((((((((`his-tpa`.`case` join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`department` on(`his-tpa`.`member`.`department` = `his-tpa`.`department`.`id`)) left join `his-tpa`.`position` on(`his-tpa`.`member`.`position` = `his-tpa`.`position`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` not in (95,96,97,98,99,31,32,33,34,86,87,88,89) and `his-tpa`.`case`.`type` = 3 and `his-tpa`.`case_status`.`name`  not like 'Provider%' group by `his-tpa`.`case`.`id` order by `his-tpa`.`case`.`status` ;

-- ----------------------------
-- View structure for report_guarantee_cashless_outpatient
-- ----------------------------
DROP VIEW IF EXISTS `report_guarantee_cashless_outpatient`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `report_guarantee_cashless_outpatient` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case`.`create_date_01` AS `DocReceieveDate`,`his-tpa`.`case_status`.`name` AS `status`,case `his-tpa`.`case`.`source` when 1 then 'Medisclick' when 2 then 'Medisclick' when 3 then 'eCentrix' when 4 then 'eReimbursement' when 5 then 'Hospital Portal' else 'Healthcare' end AS `Source`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `category`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `type`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`member`.`member_name` AS `member_name`,`his-tpa`.`case`.`dob` AS `dob`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `gender`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,case `his-tpa`.`case`.`relation` when 1 then 'Principle' when 2 then 'Spouse' when 3 then 'Child' when 4 then 'Dependant' else 'N/A' end AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`department`.`name` AS `DEPARTMENT`,case `his-tpa`.`case`.`policy_status` when 1 then 'Enable' when 0 then 'Disable' else 'N/A' end AS `policy_status`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_holder` AS `policy_holder`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`member`.`plan_external` AS `plan_external`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`rider`.`name` AS `rider`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,case `provider`.`full_name` when 'NON PARTICIPATING HOSPITAL' then concat(`his-tpa`.`case`.`other_provider`,' (Non Panel)') else `provider`.`full_name` end AS `provider`,`provider`.`city` AS `city`,`his-tpa`.`country`.`name` AS `counttr`,case `his-tpa`.`country`.`name` when 'Indonesia' then 'Domestic' else 'Overseas' end AS `ProviderDomicile`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,case `his-tpa`.`case`.`upload_haf_doc_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `upload_haf_doc_finished`,`his-tpa`.`case`.`upload_haf_doc_finished_by` AS `upload_haf_doc_finished_by`,`his-tpa`.`case`.`upload_haf_doc_finished_date` AS `upload_haf_doc_finished_date`,case `his-tpa`.`case`.`haf_doc_completed` when 1 then 'Pending' when 2 then 'Not Complete' when 3 then 'Complete' else 'N/A' end AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,case `his-tpa`.`case`.`issue_initial_log` when 1 then 'Pending' when 2 then 'LOG' when 3 then 'Non-LOG' else 'N/A' end AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_remarks` AS `initial_log_remarks`,case `his-tpa`.`case`.`initial_log_approval` when 0 then 'Disagree' when 1 then 'Agree' else 'N/A' end AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_plan` AS `discharge_plan`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,concat_ws(',',`his-tpa`.`diagnosis`.`code`,`his-tpa`.`diagnosis`.`name`) AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`exclusion` AS `exclusion`,case `his-tpa`.`case`.`bill_received` when 0 then 'Not Received' when 1 then 'Received' else 'N/A' end AS `bill_received`,`his-tpa`.`case`.`bill_received_by` AS `bill_received_by`,`his-tpa`.`case`.`bill_received_date` AS `bill_received_date`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`upload_bill_finished_by` AS `upload_bill_finished_by`,`his-tpa`.`case`.`upload_bill_finished_date` AS `upload_bill_finished_date`,case `his-tpa`.`case`.`upload_bill_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `upload_bill_finished`,case `his-tpa`.`case`.`bill_completed` when 1 then 'Pending' when 2 then 'Not Complete' when 3 then 'Complete' else 'N/A' end AS `bill_completed`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,`his-tpa`.`case`.`bill_completed_by_01` AS `BillCompleteBy_M`,`his-tpa`.`case`.`bill_completed_date_01` AS `BillCompleteDate_M`,`his-tpa`.`case`.`ws_type` AS `ws_type`,case `his-tpa`.`case`.`ws_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,case `his-tpa`.`case`.`ws_approval` when 0 then 'Pending' when 1 then 'Not Approve' when 2 then 'Approve' else 'N/A' end AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,case `his-tpa`.`case`.`issue_log` when 1 then 'Pending' when 2 then 'LOG' when 3 then 'Non-LOG' else 'N/A' end AS `issue_log`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`log_issued_by_01` AS `LogIssued_M`,`his-tpa`.`case`.`log_issue_date_01` AS `LogIssueDate_M`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_remarks` AS `log_remarks`,case `his-tpa`.`case`.`log_approval` when 0 then 'Disagree' when 1 then 'Agree' else 'N/A' end AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`reject_reason` AS `reject_reason`,`his-tpa`.`case`.`reject_remarks` AS `reject_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,case `his-tpa`.`case`.`original_bill_checked` when 1 then 'Pending' when 2 then 'Original Bill Not Complete' when 3 then 'WS Revision' when 4 then 'OK' when 5 then 'Close Case' else 'N/A' end AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,case `his-tpa`.`case`.`close_case_option` when 1 then 'By Document Send Back' when 2 then 'By Payment' else 'N/A' end AS `close_case_option`,case `his-tpa`.`case`.`original_bill_verified` when 1 then 'Pending' when 2 then 'Original Bill Not Complete' when 3 then 'WS Revision' when 4 then 'OK' when 5 then 'Close Case' else 'N/A' end AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,case `his-tpa`.`case`.`doc_send_back_to_client_required` when 1 then 'Required' when 0 then 'Not Required' else 'N/A' end AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,`his-tpa`.`case`.`edited_by` AS `edited_by`,`his-tpa`.`case`.`edit_date` AS `edit_date`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`actual`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`actual`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `actual`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`cover`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`cover`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `cover`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`excess`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`excess`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `excess`,`his-tpa`.`case`.`bill_issue_date` AS `BillReceieveDate`,'' AS `Document_InitialLOG_Hours`,'' AS `Initial_LOG_Minutes`,if(`his-tpa`.`case`.`status` = 1 or `his-tpa`.`case`.`status` = 2 or `his-tpa`.`case`.`status` = 3,9999999 * -1,timestampdiff(HOUR,`his-tpa`.`case`.`create_date`,`his-tpa`.`case`.`discharge_date`)) AS `Provider_Discharge_Hours`,if(`his-tpa`.`case`.`status` = 4 or `his-tpa`.`case`.`status` = 5,9999999 * -1,timestampdiff(HOUR,`his-tpa`.`case`.`discharge_date`,`his-tpa`.`case`.`bill_completed_date`)) AS `Document_FinalLOG_Hours`,if(`his-tpa`.`case`.`status` = 6 or `his-tpa`.`case`.`status` = 7 or `his-tpa`.`case`.`status` = 8 or `his-tpa`.`case`.`status` = 9 or `his-tpa`.`case`.`status` = 10,9999999 * -1,timestampdiff(HOUR,`his-tpa`.`case`.`bill_completed_date`,`his-tpa`.`case`.`log_issue_date`)) AS `Final_LOG_Hours`,if(`his-tpa`.`case`.`status` = 11,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`log_issue_date`,`his-tpa`.`case`.`bill_issue_date`)) AS `Document_OB_Hosp_Days`,if(`his-tpa`.`case`.`status` = 11,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`bill_issue_date`,`his-tpa`.`case`.`original_bill_upload_date`)) AS `Document_OB_Days`,if(`his-tpa`.`case`.`status` = 12 or `his-tpa`.`case`.`status` = 13 or `his-tpa`.`case`.`status` = 14,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`original_bill_checked_date`)) AS `Document_OBCheck_Days`,if(`his-tpa`.`case`.`status` = 15,9999999 * -1,if(`his-tpa`.`case`.`close_case_option` = 1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_checked_date`,`his-tpa`.`case`.`original_bill_verified_date`),timestampdiff(DAY,`his-tpa`.`case`.`doc_send_back_to_client_date`,`his-tpa`.`case`.`original_bill_verified_date`))) AS `Document_OBVerified_Days`,if(`his-tpa`.`case`.`status` = 16,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_verified_date`,`his-tpa`.`case`.`payment_date`)) AS `Document_Payment_Days`,if(`his-tpa`.`case`.`status` = 17,9999999 * -1,if(`his-tpa`.`case`.`close_case_option` = 1,timestampdiff(DAY,`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`doc_send_back_to_client_date`),timestampdiff(DAY,`his-tpa`.`case`.`original_bill_checked_date`,`his-tpa`.`case`.`doc_send_back_to_client_date`))) AS `Document_Sendback_Days`,if(`his-tpa`.`case`.`status` = 18,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date`)) AS `Document_ClientReceive_Days` from ((((((((((((((`his-tpa`.`case` join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`department` on(`his-tpa`.`member`.`department` = `his-tpa`.`department`.`id`)) left join `his-tpa`.`position` on(`his-tpa`.`member`.`position` = `his-tpa`.`position`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` not in (95,96,97,98,99,31,32,33,34,86,87,88,89) and `his-tpa`.`case`.`category` = 0 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case_status`.`name`  not like 'Provider%' group by `his-tpa`.`case`.`id` order by `his-tpa`.`case`.`status` ;

-- ----------------------------
-- View structure for report_guarantee_reimbursement
-- ----------------------------
DROP VIEW IF EXISTS `report_guarantee_reimbursement`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `report_guarantee_reimbursement` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case`.`create_date_01` AS `DocReceieveDate`,`his-tpa`.`case_status`.`name` AS `status`,case `his-tpa`.`case`.`source` when 1 then 'Medisclick' when 2 then 'Medisclick' when 3 then 'eCentrix' when 4 then 'eReimbursement' when 5 then 'Hospital Portal' else 'Healthcare' end AS `Source`,case `his-tpa`.`case`.`category` when 0 then 'Outpatient' when 1 then 'Inpatient' else 'N/A' end AS `category`,case `his-tpa`.`case`.`type` when 1 then 'Reimbursement' when 2 then 'Cashless' when 3 then 'Cashless Non-LOG' when 4 then 'Pay & File' else 'N/A' end AS `type`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`member`.`member_name` AS `member_name`,`his-tpa`.`case`.`dob` AS `dob`,case `his-tpa`.`case`.`gender` when 0 then 'Female' when 1 then 'Male' else 'N/A' end AS `gender`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,case `his-tpa`.`case`.`relation` when 1 then 'Principle' when 2 then 'Spouse' when 3 then 'Child' when 4 then 'Dependant' else 'N/A' end AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`department`.`name` AS `DEPARTMENT`,case `his-tpa`.`case`.`policy_status` when 1 then 'Enable' when 0 then 'Disable' else 'N/A' end AS `policy_status`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_holder` AS `policy_holder`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`member`.`plan_external` AS `plan_external`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`rider`.`name` AS `rider`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,case `provider`.`full_name` when 'NON PARTICIPATING HOSPITAL' then concat(`his-tpa`.`case`.`other_provider`,' (Non Panel)') else `provider`.`full_name` end AS `provider`,`provider`.`city` AS `city`,`his-tpa`.`country`.`name` AS `counttr`,case `his-tpa`.`country`.`name` when 'Indonesia' then 'Domestic' else 'Overseas' end AS `ProviderDomicile`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,case `his-tpa`.`case`.`upload_haf_doc_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `upload_haf_doc_finished`,`his-tpa`.`case`.`upload_haf_doc_finished_by` AS `upload_haf_doc_finished_by`,`his-tpa`.`case`.`upload_haf_doc_finished_date` AS `upload_haf_doc_finished_date`,case `his-tpa`.`case`.`haf_doc_completed` when 1 then 'Pending' when 2 then 'Not Complete' when 3 then 'Complete' else 'N/A' end AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,case `his-tpa`.`case`.`issue_initial_log` when 1 then 'Pending' when 2 then 'LOG' when 3 then 'Non-LOG' else 'N/A' end AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_remarks` AS `initial_log_remarks`,case `his-tpa`.`case`.`initial_log_approval` when 0 then 'Disagree' when 1 then 'Agree' else 'N/A' end AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_plan` AS `discharge_plan`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,concat_ws(',',`his-tpa`.`diagnosis`.`code`,`his-tpa`.`diagnosis`.`name`) AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`exclusion` AS `exclusion`,case `his-tpa`.`case`.`bill_received` when 0 then 'Not Received' when 1 then 'Received' else 'N/A' end AS `bill_received`,`his-tpa`.`case`.`bill_received_by` AS `bill_received_by`,`his-tpa`.`case`.`bill_received_date` AS `bill_received_date`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`upload_bill_finished_by` AS `upload_bill_finished_by`,`his-tpa`.`case`.`upload_bill_finished_date` AS `upload_bill_finished_date`,case `his-tpa`.`case`.`upload_bill_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `upload_bill_finished`,case `his-tpa`.`case`.`bill_completed` when 1 then 'Pending' when 2 then 'Not Complete' when 3 then 'Complete' else 'N/A' end AS `bill_completed`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,`his-tpa`.`case`.`bill_completed_by_01` AS `BillCompleteBy_M`,`his-tpa`.`case`.`bill_completed_date_01` AS `BillCompleteDate_M`,`his-tpa`.`case`.`ws_type` AS `ws_type`,case `his-tpa`.`case`.`ws_finished` when 0 then 'Not Done' when 1 then 'Done' else 'N/A' end AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,case `his-tpa`.`case`.`ws_approval` when 0 then 'Pending' when 1 then 'Not Approve' when 2 then 'Approve' else 'N/A' end AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,case `his-tpa`.`case`.`issue_log` when 1 then 'Pending' when 2 then 'LOG' when 3 then 'Non-LOG' else 'N/A' end AS `issue_log`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`log_issued_by_01` AS `LogIssued_M`,`his-tpa`.`case`.`log_issue_date_01` AS `LogIssueDate_M`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_remarks` AS `log_remarks`,case `his-tpa`.`case`.`log_approval` when 0 then 'Disagree' when 1 then 'Agree' else 'N/A' end AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`reject_reason` AS `reject_reason`,`his-tpa`.`case`.`reject_remarks` AS `reject_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,case `his-tpa`.`case`.`original_bill_checked` when 1 then 'Pending' when 2 then 'Original Bill Not Complete' when 3 then 'WS Revision' when 4 then 'OK' when 5 then 'Close Case' else 'N/A' end AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,case `his-tpa`.`case`.`close_case_option` when 1 then 'By Document Send Back' when 2 then 'By Payment' else 'N/A' end AS `close_case_option`,case `his-tpa`.`case`.`original_bill_verified` when 1 then 'Pending' when 2 then 'Original Bill Not Complete' when 3 then 'WS Revision' when 4 then 'OK' when 5 then 'Close Case' else 'N/A' end AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,case `his-tpa`.`case`.`doc_send_back_to_client_required` when 1 then 'Required' when 0 then 'Not Required' else 'N/A' end AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,`his-tpa`.`case`.`edited_by` AS `edited_by`,`his-tpa`.`case`.`edit_date` AS `edit_date`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`actual`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`actual`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`actual`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `actual`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`cover`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`cover`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`cover`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `cover`,case `his-tpa`.`case`.`issue_log_option` when 1 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`excess`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) when 2 then if(`his-tpa`.`case`.`type` <> 1,(select sum(`ws1`.`excess`) from `his-tpa`.`worksheet_01` `ws1` where `ws1`.`case` = `his-tpa`.`case`.`id`),(select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`)) else (select sum(`ws`.`excess`) from `his-tpa`.`worksheet` `ws` where `ws`.`case` = `his-tpa`.`case`.`id`) end AS `excess`,`his-tpa`.`case`.`bill_issue_date` AS `BillReceieveDate`,'' AS `Document_InitialLOG_Hours`,'' AS `Initial_LOG_Minutes`,'' AS `Provider_Discharge_Hours`,'' AS `Document_FinalLOG_Hours`,'' AS `Final_LOG_Hours`,if(`his-tpa`.`case`.`status` = 19,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`bill_issue_date`,`his-tpa`.`case`.`create_date`)) AS `Document_OB_Cli_Days`,if(`his-tpa`.`case`.`status` = 19,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`create_date`,`his-tpa`.`case`.`original_bill_upload_date`)) AS `Document_OB_Days`,if(`his-tpa`.`case`.`status` = 20 or `his-tpa`.`case`.`status` = 21 or `his-tpa`.`case`.`status` = 22 or `his-tpa`.`case`.`status` = 23 or `his-tpa`.`case`.`status` = 24 or `his-tpa`.`case`.`status` = 25,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_upload_date`,`his-tpa`.`case`.`original_bill_checked_date`)) AS `Document_OBCheck_Days`,if(`his-tpa`.`case`.`status` = 26,9999999 * -1,if(`his-tpa`.`case`.`close_case_option` = 1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_checked_date`,`his-tpa`.`case`.`original_bill_verified_date`),timestampdiff(DAY,`his-tpa`.`case`.`doc_send_back_to_client_date`,`his-tpa`.`case`.`original_bill_verified_date`))) AS `Document_OBVerified_Days`,if(`his-tpa`.`case`.`status` = 27,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`original_bill_verified_date`,`his-tpa`.`case`.`payment_date`)) AS `Document_Payment_Days`,if(`his-tpa`.`case`.`status` = 28,9999999 * -1,if(`his-tpa`.`case`.`close_case_option` = 1,timestampdiff(DAY,`his-tpa`.`case`.`payment_date`,`his-tpa`.`case`.`doc_send_back_to_client_date`),timestampdiff(DAY,`his-tpa`.`case`.`original_bill_checked_date`,`his-tpa`.`case`.`doc_send_back_to_client_date`))) AS `Document_Sendback_Days`,if(`his-tpa`.`case`.`status` = 29,9999999 * -1,timestampdiff(DAY,`his-tpa`.`case`.`doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date`)) AS `Document_ClientReceive_Days` from ((((((((((((((`his-tpa`.`case` join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`department` on(`his-tpa`.`member`.`department` = `his-tpa`.`department`.`id`)) left join `his-tpa`.`position` on(`his-tpa`.`member`.`position` = `his-tpa`.`position`.`id`)) join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`provider`.`country` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`status` not in (95,96,97,98,99,31,32,33,34,86,87,88,89) and `his-tpa`.`case`.`type` = 1 and `his-tpa`.`case_status`.`name`  not like 'Provider%' group by `his-tpa`.`case`.`id` order by `his-tpa`.`case`.`status` ;

-- ----------------------------
-- View structure for report_hospital_01
-- ----------------------------
DROP VIEW IF EXISTS `report_hospital_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `report_hospital_01` AS select `his-tpa`.`admission`.`id` AS `id_admission`,`his-tpa`.`admission`.`created_by` AS `created_by`,`his-tpa`.`admission`.`create_date` AS `create_date`,`his-tpa`.`case`.`id` AS `id_case`,`his-tpa`.`admission`.`ref` AS `ref`,if(`his-tpa`.`admission`.`status` = 1,'Menunggu Konfirmasi AAI',if(`his-tpa`.`admission`.`status` = 2,'Sukses',if(`his-tpa`.`admission`.`status` = 3,'Dibatalkan',''))) AS `status_admission`,`his-tpa`.`status_hospital`.`name` AS `name`,`his-tpa`.`case`.`member_card` AS `member_card`,`patient`.`id` AS `id_pasien`,`patient`.`member_name` AS `member_name`,`his-tpa`.`case`.`provider` AS `provider`,`provider`.`full_name` AS `provider_name`,`his-tpa`.`admission`.`admission_date` AS `admission_date`,if(`his-tpa`.`admission`.`category` = 0,'Rawat Jalan',if(`his-tpa`.`admission`.`category` = 1,'Rawat Inap','')) AS `category` from ((((`his-tpa`.`admission` left join `his-tpa`.`case` on(`his-tpa`.`admission`.`ref` = `his-tpa`.`case`.`ref`)) join `his-tpa`.`status_hospital` on(`his-tpa`.`status_hospital`.`id` = `his-tpa`.`case`.`status`)) join `his-tpa`.`patient` on(`patient`.`id` = `his-tpa`.`case`.`patient`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`admission`.`source` = 5 ;

-- ----------------------------
-- View structure for report_hospital_02
-- ----------------------------
DROP VIEW IF EXISTS `report_hospital_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `report_hospital_02` AS select `report_hospital_01`.`provider_name` AS `provider_name`,`report_hospital_01`.`name` AS `name`,count(`report_hospital_01`.`id_case`) AS `count` from `her-tpa`.`report_hospital_01` group by `report_hospital_01`.`provider_name`,`report_hospital_01`.`name` ;

-- ----------------------------
-- View structure for select_country
-- ----------------------------
DROP VIEW IF EXISTS `select_country`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `select_country` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`case`.`other_provider_city` AS `other_provider_city`,`his-tpa`.`case`.`other_provider_country` AS `other_provider_country`,`his-tpa`.`country`.`name` AS `country` from (`his-tpa`.`case` left join `his-tpa`.`country` on(`his-tpa`.`country`.`id` = `his-tpa`.`case`.`other_provider_country`)) where `his-tpa`.`case`.`provider` in (310,2417,2462) and `his-tpa`.`case`.`client` = 1 and `his-tpa`.`case`.`status` <> 99 order by `his-tpa`.`case`.`id` desc ;

-- ----------------------------
-- View structure for sunlife_case_detail
-- ----------------------------
DROP VIEW IF EXISTS `sunlife_case_detail`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `sunlife_case_detail` AS select `his-tpa`.`worksheet`.`case` AS `case_number`,`his-tpa`.`worksheet`.`id` AS `id`,`his-tpa`.`plan_header`.`name` AS `plan_header`,`his-tpa`.`plan_detail`.`name` AS `plan_detail`,`his-tpa`.`worksheet`.`actual` AS `incurred_amount`,`his-tpa`.`worksheet`.`cover` AS `covered_amount`,`his-tpa`.`worksheet`.`excess` AS `excess_amount`,`his-tpa`.`worksheet`.`remarks` AS `remarks_excess`,`his-tpa`.`worksheet`.`remarks_01` AS `remarks_non_excess` from ((`his-tpa`.`worksheet` join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) ;

-- ----------------------------
-- View structure for sunlife_case_header
-- ----------------------------
DROP VIEW IF EXISTS `sunlife_case_header`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `sunlife_case_header` AS select concat(`his-tpa`.`case_status`.`status`,'. ',`his-tpa`.`case_status`.`name`) AS `case_status`,`his-tpa`.`case`.`id` AS `case_number`,if(`his-tpa`.`case`.`category` = 0,'Outpatient','Inpatient') AS `case_category`,if(`his-tpa`.`case`.`type` = 2,'Cashless','Reimbursement') AS `case_type`,`his-tpa`.`member`.`member_name` AS `patient`,`his-tpa`.`case`.`dob` AS `dob`,if(`his-tpa`.`case`.`gender` = 0,'Female',if(`his-tpa`.`case`.`gender` = 1,'Male','')) AS `gender`,if(`his-tpa`.`case`.`policy_status` = 1,'Enable','Disable') AS `policy_status`,`his-tpa`.`case`.`policy_no` AS `policy_number`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`plan`.`name` AS `plan`,if(`his-tpa`.`case`.`provider` = 310,`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) AS `medical_provider`,`provider`.`city` AS `provider_city`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,concat(`his-tpa`.`case`.`diagnosis`,': ',`his-tpa`.`diagnosis`.`name`) AS `main diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`worksheet_header`.`total_actual` AS `total_incurred`,`worksheet_header`.`total_cover` AS `total_covered`,`worksheet_header`.`total_excess` AS `total_excess` from ((((((`his-tpa`.`case` left join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`client` = 19 and `his-tpa`.`case`.`status` between 1 and 97 ;

-- ----------------------------
-- View structure for sunlife_critical_ilnes
-- ----------------------------
DROP VIEW IF EXISTS `sunlife_critical_ilnes`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `sunlife_critical_ilnes` AS select curdate() AS `Date_of_report_01`,year(`his-tpa`.`case`.`policy_effective_date`) AS `Member_Eff_date`,`his-tpa`.`case`.`policy_no` AS `Policy_No`,`his-tpa`.`case`.`policy_issue_date` AS `Policy_Issue_date`,`his-tpa`.`case`.`policy_revival_date` AS `Policy_Revival_date`,`his-tpa`.`case`.`member_id` AS `Member_id`,`his-tpa`.`member`.`member_name` AS `Patient_name`,if(`his-tpa`.`case`.`relation` = 1,'Principle',if(`his-tpa`.`case`.`relation` = 2,'Spouse',if(`his-tpa`.`case`.`relation` = 3,'Child','Dependant'))) AS `Member_relation`,`his-tpa`.`case`.`dob` AS `Member_date_of_birth`,`his-tpa`.`case`.`id` AS `case_id`,if(`his-tpa`.`case`.`payment_date` is not null,'Paid',if(`his-tpa`.`case`.`status` in (31,32),'Decline','Pending')) AS `claim_status`,`his-tpa`.`case`.`nonlog_remarks` AS `Non_log_remarks`,if(`his-tpa`.`case`.`type` = 1,'Reimbursment',if(`his-tpa`.`case`.`type` = 2,'Cashless','Cashless Non-LOG')) AS `case_type`,`his-tpa`.`case`.`admission_date` AS `admission_date_01`,date_format(`his-tpa`.`case`.`discharge_date`,'%Y-%m-%d') AS `discharge_date`,curdate() AS `Date_of_report`,`his-tpa`.`case`.`payment_date` AS `payment_date`,sum(`his-tpa`.`worksheet`.`cover`) AS `Sum_cover`,sum(`his-tpa`.`worksheet`.`actual`) AS `Sum_actual`,sum(`his-tpa`.`worksheet`.`cover`) AS `Sum_cover_01`,if(`his-tpa`.`case`.`category` = 0,'Outpatient','Inpatient') AS `case_category`,`his-tpa`.`plan_detail`.`name` AS `worksheet_name`,`his-tpa`.`plan_header`.`name` AS `benefit_name`,`his-tpa`.`diagnosis`.`name` AS `icd_desc`,`his-tpa`.`case`.`diagnosis` AS `icd_code`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`admission_date` AS `admission_date`,if(`provider`.`type` = 1,'Hospital','Clinic') AS `hospital_type`,`provider`.`full_name` AS `hospital_fullname`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`provider`.`city` AS `hospital_city`,'AAI' AS `AAI` from (((((((`his-tpa`.`case` left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`id`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 and `his-tpa`.`case`.`client` = 19 group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for top_10_diagnosis
-- ----------------------------
DROP VIEW IF EXISTS `top_10_diagnosis`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `top_10_diagnosis` AS select `top_10_diagnosis_01`.`client_id` AS `client_id`,`top_10_diagnosis_01`.`client_name` AS `client_name`,`top_10_diagnosis_01`.`year` AS `year`,`top_10_diagnosis_01`.`diagnosis` AS `diagnosis`,`top_10_diagnosis_01`.`count` AS `count`,`top_10_diagnosis_01`.`sum` AS `sum` from `her-tpa`.`top_10_diagnosis_01` union all select `top_10_diagnosis_02`.`client_id` AS `client_id`,`top_10_diagnosis_02`.`client_name` AS `client_name`,`top_10_diagnosis_02`.`year` AS `year`,`top_10_diagnosis_02`.`diagnosis` AS `diagnosis`,`top_10_diagnosis_02`.`count` AS `count`,`top_10_diagnosis_02`.`sum` AS `sum` from `her-tpa`.`top_10_diagnosis_02` ;

-- ----------------------------
-- View structure for top_10_diagnosis_01
-- ----------------------------
DROP VIEW IF EXISTS `top_10_diagnosis_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `top_10_diagnosis_01` AS select 8 AS `client_id`,'All Client' AS `client_name`,year(`his-tpa`.`case`.`create_date`) AS `year`,`his-tpa`.`case`.`diagnosis` AS `diagnosis`,count(`his-tpa`.`case`.`id`) AS `count`,sum(`worksheet_header`.`total_actual`) AS `sum` from ((`his-tpa`.`case` join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) where year(`his-tpa`.`case`.`create_date`) is not null and `his-tpa`.`case`.`diagnosis` is not null group by `his-tpa`.`case`.`diagnosis`,year(`his-tpa`.`case`.`create_date`) order by count(`his-tpa`.`case`.`id`) desc ;

-- ----------------------------
-- View structure for top_10_diagnosis_02
-- ----------------------------
DROP VIEW IF EXISTS `top_10_diagnosis_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `top_10_diagnosis_02` AS select `his-tpa`.`case`.`client` AS `client_id`,`client`.`full_name` AS `client_name`,year(`his-tpa`.`case`.`create_date`) AS `year`,`his-tpa`.`case`.`diagnosis` AS `diagnosis`,count(`his-tpa`.`case`.`id`) AS `count`,sum(`worksheet_header`.`total_actual`) AS `sum` from ((`his-tpa`.`case` join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) where year(`his-tpa`.`case`.`create_date`) is not null and `his-tpa`.`case`.`diagnosis` is not null group by `his-tpa`.`case`.`client`,year(`his-tpa`.`case`.`create_date`),`his-tpa`.`case`.`diagnosis` order by count(`his-tpa`.`case`.`id`) desc ;

-- ----------------------------
-- View structure for top_10_hospitals
-- ----------------------------
DROP VIEW IF EXISTS `top_10_hospitals`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `top_10_hospitals` AS select `top_10_hospitals_01`.`client_id` AS `client_id`,`top_10_hospitals_01`.`client_name` AS `client_name`,`top_10_hospitals_01`.`year` AS `year`,`top_10_hospitals_01`.`provider` AS `provider`,`top_10_hospitals_01`.`count` AS `count`,`top_10_hospitals_01`.`sum` AS `sum` from `her-tpa`.`top_10_hospitals_01` union all select `top_10_hospitals_02`.`client_id` AS `client_id`,`top_10_hospitals_02`.`client_name` AS `client_name`,`top_10_hospitals_02`.`year` AS `year`,`top_10_hospitals_02`.`provider` AS `provider`,`top_10_hospitals_02`.`count` AS `count`,`top_10_hospitals_02`.`sum` AS `sum` from `her-tpa`.`top_10_hospitals_02` ;

-- ----------------------------
-- View structure for top_10_hospitals_01
-- ----------------------------
DROP VIEW IF EXISTS `top_10_hospitals_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `top_10_hospitals_01` AS select 8 AS `client_id`,'All Client' AS `client_name`,year(`his-tpa`.`case`.`create_date`) AS `year`,`provider`.`full_name` AS `provider`,count(`his-tpa`.`case`.`id`) AS `count`,sum(`worksheet_header`.`total_actual`) AS `sum` from ((`his-tpa`.`case` join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) where year(`his-tpa`.`case`.`create_date`) is not null and `his-tpa`.`case`.`provider` is not null group by `his-tpa`.`case`.`provider`,year(`his-tpa`.`case`.`create_date`) order by count(`his-tpa`.`case`.`id`) desc ;

-- ----------------------------
-- View structure for top_10_hospitals_02
-- ----------------------------
DROP VIEW IF EXISTS `top_10_hospitals_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `top_10_hospitals_02` AS select `his-tpa`.`case`.`client` AS `client_id`,`client`.`full_name` AS `client_name`,year(`his-tpa`.`case`.`create_date`) AS `year`,`provider`.`full_name` AS `provider`,count(`his-tpa`.`case`.`id`) AS `count`,sum(`worksheet_header`.`total_actual`) AS `sum` from (((`his-tpa`.`case` join `his-tpa`.`worksheet_header` on(`his-tpa`.`case`.`id` = `worksheet_header`.`case`)) join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) where year(`his-tpa`.`case`.`create_date`) is not null and `his-tpa`.`case`.`provider` is not null group by `his-tpa`.`case`.`client`,`his-tpa`.`case`.`provider`,year(`his-tpa`.`case`.`create_date`) order by count(`his-tpa`.`case`.`id`) desc ;

-- ----------------------------
-- View structure for userlevelpermissions
-- ----------------------------
DROP VIEW IF EXISTS `userlevelpermissions`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `userlevelpermissions` AS select `his-tpa`.`userlevelpermissions`.`userlevelid` AS `userlevelid`,`his-tpa`.`userlevelpermissions`.`tablename` AS `tablename`,`his-tpa`.`userlevelpermissions`.`permission` AS `permission` from `his-tpa`.`userlevelpermissions` ;

-- ----------------------------
-- View structure for userlevelpermissions_hospital
-- ----------------------------
DROP VIEW IF EXISTS `userlevelpermissions_hospital`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `userlevelpermissions_hospital` AS select `his-tpa`.`userlevelpermissions_hospital`.`userlevelid` AS `userlevelid`,`his-tpa`.`userlevelpermissions_hospital`.`tablename` AS `tablename`,`his-tpa`.`userlevelpermissions_hospital`.`permission` AS `permission` from `his-tpa`.`userlevelpermissions_hospital` ;

-- ----------------------------
-- View structure for userlevels
-- ----------------------------
DROP VIEW IF EXISTS `userlevels`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `userlevels` AS select `his-tpa`.`userlevels`.`userlevelid` AS `userlevelid`,`his-tpa`.`userlevels`.`userlevelname` AS `userlevelname` from `his-tpa`.`userlevels` ;

-- ----------------------------
-- View structure for userlevels_hospital
-- ----------------------------
DROP VIEW IF EXISTS `userlevels_hospital`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `userlevels_hospital` AS select `his-tpa`.`userlevels_hospital`.`userlevelid` AS `userlevelid`,`his-tpa`.`userlevels_hospital`.`userlevelname` AS `userlevelname` from `his-tpa`.`userlevels_hospital` ;

-- ----------------------------
-- View structure for users
-- ----------------------------
DROP VIEW IF EXISTS `users`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `users` AS select `his-tpa`.`users`.`username` AS `username`,`his-tpa`.`users`.`password` AS `password`,`his-tpa`.`users`.`userlevel` AS `userlevel`,`his-tpa`.`users`.`full_name` AS `full_name`,`his-tpa`.`users`.`email` AS `email`,`his-tpa`.`users`.`profile` AS `profile`,`his-tpa`.`users`.`client` AS `client`,`his-tpa`.`users`.`report_to` AS `report_to`,`his-tpa`.`users`.`status` AS `status`,`his-tpa`.`users`.`created_by` AS `created_by`,`his-tpa`.`users`.`create_date` AS `create_date`,`his-tpa`.`users`.`edited_by` AS `edited_by`,`his-tpa`.`users`.`edit_date` AS `edit_date` from `his-tpa`.`users` ;

-- ----------------------------
-- View structure for users_hospital
-- ----------------------------
DROP VIEW IF EXISTS `users_hospital`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `users_hospital` AS select `his-tpa`.`users_hospital`.`username` AS `username`,`his-tpa`.`users_hospital`.`full_name` AS `full_name`,`his-tpa`.`users_hospital`.`password` AS `password`,`his-tpa`.`users_hospital`.`userlevel` AS `userlevel`,`his-tpa`.`users_hospital`.`email` AS `email`,`his-tpa`.`users_hospital`.`profile` AS `profile`,`his-tpa`.`users_hospital`.`provider` AS `provider`,`his-tpa`.`users_hospital`.`status` AS `status`,`his-tpa`.`users_hospital`.`created_by` AS `created_by`,`his-tpa`.`users_hospital`.`create_date` AS `create_date`,`his-tpa`.`users_hospital`.`report_to` AS `report_to` from `his-tpa`.`users_hospital` ;

-- ----------------------------
-- View structure for view_case
-- ----------------------------
DROP VIEW IF EXISTS `view_case`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `view_case` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`created_by` AS `created_by`,`his-tpa`.`case`.`create_date` AS `create_date`,`his-tpa`.`case_status`.`name` AS `status`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','')))) AS `type`,if(`his-tpa`.`case`.`category` = 0,'Outpatient','Inpatient') AS `category`,`his-tpa`.`member`.`member_name` AS `patient`,if(`his-tpa`.`case`.`gender` = 0,'Female',if(`his-tpa`.`case`.`gender` = 1,'Male','')) AS `gender`,`principle`.`member_name` AS `principle`,if(`his-tpa`.`case`.`relation` = 1,'Principle',if(`his-tpa`.`case`.`relation` = 2,'Spouse',if(`his-tpa`.`case`.`relation` = 3,'Child',if(`his-tpa`.`case`.`relation` = 4,'Dependant','')))) AS `relation`,`client`.`full_name` AS `client`,`his-tpa`.`branch`.`name` AS `branch`,`his-tpa`.`company`.`name` AS `company`,`his-tpa`.`case`.`ref` AS `ref`,`his-tpa`.`case`.`dob` AS `dob`,`his-tpa`.`case`.`member_id` AS `member_id`,`his-tpa`.`case`.`member_card` AS `member_card`,`his-tpa`.`case`.`policy_no` AS `policy_no`,`his-tpa`.`case`.`policy_effective_date` AS `policy_effective_date`,`his-tpa`.`case`.`policy_expiry_date` AS `policy_expiry_date`,`his-tpa`.`case`.`policy_issue_date` AS `policy_issue_date`,`his-tpa`.`case`.`policy_declare_date` AS `policy_declare_date`,`his-tpa`.`case`.`policy_lapse_date` AS `policy_lapse_date`,`his-tpa`.`case`.`policy_revival_date` AS `policy_revival_date`,`his-tpa`.`case`.`policy_termination_date` AS `policy_termination_date`,`his-tpa`.`case`.`special_condition` AS `special_condition`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`plan_detail`.`name` AS `benefit`,`his-tpa`.`plan_header`.`name` AS `jenis_benefit`,`his-tpa`.`case`.`plan_attach_date` AS `plan_attach_date`,`his-tpa`.`case`.`plan_expiry_date` AS `plan_expiry_date`,`his-tpa`.`case`.`rider_attach_date` AS `rider_attach_date`,`his-tpa`.`case`.`rider_expiry_date` AS `rider_expiry_date`,`his-tpa`.`status`.`name` AS `policy_status`,`his-tpa`.`program`.`name` AS `program`,`his-tpa`.`rider`.`name` AS `rider`,`provider`.`full_name` AS `provider`,`his-tpa`.`case`.`other_provider` AS `other_provider`,`his-tpa`.`country`.`currency` AS `currency`,`his-tpa`.`case`.`currency_rate` AS `currency_rate`,`his-tpa`.`case`.`admission_date` AS `admission_date`,`his-tpa`.`case`.`admission_time` AS `admission_time`,`his-tpa`.`case`.`admission_doctor` AS `admission_doctor`,`his-tpa`.`case`.`symptom` AS `symptom`,`his-tpa`.`case`.`symptom_since` AS `symptom_since`,`his-tpa`.`case`.`vital_sign` AS `vital_sign`,`his-tpa`.`case`.`initial_diagnosis` AS `initial_diagnosis`,`his-tpa`.`case`.`treatment_plan` AS `treatment_plan`,`his-tpa`.`case`.`upload_haf` AS `upload_haf`,`his-tpa`.`case`.`haf_uploaded_by` AS `haf_uploaded_by`,`his-tpa`.`case`.`haf_upload_date` AS `haf_upload_date`,`his-tpa`.`case`.`upload_doc` AS `upload_doc`,`his-tpa`.`case`.`doc_uploaded_by` AS `doc_uploaded_by`,`his-tpa`.`case`.`doc_upload_date` AS `doc_upload_date`,if(`his-tpa`.`case`.`haf_doc_completed` = 1,'Pending',if(`his-tpa`.`case`.`haf_doc_completed` = 2,'Not Completed','Completed')) AS `haf_doc_completed`,`his-tpa`.`case`.`haf_doc_completed_remarks` AS `haf_doc_completed_remarks`,`his-tpa`.`case`.`haf_doc_completed_by` AS `haf_doc_completed_by`,`his-tpa`.`case`.`haf_doc_completed_date` AS `haf_doc_completed_date`,if(`his-tpa`.`case`.`issue_initial_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_initial_log` = 2,'LOG','Non-LOG')) AS `issue_initial_log`,`his-tpa`.`case`.`initial_log_issued_by` AS `initial_log_issued_by`,`his-tpa`.`case`.`initial_log_issue_date` AS `initial_log_issue_date`,`his-tpa`.`case`.`initial_claim_no` AS `initial_claim_no`,`his-tpa`.`case`.`initial_log_approval` AS `initial_log_approval`,`his-tpa`.`case`.`discharge_date` AS `discharge_date`,`his-tpa`.`case`.`discharge_doctor` AS `discharge_doctor`,`his-tpa`.`case`.`actual_treatment` AS `actual_treatment`,`his-tpa`.`diagnosis`.`name` AS `diagnosis`,`his-tpa`.`case`.`other_diagnosis` AS `other_diagnosis`,`his-tpa`.`case`.`upload_bill` AS `upload_bill`,`his-tpa`.`case`.`bill_uploaded_by` AS `bill_uploaded_by`,`his-tpa`.`case`.`bill_upload_date` AS `bill_upload_date`,`his-tpa`.`case`.`bill_completed_remarks` AS `bill_completed_remarks`,`his-tpa`.`case`.`bill_completed_by` AS `bill_completed_by`,`his-tpa`.`case`.`bill_completed_date` AS `bill_completed_date`,if(`his-tpa`.`case`.`bill_completed` = 1,'Pending',if(`his-tpa`.`case`.`bill_completed` = 2,'Not completed','Completed')) AS `bill_completed`,if(`his-tpa`.`case`.`ws_finished` = 1,'Done','Not Done') AS `ws_finished`,`his-tpa`.`case`.`ws_finished_by` AS `ws_finished_by`,`his-tpa`.`case`.`ws_finished_date` AS `ws_finished_date`,if(`his-tpa`.`case`.`ws_approval` = 1,'Pending',if(`his-tpa`.`case`.`ws_approval` = 2,'Not Approve','Approve')) AS `ws_approval`,`his-tpa`.`case`.`ws_approval_remarks` AS `ws_approval_remarks`,`his-tpa`.`case`.`ws_approval_by` AS `ws_approval_by`,`his-tpa`.`case`.`ws_approval_date` AS `ws_approval_date`,`his-tpa`.`case`.`issuance_limit` AS `issuance_limit`,if(`his-tpa`.`case`.`issue_log` = 1,'Pending',if(`his-tpa`.`case`.`issue_log` = 2,'LOG','Non-LOG')) AS `issue_log`,if(`his-tpa`.`case`.`issue_log_option` = 1,'Full Cover','') AS `issue_log_option`,`his-tpa`.`case`.`log_issued_by` AS `log_issued_by`,`his-tpa`.`case`.`log_issue_date` AS `log_issue_date`,`his-tpa`.`case`.`claim_no` AS `claim_no`,`his-tpa`.`case`.`log_approval` AS `log_approval`,`his-tpa`.`case`.`nonlog_reason` AS `nonlog_reason`,`his-tpa`.`case`.`nonlog_remarks` AS `nonlog_remarks`,`his-tpa`.`case`.`bill_no` AS `bill_no`,`his-tpa`.`case`.`bill_issue_date` AS `bill_issue_date`,`his-tpa`.`case`.`bill_due_date` AS `bill_due_date`,`his-tpa`.`case`.`upload_original_bill` AS `upload_original_bill`,`his-tpa`.`case`.`original_bill_uploaded_by` AS `original_bill_uploaded_by`,`his-tpa`.`case`.`original_bill_upload_date` AS `original_bill_upload_date`,if(`his-tpa`.`case`.`original_bill_checked` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_checked` = 2,'Original Bill Not Complete',if(`his-tpa`.`case`.`original_bill_checked` = 3,'WS Revision',if(`his-tpa`.`case`.`original_bill_checked` = 4,'OK','Close Case')))) AS `original_bill_checked`,`his-tpa`.`case`.`original_bill_checked_remarks` AS `original_bill_checked_remarks`,`his-tpa`.`case`.`original_bill_checked_by` AS `original_bill_checked_by`,`his-tpa`.`case`.`original_bill_checked_date` AS `original_bill_checked_date`,if(`his-tpa`.`case`.`close_case_option` = 1,'By Document Send Back','By Payment') AS `close_case_option`,if(`his-tpa`.`case`.`original_bill_verified` = 1,'Pending',if(`his-tpa`.`case`.`original_bill_verified` = 2,'Original Bill Not Completed',if(`his-tpa`.`case`.`original_bill_verified` = 3,'WS Revision','OK'))) AS `original_bill_verified`,`his-tpa`.`case`.`original_bill_verified_remarks` AS `original_bill_verified_remarks`,`his-tpa`.`case`.`original_bill_verified_by` AS `original_bill_verified_by`,`his-tpa`.`case`.`original_bill_verified_date` AS `original_bill_verified_date`,`his-tpa`.`case`.`payment_date` AS `payment_date`,`his-tpa`.`case`.`paid_by` AS `paid_by`,`his-tpa`.`case`.`upload_proof_of_payment` AS `upload_proof_of_payment`,if(`his-tpa`.`case`.`doc_send_back_to_client_required` = 1,'Required','Not Required') AS `doc_send_back_to_client_required`,`his-tpa`.`case`.`doc_send_back_to_client_date` AS `doc_send_back_to_client_date`,`his-tpa`.`case`.`doc_received_by_client_date` AS `doc_received_by_client_date`,sum(`his-tpa`.`worksheet`.`actual`) AS `actual`,sum(`his-tpa`.`worksheet`.`cover`) AS `cover`,sum(`his-tpa`.`worksheet`.`excess`) AS `excess`,`his-tpa`.`case`.`edited_by` AS `edited_by`,`his-tpa`.`case`.`edit_date` AS `edit_date` from ((((((((((((((((`his-tpa`.`case` left join `his-tpa`.`case_status` on(`his-tpa`.`case`.`status` = `his-tpa`.`case_status`.`status`)) left join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) left join `his-tpa`.`principle` on(`his-tpa`.`case`.`principle` = `principle`.`id`)) left join `his-tpa`.`client` on(`his-tpa`.`case`.`client` = `client`.`id`)) left join `his-tpa`.`branch` on(`his-tpa`.`case`.`branch` = `his-tpa`.`branch`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) left join `his-tpa`.`status` on(`his-tpa`.`case`.`policy_status` = `his-tpa`.`status`.`id`)) left join `his-tpa`.`program` on(`his-tpa`.`case`.`program` = `his-tpa`.`program`.`id`)) left join `his-tpa`.`rider` on(`his-tpa`.`case`.`rider` = `his-tpa`.`rider`.`id`)) left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) left join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id` and `his-tpa`.`case`.`currency_02` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) left join `his-tpa`.`worksheet` on(`his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) left join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) left join `his-tpa`.`plan_detail` on(`his-tpa`.`worksheet`.`detail` = `his-tpa`.`plan_detail`.`id`)) left join `his-tpa`.`plan_header` on(`his-tpa`.`worksheet`.`header` = `his-tpa`.`plan_header`.`id`)) where `his-tpa`.`case_status`.`userlevels` = -1 group by `his-tpa`.`case`.`id` ;

-- ----------------------------
-- View structure for wallboard_admission_new
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_admission_new`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_admission_new` AS (select 'Cashless - Admission' AS `category`,'Wait Initial LOG' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,concat(if(hour(timediff(`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp())) < 9,concat('0',hour(timediff(`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()))),hour(timediff(`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()))),':',if(minute(timediff(`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp())) < 9,concat('0',minute(timediff(`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()))),minute(timediff(`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()))),':',if(timestampdiff(SECOND,`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()) % 60 < 10,concat('0',timestampdiff(SECOND,`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()) % 60),timestampdiff(SECOND,`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()) % 60)) AS `timer`,if(`provider`.`country` = 85,1,2) AS `provider`,timestampdiff(MINUTE,`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()) AS `SLA` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 3 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`haf_doc_completed_date` is not null and `his-tpa`.`case`.`category` <> 0 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and timestampdiff(MINUTE,`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()) < 60 order by timestampdiff(MINUTE,`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()) desc limit 5) union all (select 'Cashless - Admission' AS `category`,'Document Initial Completness' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,concat(if(hour(timediff(`his-tpa`.`case`.`haf_upload_date`,current_timestamp())) < 10,concat('0',hour(timediff(`his-tpa`.`case`.`haf_upload_date`,current_timestamp()))),hour(timediff(`his-tpa`.`case`.`haf_upload_date`,current_timestamp()))),':',if(minute(timediff(`his-tpa`.`case`.`haf_upload_date`,current_timestamp())) < 10,concat('0',minute(timediff(`his-tpa`.`case`.`haf_upload_date`,current_timestamp()))),minute(timediff(`his-tpa`.`case`.`haf_upload_date`,current_timestamp()))),':',if(timestampdiff(SECOND,`his-tpa`.`case`.`haf_upload_date`,current_timestamp()) % 60 < 10,concat('0',timestampdiff(SECOND,`his-tpa`.`case`.`haf_upload_date`,current_timestamp()) % 60),timestampdiff(SECOND,`his-tpa`.`case`.`haf_upload_date`,current_timestamp()) % 60)) AS `timer`,if(`provider`.`country` = 85,1,2) AS `provider`,timestampdiff(HOUR,`his-tpa`.`case`.`haf_upload_date`,current_timestamp()) AS `SLA` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 2 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(`his-tpa`.`case`.`admission_date`) > 0 and timestampdiff(MINUTE,`his-tpa`.`case`.`haf_upload_date`,current_timestamp()) < 360 order by timestampdiff(HOUR,`his-tpa`.`case`.`haf_upload_date`,current_timestamp()) desc limit 5) ;

-- ----------------------------
-- View structure for wallboard_admission_summary_new
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_admission_summary_new`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_admission_summary_new` AS select (select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 2 and `provider`.`country` = 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and to_days(curdate()) - to_days(`his-tpa`.`case`.`admission_date`) > 0 and timestampdiff(MINUTE,`his-tpa`.`case`.`haf_upload_date`,current_timestamp()) < 360) AS `domestic_initial_completeness`,(select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 2 and `provider`.`country` <> 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and to_days(curdate()) - to_days(`his-tpa`.`case`.`admission_date`) > 0 and timestampdiff(MINUTE,`his-tpa`.`case`.`haf_upload_date`,current_timestamp()) < 360) AS `overseas_initial_completeness`,(select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 3 and `provider`.`country` = 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and timestampdiff(MINUTE,`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()) < 360) AS `domestic_initial_log`,(select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 3 and `provider`.`country` <> 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT') AS `overseas_initial_log`,(select count(`his-tpa`.`case`.`id`) AS `case_id` from `his-tpa`.`case` where `his-tpa`.`case`.`status` in (1,2,3) and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and to_days(curdate()) - to_days(`his-tpa`.`case`.`admission_date`) > 0) AS `new_case`,(select count(`a`.`case_id`) from (((select `his-tpa`.`activity_log`.`case` AS `case_id`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,max(`his-tpa`.`activity_log`.`id`) AS `activity_log_id`,max(`his-tpa`.`activity_log`.`datetime`) AS `activity_log_date` from (`his-tpa`.`activity_log` join `his-tpa`.`case` on(`his-tpa`.`activity_log`.`case` = `his-tpa`.`case`.`id`)) where `his-tpa`.`activity_log`.`contact_type` = 11 and `his-tpa`.`activity_log`.`case` is not null and `his-tpa`.`activity_log`.`case` <> 0 and `his-tpa`.`case`.`status` < 11 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 group by `his-tpa`.`activity_log`.`case`)) `a` join `his-tpa`.`activity_log` `b` on(`a`.`activity_log_id` = `b`.`id`)) where date_format(`a`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(`a`.`activity_log_date`) > 2) AS `no_activity_log`,(select round((select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` between 3 and 30 and timestampdiff(MINUTE,`his-tpa`.`case`.`haf_doc_completed_date`,`his-tpa`.`case`.`initial_log_issue_date`) < 30 and `provider`.`country` = 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and month(`his-tpa`.`case`.`haf_doc_completed_date`) = month(current_timestamp()) and year(`his-tpa`.`case`.`bill_completed_date_01`) = year(current_timestamp())) / (select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` between 3 and 30 and `provider`.`country` = 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and month(`his-tpa`.`case`.`haf_doc_completed_date`) = month(current_timestamp()) and year(`his-tpa`.`case`.`bill_completed_date_01`) = year(current_timestamp())) * 100,0)) AS `sla_initial_domestic`,(select round((select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` between 3 and 30 and timestampdiff(MINUTE,`his-tpa`.`case`.`haf_doc_completed_date`,`his-tpa`.`case`.`initial_log_issue_date`) < 30 and `provider`.`country` <> 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and month(`his-tpa`.`case`.`haf_doc_completed_date`) = month(current_timestamp()) and year(`his-tpa`.`case`.`bill_completed_date_01`) = year(current_timestamp())) / (select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` between 3 and 30 and `provider`.`country` <> 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and month(`his-tpa`.`case`.`haf_doc_completed_date`) = month(current_timestamp()) and year(`his-tpa`.`case`.`bill_completed_date_01`) = year(current_timestamp())) * 100,0)) AS `sla_initial_overseas` ;

-- ----------------------------
-- View structure for wallboard_callcenter_01
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_callcenter_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `wallboard_callcenter_01` AS (select `his-tpa`.`activity_log`.`id` AS `id`,`his-tpa`.`activity_log`.`case` AS `case`,`his-tpa`.`activity_log`.`contact_type` AS `contact_type`,if(`his-tpa`.`activity_log`.`edit_date` is null,`his-tpa`.`activity_log`.`create_date`,`his-tpa`.`activity_log`.`edit_date`) AS `last_date`,timestampdiff(MINUTE,if(`his-tpa`.`activity_log`.`edit_date` is null,`his-tpa`.`activity_log`.`create_date`,`his-tpa`.`activity_log`.`edit_date`),current_timestamp()) AS `minutes`,'DOCUMENT NOT COMPLETE' AS `document_not_complete` from (`his-tpa`.`activity_log` left join (select max(coalesce(`his-tpa`.`activity_log`.`edit_date`,`his-tpa`.`activity_log`.`create_date`)) AS `date`,`his-tpa`.`activity_log`.`case` AS `case` from ((`his-tpa`.`activity_log` left join `his-tpa`.`case` on(`his-tpa`.`activity_log`.`case` = `his-tpa`.`case`.`id`)) left join `his-tpa`.`users` on(`his-tpa`.`activity_log`.`edited_by` = `his-tpa`.`users`.`username` or `his-tpa`.`activity_log`.`created_by` = `his-tpa`.`users`.`username`)) where `his-tpa`.`users`.`userlevel` = 3 and `his-tpa`.`case`.`category` = 1 and `his-tpa`.`activity_log`.`contact_type` in (2,8,100,31) and `his-tpa`.`case`.`status` between 2 and 13 group by `his-tpa`.`activity_log`.`case`) `a` on(`his-tpa`.`activity_log`.`case` = `a`.`case`)) where `his-tpa`.`activity_log`.`case` = `a`.`case` and coalesce(`his-tpa`.`activity_log`.`edit_date`,`his-tpa`.`activity_log`.`create_date`) > `a`.`date` and `his-tpa`.`activity_log`.`contact_type` = 12 and date_format(coalesce(`his-tpa`.`activity_log`.`edit_date`,`his-tpa`.`activity_log`.`create_date`),'%Y%m%d') > 20180115) union (select `a`.`id` AS `id`,`a`.`case` AS `case`,`b`.`contact_type` AS `contact_type`,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`) AS `last_date`,timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) AS `minutes`,'DOCUMENT NOT COMPLETE' AS `document_not_complete` from ((((select max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`case` AS `case` from `his-tpa`.`activity_log` group by `his-tpa`.`activity_log`.`case`)) `a` join `his-tpa`.`activity_log` `b` on(`a`.`id` = `b`.`id`)) join `his-tpa`.`case` `c` on(`c`.`id` = `b`.`case`)) where `c`.`category` = 1 and `c`.`type` = 2 and `b`.`contact_type` = 12) order by `minutes` desc ;

-- ----------------------------
-- View structure for wallboard_callcenter_01_20180116
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_callcenter_01_20180116`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `wallboard_callcenter_01_20180116` AS select `a`.`id` AS `id`,`a`.`case` AS `case`,`b`.`contact_type` AS `contact_type`,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`) AS `last_date`,timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) AS `minutes`,'DOCUMENT NOT COMPLETE' AS `document_not_complete` from ((((select max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`case` AS `case` from `his-tpa`.`activity_log` group by `his-tpa`.`activity_log`.`case`)) `a` join `his-tpa`.`activity_log` `b` on(`a`.`id` = `b`.`id`)) join `his-tpa`.`case` `c` on(`c`.`id` = `b`.`case`)) where `c`.`category` = 1 and `b`.`contact_type` <> 2 and `b`.`contact_type` = 12 and `b`.`contact_type` <> 8 order by timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) desc ;

-- ----------------------------
-- View structure for wallboard_callcenter_02
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_callcenter_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `wallboard_callcenter_02` AS select `a`.`id` AS `id`,`a`.`case` AS `case`,`b`.`contact_type` AS `contact_type`,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`) AS `last_date`,timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) AS `minutes`,'MEDICAL ENQUIRY' AS `medical_enquiry` from ((((select max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`case` AS `case` from `his-tpa`.`activity_log` group by `his-tpa`.`activity_log`.`case`)) `a` join `his-tpa`.`activity_log` `b` on(`a`.`id` = `b`.`id`)) join `his-tpa`.`case` `c` on(`c`.`id` = `b`.`case`)) where `c`.`category` = 1 and `b`.`contact_type` <> 2 and `b`.`contact_type` = 13 and `b`.`contact_type` <> 8 and `b`.`contact_type` <> 31 order by timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) desc ;

-- ----------------------------
-- View structure for wallboard_callcenter_03
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_callcenter_03`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%%` SQL SECURITY DEFINER VIEW `wallboard_callcenter_03` AS select `a`.`id` AS `id`,`a`.`case` AS `case`,`b`.`contact_type` AS `contact_type`,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`) AS `last_date`,timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) AS `minutes` from ((((select max(`his-tpa`.`activity_log`.`id`) AS `id`,`his-tpa`.`activity_log`.`case` AS `case` from `his-tpa`.`activity_log` group by `his-tpa`.`activity_log`.`case`)) `a` join `his-tpa`.`activity_log` `b` on(`a`.`id` = `b`.`id`)) join `his-tpa`.`case` `c` on(`c`.`id` = `b`.`case`)) where `c`.`status` = 11 and !(`c`.`id` in (select distinct `his-tpa`.`activity_log`.`case` from `his-tpa`.`activity_log` where `his-tpa`.`activity_log`.`contact_type` = 100)) and `c`.`id` > '147815' and `c`.`source` not in (5,6) and `c`.`category` = 1 order by timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) desc ;

-- ----------------------------
-- View structure for wallboard_callcenter_04
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_callcenter_04`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_callcenter_04` AS select `his-tpa`.`case`.`id` AS `id`,`his-tpa`.`case`.`id` AS `case`,`activity_log`.`contact_type` AS `contact_type`,coalesce(`his-tpa`.`case`.`edit_date`,`his-tpa`.`case`.`create_date`) AS `last_date`,timestampdiff(MINUTE,coalesce(`his-tpa`.`case`.`edit_date`,`his-tpa`.`case`.`create_date`),current_timestamp()) AS `minutes` from (`his-tpa`.`case` left join (select `his-tpa`.`activity_log`.`case` AS `case`,group_concat(`his-tpa`.`activity_log`.`contact_type` separator ',') AS `contact_type` from (`his-tpa`.`activity_log` left join `his-tpa`.`users` on(`his-tpa`.`activity_log`.`created_by` = `his-tpa`.`users`.`username`)) where `his-tpa`.`activity_log`.`status` = 4 and `his-tpa`.`activity_log`.`contact_type` in (2,8,31) and `his-tpa`.`users`.`userlevel` = 3 group by 1) `activity_log` on(`his-tpa`.`case`.`id` = `activity_log`.`case`)) where `his-tpa`.`case`.`status` = 4 and `his-tpa`.`case`.`category` = 1 and `his-tpa`.`case`.`source` not in (5,6) and `activity_log`.`case` is null and cast(coalesce(`his-tpa`.`case`.`edit_date`,`his-tpa`.`case`.`create_date`) as date) > '2019-03-26' order by 5 desc ;

-- ----------------------------
-- View structure for wallboard_callcenter_04_20190327
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_callcenter_04_20190327`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_callcenter_04_20190327` AS select `a`.`id` AS `id`,`a`.`case` AS `case`,`b`.`contact_type` AS `contact_type`,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`) AS `last_date`,timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) AS `minutes` from ((`her-tpa`.`activity_log_max` `a` join `his-tpa`.`activity_log` `b` on(`a`.`id` = `b`.`id`)) join `his-tpa`.`case` `c` on(`c`.`id` = `b`.`case`)) where `c`.`status` = 4 and `c`.`category` = 1 and `b`.`contact_type` <> 2 and `b`.`contact_type` <> 8 and `b`.`contact_type` = 15 and `c`.`source` <> 5 order by timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) desc ;

-- ----------------------------
-- View structure for wallboard_callcenter_05
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_callcenter_05`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_callcenter_05` AS select `a`.`id` AS `id`,`a`.`case` AS `case`,`b`.`contact_type` AS `contact_type`,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`) AS `last_date`,timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) AS `minutes` from (((`her-tpa`.`activity_log_max` `a` join `his-tpa`.`activity_log` `b` on(`a`.`id` = `b`.`id`)) join `his-tpa`.`case` `c` on(`c`.`id` = `b`.`case`)) join `her-tpa`.`provider` on(`provider`.`id` = `c`.`provider`)) where `c`.`category` = 1 and `b`.`contact_type` <> 2 and `b`.`contact_type` <> 8 and `b`.`contact_type` <> 31 and `b`.`contact_type` = 15 and `c`.`source` <> 5 and `c`.`status` not in (31,32,86,87,88,89,94,95,96,97,98,99) order by timestampdiff(MINUTE,if(`b`.`edit_date` is null,`b`.`create_date`,`b`.`edit_date`),current_timestamp()) desc ;

-- ----------------------------
-- View structure for wallboard_cashless_admission_01
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_admission_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_cashless_admission_01` AS select 'Cashless - Admission' AS `category`,'New Case' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,to_days(curdate()) - to_days(`his-tpa`.`case`.`admission_date`) AS `days` from `his-tpa`.`case` where `his-tpa`.`case`.`status` in (1,2,3) and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(`his-tpa`.`case`.`admission_date`) > 0 order by to_days(curdate()) - to_days(`his-tpa`.`case`.`admission_date`) desc ;

-- ----------------------------
-- View structure for wallboard_cashless_admission_02
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_admission_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_cashless_admission_02` AS select 'Cashless - Admission' AS `category`,'Wait Initial LOG' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,to_days(curdate()) - to_days(`his-tpa`.`case`.`haf_doc_completed_date`) AS `days` from `his-tpa`.`case` where `his-tpa`.`case`.`status` in (2,3) and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`haf_doc_completed_date` is not null and `his-tpa`.`case`.`category` <> 0 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 order by 4 desc ;

-- ----------------------------
-- View structure for wallboard_cashless_admission_02_copy
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_admission_02_copy`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_cashless_admission_02_copy` AS select 'Cashless - Admission' AS `category`,'Wait Initial LOG' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,timestampdiff(MINUTE,`his-tpa`.`case`.`haf_doc_completed_date`,current_timestamp()) AS `days` from `his-tpa`.`case` where `his-tpa`.`case`.`status` in (2,3) and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` <> 3 and `his-tpa`.`case`.`category` <> 0 order by 4 desc ;

-- ----------------------------
-- View structure for wallboard_cashless_admission_03
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_admission_03`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_cashless_admission_03` AS select 'Cashless - Admission' AS `category`,'No On-Going Activity Log' AS `sub_category`,`a`.`case_id` AS `case_id`,to_days(curdate()) - to_days(`a`.`activity_log_date`) AS `days_01`,to_days(curdate()) - to_days(`a`.`admission_date`) AS `days_02`,`b`.`description` AS `activity_log_description` from (((select `his-tpa`.`activity_log`.`case` AS `case_id`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,max(`his-tpa`.`activity_log`.`id`) AS `activity_log_id`,max(`his-tpa`.`activity_log`.`datetime`) AS `activity_log_date` from (`his-tpa`.`activity_log` join `his-tpa`.`case` on(`his-tpa`.`activity_log`.`case` = `his-tpa`.`case`.`id`)) where `his-tpa`.`activity_log`.`contact_type` = 11 and `his-tpa`.`activity_log`.`case` is not null and `his-tpa`.`activity_log`.`case` <> 0 and `his-tpa`.`case`.`status` < 11 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 group by `his-tpa`.`activity_log`.`case`)) `a` join `his-tpa`.`activity_log` `b` on(`a`.`activity_log_id` = `b`.`id`)) where date_format(`a`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(`a`.`activity_log_date`) > 2 order by to_days(curdate()) - to_days(`a`.`activity_log_date`),to_days(curdate()) - to_days(`a`.`admission_date`) ;

-- ----------------------------
-- View structure for wallboard_cashless_admission_04
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_admission_04`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_cashless_admission_04` AS select 'Cashless - Admission' AS `category`,'Last Activity Log' AS `sub_category`,`his-tpa`.`activity_log`.`case` AS `case_id`,max(`his-tpa`.`activity_log`.`datetime`) AS `activity_log_date`,`his-tpa`.`activity_log`.`description` AS `activity_log_description` from (`his-tpa`.`activity_log` join `his-tpa`.`case` on(`his-tpa`.`activity_log`.`case` = `his-tpa`.`case`.`id`)) where `his-tpa`.`activity_log`.`contact_type` <> 99 and `his-tpa`.`activity_log`.`description` <> '' and `his-tpa`.`activity_log`.`description` is not null and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 group by `his-tpa`.`case`.`id` order by `his-tpa`.`activity_log`.`id` desc ;

-- ----------------------------
-- View structure for wallboard_cashless_admission_05
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_admission_05`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_cashless_admission_05` AS select 'Cashless - Admission' AS `category`,'New Pre Admission' AS `sub_category`,`his-tpa`.`case`.`id` AS `patient_id`,to_days(`his-tpa`.`case`.`admission_date`) - to_days(curdate()) AS `days` from `his-tpa`.`case` where `his-tpa`.`case`.`status` = 1 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and to_days(`his-tpa`.`case`.`admission_date`) - to_days(curdate()) > 0 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 order by to_days(`his-tpa`.`case`.`admission_date`) - to_days(curdate()) ;

-- ----------------------------
-- View structure for wallboard_cashless_admission_06
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_admission_06`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_cashless_admission_06` AS select 'Cashless - Admission' AS `category`,'Wait LOG' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,timestampdiff(MINUTE,`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()) AS `days` from (`his-tpa`.`case` left join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) where `his-tpa`.`case`.`status` in (6,7,8,9,10) and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `provider`.`country` = 85 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and `his-tpa`.`case`.`create_date` = current_timestamp() order by 4 desc ;

-- ----------------------------
-- View structure for wallboard_cashless_discharge_01
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_discharge_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_cashless_discharge_01` AS select 'Cashless - Discharge' AS `category`,'Length of Stay' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) AS `days` from `his-tpa`.`case` where `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 30 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) >= 3 group by to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) desc limit 0 ;

-- ----------------------------
-- View structure for wallboard_cashless_discharge_02
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_discharge_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_cashless_discharge_02` AS select 'Cashless - Discharge' AS `category`,'Discharge Plan' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,to_days(curdate()) - to_days(`his-tpa`.`case`.`discharge_plan`) AS `days_01`,to_days(curdate()) - to_days(`his-tpa`.`case`.`discharge_plan_receive_date`) AS `days_02`,to_days(curdate()) - to_days(`his-tpa`.`case`.`discharge_plan_receive_date`) AS `days_03`,`his-tpa`.`case`.`discharge_plan_receive_date` AS `discharge_plan_receive_date`,current_timestamp() AS `now`,round(time_to_sec(timediff(current_timestamp(),`his-tpa`.`case`.`discharge_plan_receive_date`)) / 60,0) AS `selisih` from `his-tpa`.`case` where `his-tpa`.`case`.`discharge_plan` is not null and `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`status` not in (30,31,32,98) and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 order by round(time_to_sec(timediff(current_timestamp(),`his-tpa`.`case`.`discharge_plan_receive_date`)) / 60,0) desc ;

-- ----------------------------
-- View structure for wallboard_cashless_discharge_03
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_discharge_03`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_cashless_discharge_03` AS select 'Cashless - Discharge' AS `category`,'On Process' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,1 AS `days` from `his-tpa`.`case` where `his-tpa`.`case`.`bill_completed` = 3 and `his-tpa`.`case`.`issue_log` = 1 and `his-tpa`.`case`.`status` in (6,7,8,9,10) and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` = 1 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 order by to_days(curdate()) - to_days(`his-tpa`.`case`.`bill_completed_date`) desc ;

-- ----------------------------
-- View structure for wallboard_cashless_discharge_04
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_cashless_discharge_04`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_cashless_discharge_04` AS select 'Cashless - Discharge' AS `category`,'Pending Original Bill Checking' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,to_days(curdate()) - to_days(`his-tpa`.`case`.`original_bill_upload_date`) AS `days` from `his-tpa`.`case` where `his-tpa`.`case`.`status` = 12 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (8,1) and `his-tpa`.`case`.`provider` not in (2414,4116) order by to_days(curdate()) - to_days(`his-tpa`.`case`.`original_bill_upload_date`) desc ;

-- ----------------------------
-- View structure for wallboard_discharge_new
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_discharge_new`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_discharge_new` AS (select 'Cashless - Discharge' AS `category`,'Wait Final LOG' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,concat(if(hour(timediff(`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp())) < 9,concat('0',hour(timediff(`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()))),hour(timediff(`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()))),':',if(minute(timediff(`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp())) < 9,concat('0',minute(timediff(`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()))),minute(timediff(`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()))),':',if(timestampdiff(SECOND,`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()) % 60 < 10,concat('0',timestampdiff(SECOND,`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()) % 60),timestampdiff(SECOND,`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()) % 60)) AS `timer`,if(`provider`.`country` = 85,1,2) AS `provider`,timestampdiff(MINUTE,`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()) AS `SLA` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` in (6,7,8,9,10) and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`haf_doc_completed_date` is not null and `his-tpa`.`case`.`category` <> 0 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and timestampdiff(MINUTE,`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()) < 60) union all (select 'Cashless - Discharge' AS `category`,'Document Final Completness' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,concat(if(hour(timediff(`his-tpa`.`case`.`bill_upload_date`,current_timestamp())) < 10,concat('0',hour(timediff(`his-tpa`.`case`.`bill_upload_date`,current_timestamp()))),hour(timediff(`his-tpa`.`case`.`bill_upload_date`,current_timestamp()))),':',if(minute(timediff(`his-tpa`.`case`.`bill_upload_date`,current_timestamp())) < 10,concat('0',minute(timediff(`his-tpa`.`case`.`bill_upload_date`,current_timestamp()))),minute(timediff(`his-tpa`.`case`.`bill_upload_date`,current_timestamp()))),':',if(timestampdiff(SECOND,`his-tpa`.`case`.`bill_upload_date`,current_timestamp()) % 60 < 10,concat('0',timestampdiff(SECOND,`his-tpa`.`case`.`bill_upload_date`,current_timestamp()) % 60),timestampdiff(SECOND,`his-tpa`.`case`.`bill_upload_date`,current_timestamp()) % 60)) AS `timer`,if(`provider`.`country` = 85,1,2) AS `provider`,timestampdiff(HOUR,`his-tpa`.`case`.`bill_upload_date`,current_timestamp()) AS `SLA` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 5 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 order by timestampdiff(HOUR,`his-tpa`.`case`.`bill_upload_date`,current_timestamp()) desc limit 3) order by `SLA` desc ;

-- ----------------------------
-- View structure for wallboard_discharge_summary_new
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_discharge_summary_new`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_discharge_summary_new` AS select (select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 5 and `provider`.`country` = 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT') AS `domestic_final_completeness`,(select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 5 and `provider`.`country` <> 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT') AS `overseas_final_completeness`,(select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` in (6,7,8,9,10) and `provider`.`country` = 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and timestampdiff(MINUTE,`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()) < 60) AS `domestic_final_log`,(select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` in (6,7,8,9,10) and `provider`.`country` <> 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and timestampdiff(MINUTE,`his-tpa`.`case`.`bill_completed_date_01`,current_timestamp()) < 60) AS `overseas_final_log`,(select count(`his-tpa`.`case`.`id`) AS `case_id` from `his-tpa`.`case` where `his-tpa`.`case`.`status` = 12 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`created_by`  not like 'UAT') AS `original_bill_checking`,(select count(`a`.`case_id`) from (((select `his-tpa`.`activity_log`.`case` AS `case_id`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,max(`his-tpa`.`activity_log`.`id`) AS `activity_log_id`,max(`his-tpa`.`activity_log`.`datetime`) AS `activity_log_date` from (`his-tpa`.`activity_log` join `his-tpa`.`case` on(`his-tpa`.`activity_log`.`case` = `his-tpa`.`case`.`id`)) where `his-tpa`.`activity_log`.`contact_type` = 11 and `his-tpa`.`activity_log`.`case` is not null and `his-tpa`.`activity_log`.`case` <> 0 and `his-tpa`.`case`.`status` < 11 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 group by `his-tpa`.`activity_log`.`case`)) `a` join `his-tpa`.`activity_log` `b` on(`a`.`activity_log_id` = `b`.`id`)) where date_format(`a`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(`a`.`activity_log_date`) > 2) AS `no_activity_log`,(select round((select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` between 10 and 30 and timestampdiff(MINUTE,`his-tpa`.`case`.`bill_completed_date_01`,`his-tpa`.`case`.`log_issue_date_01`) < 60 and `provider`.`country` = 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and month(`his-tpa`.`case`.`bill_completed_date_01`) = month(current_timestamp()) and year(`his-tpa`.`case`.`bill_completed_date_01`) = year(current_timestamp())) / (select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` between 10 and 30 and `provider`.`country` = 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and month(`his-tpa`.`case`.`bill_completed_date_01`) = month(current_timestamp()) and year(`his-tpa`.`case`.`bill_completed_date_01`) = year(current_timestamp())) * 100,0)) AS `sla_initial_domestic`,(select round((select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` between 10 and 30 and timestampdiff(MINUTE,`his-tpa`.`case`.`bill_completed_date_01`,`his-tpa`.`case`.`log_issue_date_01`) < 60 and `provider`.`country` <> 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and month(`his-tpa`.`case`.`bill_completed_date_01`) = month(current_timestamp()) and year(`his-tpa`.`case`.`bill_completed_date_01`) = year(current_timestamp())) / (select count(`his-tpa`.`case`.`id`) AS `case_id` from (`his-tpa`.`case` join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` between 10 and 30 and `provider`.`country` <> 85 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`created_by`  not like 'UAT' and month(`his-tpa`.`case`.`bill_completed_date_01`) = month(current_timestamp()) and year(`his-tpa`.`case`.`bill_completed_date_01`) = year(current_timestamp())) * 100,0)) AS `sla_initial_overseas` ;

-- ----------------------------
-- View structure for wallboard_monitoring_new
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_monitoring_new`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_monitoring_new` AS (select 'Cashless - Monitoring' AS `category`,'Length of Stay < 2' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,if(`provider`.`country` = 85,1,2) AS `provider`,to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) AS `days`,date_format(`wallboard_cashless_admission_04`.`activity_log_date`,'%d/%m/%Y') AS `last_activity_log`,if(date_format(`wallboard_cashless_admission_04`.`activity_log_date`,'%d/%m/%Y') = date_format(current_timestamp(),'%d/%m/%Y'),1,0) AS `any_activity` from ((`his-tpa`.`case` join `her-tpa`.`wallboard_cashless_admission_04` on(`wallboard_cashless_admission_04`.`case_id` = `his-tpa`.`case`.`id`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 30 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `provider`.`country` = 85 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) < 14 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) >= 3 group by to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) desc limit 5) union all (select 'Cashless - Monitoring' AS `category`,'Length of Stay < 2' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,if(`provider`.`country` = 85,1,2) AS `provider`,to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) AS `days`,date_format(`wallboard_cashless_admission_04`.`activity_log_date`,'%d/%m/%Y') AS `last_activity_log`,if(date_format(`wallboard_cashless_admission_04`.`activity_log_date`,'%d/%m/%Y') = date_format(current_timestamp(),'%d/%m/%Y'),1,0) AS `any_activity` from ((`his-tpa`.`case` join `her-tpa`.`wallboard_cashless_admission_04` on(`wallboard_cashless_admission_04`.`case_id` = `his-tpa`.`case`.`id`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 30 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `provider`.`country` <> 85 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) < 14 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) >= 3 group by to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) desc limit 5) union all (select 'Cashless - Monitoring' AS `category`,'Length of Stay > 2' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,if(`provider`.`country` = 85,1,2) AS `provider`,to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) AS `days`,date_format(`wallboard_cashless_admission_04`.`activity_log_date`,'%d/%m/%Y') AS `last_activity_log`,if(date_format(`wallboard_cashless_admission_04`.`activity_log_date`,'%d/%m/%Y') = date_format(current_timestamp(),'%d/%m/%Y'),1,0) AS `any_activity` from ((`his-tpa`.`case` join `her-tpa`.`wallboard_cashless_admission_04` on(`wallboard_cashless_admission_04`.`case_id` = `his-tpa`.`case`.`id`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 30 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `provider`.`country` = 85 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) between 14 and 21 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) >= 3 group by to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) desc limit 5) union all (select 'Cashless - Monitoring' AS `category`,'Length of Stay > 2' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,if(`provider`.`country` = 85,1,2) AS `provider`,to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) AS `days`,date_format(`wallboard_cashless_admission_04`.`activity_log_date`,'%d/%m/%Y') AS `last_activity_log`,if(date_format(`wallboard_cashless_admission_04`.`activity_log_date`,'%d/%m/%Y') = date_format(current_timestamp(),'%d/%m/%Y'),1,0) AS `any_activity` from ((`his-tpa`.`case` join `her-tpa`.`wallboard_cashless_admission_04` on(`wallboard_cashless_admission_04`.`case_id` = `his-tpa`.`case`.`id`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 30 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `provider`.`country` <> 85 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) > 13 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) >= 3 group by to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) desc limit 5) ;

-- ----------------------------
-- View structure for wallboard_monitoring_summary_new
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_monitoring_summary_new`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `wallboard_monitoring_summary_new` AS select (select count(`a`.`case_id`) AS `case_id` from (select `his-tpa`.`case`.`id` AS `case_id` from ((`his-tpa`.`case` join `her-tpa`.`wallboard_cashless_admission_04` on(`wallboard_cashless_admission_04`.`case_id` = `his-tpa`.`case`.`id`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 30 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `provider`.`country` = 85 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) < 14 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) >= 3 group by to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`))) `a`) AS `less_than_domestic`,(select count(`a`.`case_id`) AS `case_id` from (select `his-tpa`.`case`.`id` AS `case_id` from ((`his-tpa`.`case` join `her-tpa`.`wallboard_cashless_admission_04` on(`wallboard_cashless_admission_04`.`case_id` = `his-tpa`.`case`.`id`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 30 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `provider`.`country` <> 85 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) < 14 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) >= 3 group by to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`))) `a`) AS `less_than_overseas`,(select count(`a`.`case_id`) AS `case_id` from (select `his-tpa`.`case`.`id` AS `case_id` from ((`his-tpa`.`case` join `her-tpa`.`wallboard_cashless_admission_04` on(`wallboard_cashless_admission_04`.`case_id` = `his-tpa`.`case`.`id`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 30 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `provider`.`country` = 85 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) between 14 and 21 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) >= 3 group by to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`))) `a`) AS `more_than_domestic`,(select count(`a`.`case_id`) AS `case_id` from (select `his-tpa`.`case`.`id` AS `case_id` from ((`his-tpa`.`case` join `her-tpa`.`wallboard_cashless_admission_04` on(`wallboard_cashless_admission_04`.`case_id` = `his-tpa`.`case`.`id`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`id` > 20000 and `his-tpa`.`case`.`status` < 30 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 and `provider`.`country` <> 85 and date_format(`his-tpa`.`case`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) > 13 and to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`)) >= 3 group by to_days(curdate()) - to_days(concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`))) `a`) AS `more_than_overseas`,(select count(`his-tpa`.`case`.`id`) AS `case_id` from `his-tpa`.`case` where `his-tpa`.`case`.`discharge_plan` is not null and `his-tpa`.`case`.`discharge_date` is null and `his-tpa`.`case`.`status` not in (30,31,32,98) and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 order by round(time_to_sec(timediff(current_timestamp(),`his-tpa`.`case`.`discharge_plan_receive_date`)) / 60,0)) AS `discharge_plan`,(select count(`a`.`case_id`) from (((select `his-tpa`.`activity_log`.`case` AS `case_id`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,max(`his-tpa`.`activity_log`.`id`) AS `activity_log_id`,max(`his-tpa`.`activity_log`.`datetime`) AS `activity_log_date` from (`his-tpa`.`activity_log` join `his-tpa`.`case` on(`his-tpa`.`activity_log`.`case` = `his-tpa`.`case`.`id`)) where `his-tpa`.`activity_log`.`contact_type` = 11 and `his-tpa`.`activity_log`.`case` is not null and `his-tpa`.`activity_log`.`case` <> 0 and `his-tpa`.`case`.`status` < 11 and `his-tpa`.`case`.`type` = 2 and `his-tpa`.`case`.`client` not in (3,8) and `his-tpa`.`case`.`provider` not in (2414,4116) and `his-tpa`.`case`.`category` <> 0 group by `his-tpa`.`activity_log`.`case`)) `a` join `his-tpa`.`activity_log` `b` on(`a`.`activity_log_id` = `b`.`id`)) where date_format(`a`.`admission_date`,'%Y%m%d') > 20181231 and to_days(curdate()) - to_days(`a`.`activity_log_date`) > 2) AS `no_activity_log` ;

-- ----------------------------
-- View structure for wallboard_provider_01
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_provider_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_provider_01` AS select `his-tpa`.`case`.`id` AS `case_id`,`his-tpa`.`member`.`member_name` AS `patient`,if(`his-tpa`.`case`.`other_provider` is null,`provider`.`full_name`,`his-tpa`.`case`.`other_provider`) AS `medical_provider`,concat(`his-tpa`.`case`.`admission_date`,' ',`his-tpa`.`case`.`admission_time`) AS `admission_date`,to_days(curdate()) - to_days(`his-tpa`.`case`.`admission_date`) AS `days` from ((`his-tpa`.`case` join `his-tpa`.`member` on(`his-tpa`.`member`.`id` = `his-tpa`.`case`.`patient`)) join `his-tpa`.`provider` on(`provider`.`id` = `his-tpa`.`case`.`provider`)) where `his-tpa`.`case`.`status` = 35 order by to_days(curdate()) - to_days(`his-tpa`.`case`.`admission_date`) desc ;

-- ----------------------------
-- View structure for wallboard_reimbursement_01
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_reimbursement_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_reimbursement_01` AS select 'Reimbursement' AS `category`,'New Case' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,to_days(curdate()) - to_days(`his-tpa`.`case`.`create_date`) AS `days` from `his-tpa`.`case` where `his-tpa`.`case`.`status` = 19 and `his-tpa`.`case`.`type` <> 2 and `his-tpa`.`case`.`client` <> 3 and `his-tpa`.`case`.`category` <> 0 and to_days(curdate()) - to_days(`his-tpa`.`case`.`create_date`) <= 1 order by to_days(curdate()) - to_days(`his-tpa`.`case`.`create_date`) desc ;

-- ----------------------------
-- View structure for wallboard_reimbursement_02
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_reimbursement_02`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_reimbursement_02` AS select 'Reimbursement' AS `category`,'On Process' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,to_days(curdate()) - to_days(`his-tpa`.`case`.`original_bill_upload_date`) AS `days` from (`his-tpa`.`case` left join `his-tpa`.`activity_log` on(`his-tpa`.`case`.`id` = `his-tpa`.`activity_log`.`case`)) where `his-tpa`.`case`.`status` in (20,21,22,23,24,25) and `his-tpa`.`case`.`type` <> 2 and `his-tpa`.`case`.`client` <> 3 and `his-tpa`.`case`.`category` <> 0 group by `his-tpa`.`case`.`id` having coalesce(convert(group_concat(`his-tpa`.`activity_log`.`contact_type` separator ',') using utf8mb4),'0')  not like '%98%' order by to_days(curdate()) - to_days(`his-tpa`.`case`.`original_bill_upload_date`) desc ;

-- ----------------------------
-- View structure for wallboard_reimbursement_03
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_reimbursement_03`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_reimbursement_03` AS select 'Reimbursement' AS `category`,'Investigation' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,to_days(curdate()) - to_days(`his-tpa`.`case`.`original_bill_upload_date`) AS `days` from (`his-tpa`.`case` left join `his-tpa`.`activity_log` on(`his-tpa`.`case`.`id` = `his-tpa`.`activity_log`.`case`)) where `his-tpa`.`case`.`type` <> 2 and `his-tpa`.`case`.`client` <> 3 and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`status` not in (30,31,32,97,98,99) and `his-tpa`.`case`.`id` <> 163659 group by `his-tpa`.`case`.`id` having coalesce(convert(group_concat(`his-tpa`.`activity_log`.`contact_type` separator ',') using utf8mb4),'0') like '%97%' order by to_days(curdate()) - to_days(`his-tpa`.`case`.`original_bill_upload_date`) desc ;

-- ----------------------------
-- View structure for wallboard_reimbursement_04
-- ----------------------------
DROP VIEW IF EXISTS `wallboard_reimbursement_04`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `wallboard_reimbursement_04` AS select 'Administration' AS `category`,'Pending Document Send Back to Client' AS `sub_category`,`his-tpa`.`case`.`id` AS `case_id`,5 AS `days` from `his-tpa`.`case` where `his-tpa`.`case`.`status` in (17,28) and `his-tpa`.`case`.`client` <> 3 and `his-tpa`.`case`.`category` <> 0 and `his-tpa`.`case`.`id` not in ('122036','126369','128036') order by to_days(curdate()) - to_days(coalesce(`his-tpa`.`case`.`original_bill_verified_date`,`his-tpa`.`case`.`original_bill_checked_date`)) desc ;

-- ----------------------------
-- View structure for ws_default
-- ----------------------------
DROP VIEW IF EXISTS `ws_default`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `ws_default` AS select if(`his-tpa`.`case`.`id` = 310,`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) AS `provider`,`his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`member`.`member_name` AS `patient`,concat(`his-tpa`.`case`.`policy_no`,' / ',`his-tpa`.`case`.`member_id`) AS `policy_no`,coalesce(`his-tpa`.`company`.`name`,`his-tpa`.`member`.`policy_holder`,`member_01`.`member_name`) AS `policy_holder`,concat(convert(date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4)) AS `policy_period`,concat(convert(date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4)) AS `treatment_period`,concat(to_days(`his-tpa`.`case`.`discharge_date`) - to_days(`his-tpa`.`case`.`admission_date`),' Hari') + 1 AS `days_of_treatment`,cast(concat(`his-tpa`.`diagnosis`.`code`,'. ',`his-tpa`.`diagnosis`.`name`,if(`his-tpa`.`case`.`other_diagnosis` is null,'',concat('; ',`his-tpa`.`case`.`other_diagnosis`))) as char(255) charset utf8) AS `diagnosis`,date_format(`his-tpa`.`case`.`bill_upload_date`,'%d/%m/%Y') AS `bill_receive_date`,date_format(`his-tpa`.`case`.`bill_completed_date`,'%d/%m/%Y') AS `bill_complete_date`,`his-tpa`.`country`.`iso-4217` AS `currency`,coalesce(`country_01`.`iso-4217`,`his-tpa`.`country`.`iso-4217`) AS `currency_01`,`his-tpa`.`plan_detail`.`id` AS `plan_detail_id`,`his-tpa`.`plan_detail`.`name` AS `plan_detail_name`,coalesce(sum(`his-tpa`.`worksheet`.`day`),0) AS `day`,sum(`his-tpa`.`case`.`currency_rate` * coalesce(`his-tpa`.`worksheet`.`actual`,0)) AS `actual`,sum(`his-tpa`.`case`.`currency_rate` * (coalesce(`his-tpa`.`worksheet`.`cover`,0) + coalesce(`his-tpa`.`worksheet`.`cash_benefit`,0))) AS `cover`,sum(`his-tpa`.`case`.`currency_rate` * coalesce(`his-tpa`.`worksheet`.`excess`,0)) AS `excess`,group_concat(`his-tpa`.`worksheet`.`remarks` separator ',') AS `remarks`,group_concat(`his-tpa`.`worksheet`.`remarks_01` separator ',') AS `remarks_01`,`his-tpa`.`users`.`full_name` AS `issued_by`,`his-tpa`.`case`.`ws_finished_date` AS `issue_date`,`his-tpa`.`users`.`signature` AS `signature`,`users_01`.`full_name` AS `approved_by`,`his-tpa`.`case`.`ws_approval_date` AS `approval_date`,`users_01`.`signature` AS `signature_01`,`his-tpa`.`case`.`currency_rate` * min(`his-tpa`.`worksheet`.`remaining_annual_limit`) AS `remaining_limit` from ((((((((((((`his-tpa`.`case` join `his-tpa`.`plan_detail` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan_detail`.`plan`)) join `his-tpa`.`worksheet` on(`his-tpa`.`plan_detail`.`id` = `his-tpa`.`worksheet`.`detail` and `his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`users` on(convert(`his-tpa`.`case`.`ws_finished_by` using utf8) = `his-tpa`.`users`.`username`)) left join `his-tpa`.`users` `users_01` on(convert(`his-tpa`.`case`.`ws_approval_by` using utf8) = `users_01`.`username`)) left join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`country` `country_01` on(`his-tpa`.`case`.`currency_02` = `country_01`.`id`)) group by `his-tpa`.`worksheet`.`case`,`his-tpa`.`worksheet`.`detail` ;

-- ----------------------------
-- View structure for ws_default_01
-- ----------------------------
DROP VIEW IF EXISTS `ws_default_01`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `ws_default_01` AS select if(`his-tpa`.`case`.`id` = 310,`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) AS `provider`,`his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`member`.`member_name` AS `patient`,concat(`his-tpa`.`case`.`policy_no`,' / ',`his-tpa`.`case`.`member_id`) AS `policy_no`,coalesce(`his-tpa`.`company`.`name`,`his-tpa`.`member`.`policy_holder`,`member_01`.`member_name`) AS `policy_holder`,concat(convert(date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4)) AS `policy_period`,concat(convert(date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4)) AS `treatment_period`,concat(to_days(`his-tpa`.`case`.`discharge_date`) - to_days(`his-tpa`.`case`.`admission_date`),' Hari') + 1 AS `days_of_treatment`,cast(concat(`his-tpa`.`diagnosis`.`code`,'. ',`his-tpa`.`diagnosis`.`name`,if(`his-tpa`.`case`.`other_diagnosis` is null,'',concat('; ',`his-tpa`.`case`.`other_diagnosis`))) as char(255) charset utf8) AS `diagnosis`,date_format(`his-tpa`.`case`.`bill_upload_date`,'%d/%m/%Y') AS `bill_receive_date`,date_format(`his-tpa`.`case`.`bill_completed_date`,'%d/%m/%Y') AS `bill_complete_date`,`his-tpa`.`country`.`iso-4217` AS `currency`,coalesce(`country_01`.`iso-4217`,`his-tpa`.`country`.`iso-4217`) AS `currency_01`,`his-tpa`.`plan_detail`.`id` AS `plan_detail_id`,`his-tpa`.`plan_detail`.`name` AS `plan_detail_name`,coalesce(`his-tpa`.`worksheet_01`.`day`,0) AS `day`,sum(`his-tpa`.`case`.`currency_rate` * coalesce(`his-tpa`.`worksheet_01`.`actual`,0)) AS `actual`,sum(`his-tpa`.`case`.`currency_rate` * (coalesce(`his-tpa`.`worksheet_01`.`cover`,0) + coalesce(`his-tpa`.`worksheet_01`.`cash_benefit`,0))) AS `cover`,sum(`his-tpa`.`case`.`currency_rate` * coalesce(`his-tpa`.`worksheet_01`.`excess`,0)) AS `excess`,group_concat(`his-tpa`.`worksheet_01`.`remarks` separator ',') AS `remarks`,group_concat(`his-tpa`.`worksheet_01`.`remarks_01` separator ',') AS `remarks_01`,`his-tpa`.`users`.`full_name` AS `issued_by`,`his-tpa`.`case`.`ws_finished_date` AS `issue_date`,`his-tpa`.`users`.`signature` AS `signature`,`users_01`.`full_name` AS `approved_by`,`his-tpa`.`case`.`ws_approval_date` AS `approval_date`,`users_01`.`signature` AS `signature_01`,`his-tpa`.`case`.`currency_rate` * min(`his-tpa`.`worksheet_01`.`remaining_annual_limit`) AS `remaining_limit` from ((((((((((((`his-tpa`.`case` join `his-tpa`.`plan_detail` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan_detail`.`plan`)) join `his-tpa`.`worksheet_01` on(`his-tpa`.`plan_detail`.`id` = `his-tpa`.`worksheet_01`.`detail` and `his-tpa`.`case`.`id` = `his-tpa`.`worksheet_01`.`case`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`users` on(convert(`his-tpa`.`case`.`ws_finished_by` using utf8) = `his-tpa`.`users`.`username`)) left join `his-tpa`.`users` `users_01` on(convert(`his-tpa`.`case`.`ws_approval_by` using utf8) = `users_01`.`username`)) left join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`country` `country_01` on(`his-tpa`.`case`.`currency_02` = `country_01`.`id`)) group by `his-tpa`.`worksheet_01`.`case`,`his-tpa`.`worksheet_01`.`detail` ;

-- ----------------------------
-- View structure for ws_default_jagadiri
-- ----------------------------
DROP VIEW IF EXISTS `ws_default_jagadiri`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `ws_default_jagadiri` AS select if(`his-tpa`.`case`.`id` = 310,`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) AS `provider`,`his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`member`.`member_name` AS `patient`,concat(`his-tpa`.`case`.`policy_no`,' / ',`his-tpa`.`case`.`member_id`) AS `policy_no`,coalesce(`his-tpa`.`company`.`name`,`his-tpa`.`member`.`policy_holder`,`member_01`.`member_name`) AS `policy_holder`,concat(convert(date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4)) AS `policy_period`,concat(convert(date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4)) AS `treatment_period`,concat(to_days(`his-tpa`.`case`.`discharge_date`) - to_days(`his-tpa`.`case`.`admission_date`),' Hari') + 1 AS `days_of_treatment`,cast(concat(`his-tpa`.`diagnosis`.`code`,'. ',`his-tpa`.`diagnosis`.`name`,if(`his-tpa`.`case`.`other_diagnosis` is null,'',concat('; ',`his-tpa`.`case`.`other_diagnosis`))) as char(255) charset utf8) AS `diagnosis`,date_format(`his-tpa`.`case`.`bill_upload_date`,'%d/%m/%Y') AS `bill_receive_date`,date_format(`his-tpa`.`case`.`bill_completed_date`,'%d/%m/%Y') AS `bill_complete_date`,`his-tpa`.`country`.`iso-4217` AS `currency`,coalesce(`country_01`.`iso-4217`,`his-tpa`.`country`.`iso-4217`) AS `currency_01`,`his-tpa`.`plan_detail`.`id` AS `plan_detail_id`,`his-tpa`.`plan_detail`.`name` AS `plan_detail_name`,coalesce(sum(`his-tpa`.`worksheet`.`day`),0) AS `day`,sum(`his-tpa`.`case`.`currency_rate` * coalesce(`his-tpa`.`worksheet`.`actual`,0)) AS `actual`,sum(`his-tpa`.`case`.`currency_rate` * (coalesce(`his-tpa`.`worksheet`.`cover`,0) + coalesce(`his-tpa`.`worksheet`.`cash_benefit`,0))) AS `cover`,sum(`his-tpa`.`case`.`currency_rate` * coalesce(`his-tpa`.`worksheet`.`excess`,0)) AS `excess`,group_concat(`his-tpa`.`worksheet`.`remarks` separator ',') AS `remarks`,group_concat(`his-tpa`.`worksheet`.`remarks_01` separator ',') AS `remarks_01`,`his-tpa`.`users`.`full_name` AS `issued_by`,`his-tpa`.`case`.`ws_finished_date` AS `issue_date`,`his-tpa`.`users`.`signature` AS `signature`,`users_01`.`full_name` AS `approved_by`,`his-tpa`.`case`.`ws_approval_date` AS `approval_date`,`users_01`.`signature` AS `signature_01`,`his-tpa`.`case`.`currency_rate` * min(`his-tpa`.`worksheet`.`remaining_annual_limit`) AS `remaining_limit` from ((((((((((((`his-tpa`.`case` join `his-tpa`.`plan_detail` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan_detail`.`plan`)) join `his-tpa`.`worksheet` on(`his-tpa`.`plan_detail`.`id` = `his-tpa`.`worksheet`.`detail` and `his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`users` on(convert(`his-tpa`.`case`.`ws_finished_by` using utf8) = `his-tpa`.`users`.`username`)) left join `his-tpa`.`users` `users_01` on(convert(`his-tpa`.`case`.`ws_approval_by` using utf8) = `users_01`.`username`)) left join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`country` `country_01` on(`his-tpa`.`case`.`currency_02` = `country_01`.`id`)) where `his-tpa`.`case`.`client` = 24 and `his-tpa`.`case`.`type` = 2 group by `his-tpa`.`worksheet`.`case`,`his-tpa`.`worksheet`.`detail` ;

-- ----------------------------
-- View structure for ws_default_tmli
-- ----------------------------
DROP VIEW IF EXISTS `ws_default_tmli`;
CREATE ALGORITHM=UNDEFINED DEFINER=`luki.handoko`@`%` SQL SECURITY DEFINER VIEW `ws_default_tmli` AS select if(`his-tpa`.`case`.`id` = 310,`his-tpa`.`case`.`other_provider`,`provider`.`full_name`) AS `provider`,`his-tpa`.`case`.`id` AS `case`,if(`his-tpa`.`case`.`type` = 1,'Reimbursement',if(`his-tpa`.`case`.`type` = 2,'Cashless',if(`his-tpa`.`case`.`type` = 3,'Cashless Non-LOG',if(`his-tpa`.`case`.`type` = 4,'Pay & File','ERROR')))) AS `type`,`his-tpa`.`plan`.`name` AS `plan`,`his-tpa`.`member`.`member_name` AS `patient`,concat(`his-tpa`.`case`.`policy_no`,' / ',`his-tpa`.`case`.`member_id`) AS `policy_no`,coalesce(`his-tpa`.`company`.`name`,`his-tpa`.`member`.`policy_holder`,`member_01`.`member_name`) AS `policy_holder`,concat(convert(date_format(`his-tpa`.`case`.`policy_effective_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`policy_expiry_date`,'%d/%m/%Y') using utf8mb4)) AS `policy_period`,concat(convert(date_format(`his-tpa`.`case`.`admission_date`,'%d/%m/%Y') using utf8mb4),'-',convert(date_format(`his-tpa`.`case`.`discharge_date`,'%d/%m/%Y') using utf8mb4)) AS `treatment_period`,concat(to_days(`his-tpa`.`case`.`discharge_date`) - to_days(`his-tpa`.`case`.`admission_date`),' Hari') + 1 AS `days_of_treatment`,cast(concat(`his-tpa`.`diagnosis`.`code`,'. ',`his-tpa`.`diagnosis`.`name`,if(`his-tpa`.`case`.`other_diagnosis` is null,'',concat('; ',`his-tpa`.`case`.`other_diagnosis`))) as char(255) charset utf8) AS `diagnosis`,date_format(`his-tpa`.`case`.`bill_upload_date`,'%d/%m/%Y') AS `bill_receive_date`,date_format(`his-tpa`.`case`.`bill_completed_date`,'%d/%m/%Y') AS `bill_complete_date`,`his-tpa`.`country`.`iso-4217` AS `currency`,coalesce(`country_01`.`iso-4217`,`his-tpa`.`country`.`iso-4217`) AS `currency_01`,`his-tpa`.`plan_detail`.`id` AS `plan_detail_id`,`his-tpa`.`plan_detail`.`name` AS `plan_detail_name`,coalesce(sum(`his-tpa`.`worksheet`.`day`),0) AS `day`,sum(`his-tpa`.`case`.`currency_rate` * coalesce(`his-tpa`.`worksheet`.`actual`,0)) AS `actual`,sum(`his-tpa`.`case`.`currency_rate` * (coalesce(`his-tpa`.`worksheet`.`cover`,0) + coalesce(`his-tpa`.`worksheet`.`cash_benefit`,0))) AS `cover`,sum(`his-tpa`.`case`.`currency_rate` * coalesce(`his-tpa`.`worksheet`.`excess`,0)) AS `excess`,group_concat(`his-tpa`.`worksheet`.`remarks` separator ',') AS `remarks`,group_concat(`his-tpa`.`worksheet`.`remarks_01` separator ',') AS `remarks_01`,`his-tpa`.`users`.`full_name` AS `issued_by`,`his-tpa`.`case`.`ws_finished_date` AS `issue_date`,`his-tpa`.`users`.`signature` AS `signature`,`users_01`.`full_name` AS `approved_by`,`his-tpa`.`case`.`ws_approval_date` AS `approval_date`,`users_01`.`signature` AS `signature_01`,`his-tpa`.`case`.`currency_rate` * min(`his-tpa`.`worksheet`.`remaining_annual_limit`) AS `remaining_limit` from ((((((((((((`his-tpa`.`case` join `his-tpa`.`plan_detail` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan_detail`.`plan`)) join `his-tpa`.`worksheet` on(`his-tpa`.`plan_detail`.`id` = `his-tpa`.`worksheet`.`detail` and `his-tpa`.`case`.`id` = `his-tpa`.`worksheet`.`case`)) join `his-tpa`.`provider` on(`his-tpa`.`case`.`provider` = `provider`.`id`)) join `his-tpa`.`plan` on(`his-tpa`.`case`.`plan` = `his-tpa`.`plan`.`id`)) join `his-tpa`.`member` on(`his-tpa`.`case`.`patient` = `his-tpa`.`member`.`id`)) join `his-tpa`.`diagnosis` on(`his-tpa`.`case`.`diagnosis` = `his-tpa`.`diagnosis`.`code`)) join `his-tpa`.`country` on(`his-tpa`.`case`.`currency_01` = `his-tpa`.`country`.`id`)) left join `his-tpa`.`users` on(convert(`his-tpa`.`case`.`ws_finished_by` using utf8) = `his-tpa`.`users`.`username`)) left join `his-tpa`.`users` `users_01` on(convert(`his-tpa`.`case`.`ws_approval_by` using utf8) = `users_01`.`username`)) left join `his-tpa`.`member` `member_01` on(`his-tpa`.`case`.`principle` = `member_01`.`id`)) left join `his-tpa`.`company` on(`his-tpa`.`case`.`company` = `his-tpa`.`company`.`id`)) join `his-tpa`.`country` `country_01` on(`his-tpa`.`case`.`currency_02` = `country_01`.`id`)) where `his-tpa`.`case`.`client` = 23 and `his-tpa`.`case`.`type` in (1,2) and `his-tpa`.`case`.`original_bill_checked` = 4 and if(dayname(curdate()) = 'Monday',cast(`his-tpa`.`case`.`original_bill_checked_date` as date) >= curdate() - interval 3 day and cast(`his-tpa`.`case`.`original_bill_checked_date` as date) <= curdate() - interval 1 day,cast(`his-tpa`.`case`.`original_bill_checked_date` as date) = curdate() - interval 1 day) group by `his-tpa`.`worksheet`.`case`,`his-tpa`.`worksheet`.`detail` ;

-- ----------------------------
-- Function structure for getworkingday
-- ----------------------------
DROP FUNCTION IF EXISTS `getworkingday`;
DELIMITER ;;
CREATE DEFINER=`luki.handoko`@`%%` FUNCTION `getworkingday`(d1 datetime,d2 datetime, retType varchar(20)) RETURNS varchar(255) CHARSET latin1
    DETERMINISTIC
BEGIN
 DECLARE dow1, dow2,daydiff,workdays, weekenddays, retdays,hourdiff INT;
    declare newstrt_dt datetime;
   SELECT dd.iDiff, dd.iDiff - dd.iWeekEndDays AS iWorkDays, dd.iWeekEndDays into daydiff, workdays, weekenddays
  FROM (
   SELECT
     dd.iDiff,
     ((dd.iWeeks * 2) + 
      IF(dd.iSatDiff >= 0 AND dd.iSatDiff < dd.iDays, 1, 0) + 
      IF (dd.iSunDiff >= 0 AND dd.iSunDiff < dd.iDays, 1, 0)) AS iWeekEndDays
       FROM (
      SELECT  dd.iDiff, FLOOR(dd.iDiff / 7) AS iWeeks, dd.iDiff % 7 iDays, 5 - dd.iStartDay AS iSatDiff,  6 - dd.iStartDay AS iSunDiff
     FROM (
      SELECT
        1 + DATEDIFF(d2, d1) AS iDiff,
        WEEKDAY(d1) AS iStartDay
      ) AS dd
    ) AS dd
  ) AS dd ;
  if(retType = 'day_diffs') then
  set retdays = daydiff; 
 elseif(retType = 'work_days') then
  set retdays = workdays; 
 elseif(retType = 'weekend_days') then  
  set retdays = weekenddays; 
 end if; 
    RETURN retdays; 
    END
;;
DELIMITER ;

-- ----------------------------
-- Function structure for terbilang
-- ----------------------------
DROP FUNCTION IF EXISTS `terbilang`;
DELIMITER ;;
CREATE DEFINER=`luki.handoko`@`%` FUNCTION `terbilang`(`angka` BIGINT) RETURNS varchar(5000) CHARSET latin1
    NO SQL
BEGIN
 DECLARE sString varchar(30);
 DECLARE Bil1 varchar(255);
 DECLARE Bil2 varchar(255);
 DECLARE STot varchar(255);
 DECLARE X int;
 DECLARE Y int;
 DECLARE Z int;
 DECLARE Urai varchar(5000);
 SET sString = CAST(angka as char);
 SET Urai = '';
 SET X = 0;
 SET Y = 0;
 WHILE X <> LENGTH(sString) DO
SET X = X + 1;
SET sTot = MID(sString, X, 1);
SET Y = Y + CAST(sTot as UNSIGNED);
SET Z = LENGTH(sString) - X + 1;
CASE CAST(sTot as UNSIGNED)
WHEN 1 THEN
 BEGIN
  IF (Z = 1 OR Z = 7 OR Z = 10 OR Z = 13) THEN
   SET Bil1 = 'SATU ';
  ELSEIF (z = 4) THEN
   IF (x = 1) THEN
    SET Bil1 = 'SE';
   ELSE
    SET Bil1 = 'SATU ';
   END IF;
  ELSEIF (Z = 2 OR Z = 5 OR Z = 8 OR Z = 11 OR Z = 14) THEN
   SET X = X + 1;
   SET sTot = MID(sString, X, 1);
   SET Z = LENGTH(sString) - X + 1;
   SET Bil2 = '';
   CASE CAST(sTot AS UNSIGNED)
    WHEN 0 THEN SET Bil1 = 'SEPULUH ';
    WHEN 1 THEN SET Bil1 = 'SEBELAS ';
    WHEN 2 THEN SET Bil1 = 'DUA BELAS ';
    WHEN 3 THEN SET Bil1 = 'TIGA BELAS ';
    WHEN 4 THEN SET Bil1 = 'EMPAT BELAS ';
    WHEN 5 THEN SET Bil1 = 'LIMA BELAS ';
    WHEN 6 THEN SET Bil1 = 'ENAM BELAS ';
    WHEN 7 THEN SET Bil1 = 'TUJUH BELAS ';
    WHEN 8 THEN SET Bil1 = 'DELAPAN BELAS ';
    WHEN 9 THEN SET Bil1 = 'SEMBILAN BELAS ';
   ELSE BEGIN END;
   END CASE;
  ELSE
   SET Bil1 = 'SE';
  END IF;
 END;
WHEN 2 THEN SET Bil1 = 'DUA ';
WHEN 3 THEN SET Bil1 = 'TIGA ';
WHEN 4 THEN SET Bil1 = 'EMPAT ';
WHEN 5 THEN SET Bil1 = 'LIMA ';
WHEN 6 THEN SET Bil1 = 'ENAM ';
WHEN 7 THEN SET Bil1 = 'TUJUH ';
WHEN 8 THEN SET Bil1 = 'DELAPAN ';
WHEN 9 THEN SET Bil1 = 'SEMBILAN ';
ELSE SET Bil1 = '';
END CASE;
IF CAST(sTot as UNSIGNED) > 0 THEN
IF (Z = 2 OR Z = 5 OR Z = 8 OR Z = 11 OR Z = 14) THEN
 SET Bil2 = 'PULUH ';
ELSEIF (Z = 3 OR Z = 6 OR Z = 9 OR Z = 12 OR Z = 15) THEN
 SET Bil2 = 'RATUS ';
ELSE
 SET Bil2 = '';
END IF;
ELSE
SET Bil2 = '';
END IF;
IF Y > 0 THEN
CASE Z
 WHEN 4 THEN BEGIN SET Bil2 = CONCAT(Bil2, 'RIBU '); SET Y = 0; END;
 WHEN 7 THEN BEGIN SET Bil2 = CONCAT(Bil2, 'JUTA '); SET Y = 0; END;
 WHEN 10 THEN BEGIN SET Bil2 = CONCAT(Bil2, 'MILYAR '); SET Y = 0; END;
 WHEN 13 THEN BEGIN SET Bil2 = CONCAT(Bil2, 'TRILYUN '); SET Y = 0; END;
 ELSE BEGIN END;
END CASE;
END IF;
SET Urai = CONCAT(Urai, Bil1, Bil2);
END WHILE;
RETURN Urai;
END
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `trg_insert_aiaf`;
DELIMITER ;;
CREATE TRIGGER `trg_insert_aiaf` BEFORE INSERT ON `daily_aiaf` FOR EACH ROW BEGIN
SET @rank=0;
SET @group_row = (select @rank:=@rank+1 AS rank from (SELECT claim_no from daily_aiaf where SUBSTRING(claim_no,4,6) = DATE_FORMAT(CURDATE(),'%Y%m') group by claim_no) a ORDER BY rank desc limit 1);
SET @prev_id = (select id from daily_aiaf order by claim_no DESC LIMIT 1);
SET @prev_value= (select claim_no from daily_aiaf order by claim_no DESC LIMIT 1);
SET @cmpmonth = (select SUBSTRING(claim_no,4,6) from daily_aiaf ORDER BY claim_no DESC LIMIT 1);
SET @row_number = (select count(claim_no) from daily_aiaf where id = NEW.id);
SET @seq_same =IF(@prev_id=NEW.id,@prev_value, CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), LPAD(@group_row:=@group_row+1,6,'0')));
SET @seq_diff = CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), '0001');
SET @dens_r=1;

SET NEW.claim_no = IF(@cmpmonth=(DATE_FORMAT(CURDATE(),'%Y%m')),@seq_same,@seq_diff);
set NEW.sequence_no = CONCAT(LPAD(IF(@prev_id=NEW.id,@row_number:=@row_number+1,'1'),3,'0'));

IF NEW.claim_type = "'15" OR NEW.claim_type = "'14" THEN
 SET NEW.`pre_/_post-hosp_claim_no` = NEW.claim_no;
END IF;
END
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `seqtrig_aiaf`;
DELIMITER ;;
CREATE TRIGGER `seqtrig_aiaf` BEFORE INSERT ON `daily_aiaf_prod` FOR EACH ROW BEGIN
SET @rank=0;
SET @group_row = (select @rank:=@rank+1 AS rank from (SELECT claim_no from daily_aiaf where SUBSTRING(claim_no,4,6) = DATE_FORMAT(CURDATE(),'%Y%m') group by claim_no) a ORDER BY rank desc limit 1);
SET @prev_id = (select id from daily_aiaf order by claim_no DESC LIMIT 1);
SET @prev_value= (select claim_no from daily_aiaf order by claim_no DESC LIMIT 1);
SET @cmpmonth = (select SUBSTRING(claim_no,4,6) from daily_aiaf ORDER BY claim_no DESC LIMIT 1);
SET @row_number = (select count(claim_no) from daily_aiaf where id = NEW.id);
SET @seq_same =IF(@prev_id=NEW.id,@prev_value, CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), LPAD(@group_row:=@group_row+1,3,'0')));
SET @seq_diff = CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), '001');
SET @dens_r=1;

SET NEW.claim_no = IF(@cmpmonth=(DATE_FORMAT(CURDATE(),'%Y%m')),@seq_same,@seq_diff);
set NEW.sequence_no = CONCAT(LPAD(IF(@prev_id=NEW.id,@row_number:=@row_number+1,'1'),3,'0'));

IF NEW.claim_type = "'15" OR NEW.claim_type = "'14" THEN
 SET NEW.`pre_/_post-hosp_claim_no` = NEW.claim_no;
END IF;
END
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `aiaf_temp`;
DELIMITER ;;
CREATE TRIGGER `aiaf_temp` BEFORE INSERT ON `daily_aiaf_temp` FOR EACH ROW BEGIN
SET @rank=0;
SET @group_row = (select @rank:=@rank+1 AS rank from (SELECT claim_no from daily_aiaf_temp where SUBSTRING(claim_no,4,6) = DATE_FORMAT(CURDATE(),'%Y%m') group by claim_no) a ORDER BY rank desc limit 1);
SET @prev_id = (select id from daily_aiaf_temp order by claim_no DESC LIMIT 1);
SET @prev_value= (select claim_no from daily_aiaf_temp order by claim_no DESC LIMIT 1);
SET @cmpmonth = (select SUBSTRING(claim_no,4,6) from daily_aiaf_temp ORDER BY claim_no DESC LIMIT 1);
SET @row_number = (select count(claim_no) from daily_aiaf_temp where id = NEW.id);
SET @seq_same =IF(@prev_id=NEW.id,@prev_value, CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), LPAD(@group_row:=@group_row+1,6,'0')));
SET @seq_diff = CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), '0001');
SET @dens_r=1;

SET NEW.claim_no = IF(@cmpmonth=(DATE_FORMAT(CURDATE(),'%Y%m')),@seq_same,@seq_diff);
set NEW.sequence_no = CONCAT(LPAD(IF(@prev_id=NEW.id,@row_number:=@row_number+1,'1'),3,'0'));

IF NEW.claim_type = "'15" OR NEW.claim_type = "'14" THEN
 SET NEW.`pre_/_post-hosp_claim_no` = NEW.claim_no;
END IF;
END
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `aiaf_temp_copy`;
DELIMITER ;;
CREATE TRIGGER `aiaf_temp_copy` BEFORE INSERT ON `daily_aiaf_temp_01` FOR EACH ROW BEGIN
SET @rank=0;
SET @group_row = (select @rank:=@rank+1 AS rank from (SELECT claim_no from daily_aiaf_temp_01 where SUBSTRING(claim_no,4,6) = DATE_FORMAT(CURDATE(),'%Y%m') group by claim_no) a ORDER BY rank desc limit 1);
SET @prev_id = (select id from daily_aiaf_temp_01 order by claim_no DESC LIMIT 1);
SET @prev_value= (select claim_no from daily_aiaf_temp_01 order by claim_no DESC LIMIT 1);
SET @cmpmonth = (select SUBSTRING(claim_no,4,6) from daily_aiaf_temp_01 ORDER BY claim_no DESC LIMIT 1);
SET @row_number = (select count(claim_no) from daily_aiaf_temp_01 where id = NEW.id);
SET @seq_same =IF(@prev_id=NEW.id,@prev_value, CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), LPAD(@group_row:=@group_row+1,6,'0')));
SET @seq_diff = CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), '0001');
SET @dens_r=1;

SET NEW.claim_no = IF(@cmpmonth=(DATE_FORMAT(CURDATE(),'%Y%m')),@seq_same,@seq_diff);
set NEW.sequence_no = CONCAT(LPAD(IF(@prev_id=NEW.id,@row_number:=@row_number+1,'1'),3,'0'));

IF NEW.claim_type = "'15" OR NEW.claim_type = "'14" THEN
 SET NEW.`pre_/_post-hosp_claim_no` = NEW.claim_no;
END IF;
END
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `seqtrig_aiaf_copy2_copy`;
DELIMITER ;;
CREATE TRIGGER `seqtrig_aiaf_copy2_copy` BEFORE INSERT ON `daily_aiaf_tes` FOR EACH ROW BEGIN
SET @rank=0;
SET @group_row = (select @rank:=@rank+1 AS rank from (SELECT claim_no from daily_aiaf_tes where SUBSTRING(claim_no,4,6) = DATE_FORMAT(CURDATE(),'%Y%m') group by claim_no) a ORDER BY rank desc limit 1);
SET @prev_id = (select id from daily_aiaf_tes order by claim_no DESC LIMIT 1);
SET @prev_value= (select claim_no from daily_aiaf_tes order by claim_no DESC LIMIT 1);
SET @cmpmonth = (select SUBSTRING(claim_no,4,6) from daily_aiaf_tes ORDER BY claim_no DESC LIMIT 1);
SET @row_number = (select count(claim_no) from daily_aiaf_tes where id = NEW.id);
SET @seq_same =IF(@prev_id=NEW.id,@prev_value, CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), LPAD(@group_row:=@group_row+1,6,'0')));
SET @seq_diff = CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), '0001');
SET @dens_r=1;

SET NEW.claim_no = IF(@cmpmonth=(DATE_FORMAT(CURDATE(),'%Y%m')),@seq_same,@seq_diff);
set NEW.sequence_no = CONCAT(LPAD(IF(@prev_id=NEW.id,@row_number:=@row_number+1,'1'),3,'0'));

IF NEW.claim_type = "'15" OR NEW.claim_type = "'14" THEN
 SET NEW.`pre_/_post-hosp_claim_no` = NEW.claim_no;
END IF;
END
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `seqtrig_aiaf_copy1_copy`;
DELIMITER ;;
CREATE TRIGGER `seqtrig_aiaf_copy1_copy` BEFORE INSERT ON `daily_aiaf_testing` FOR EACH ROW BEGIN
SET @rank=0;
SET @group_row = (select @rank:=@rank+1 AS rank from (SELECT claim_no from daily_aiaf where SUBSTRING(claim_no,4,6) = DATE_FORMAT(CURDATE(),'%Y%m') group by claim_no) a ORDER BY rank desc limit 1);
SET @prev_id = (select id from daily_aiaf order by claim_no DESC LIMIT 1);
SET @prev_value= (select claim_no from daily_aiaf order by claim_no DESC LIMIT 1);
SET @cmpmonth = (select SUBSTRING(claim_no,4,6) from daily_aiaf ORDER BY claim_no DESC LIMIT 1);
SET @row_number = (select count(claim_no) from daily_aiaf where id = NEW.id);
SET @seq_same =IF(@prev_id=NEW.id,@prev_value, CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), LPAD(@group_row:=@group_row+1,3,'0')));
SET @seq_diff = CONCAT('AAI',DATE_FORMAT(CURDATE(),'%Y%m'), '001');
SET @dens_r=1;

SET NEW.claim_no = IF(@cmpmonth=(DATE_FORMAT(CURDATE(),'%Y%m')),@seq_same,@seq_diff);
set NEW.sequence_no = CONCAT(LPAD(IF(@prev_id=NEW.id,@row_number:=@row_number+1,'1'),3,'0'));

IF NEW.claim_type = "'15" OR NEW.claim_type = "'14" THEN
 SET NEW.`pre_/_post-hosp_claim_no` = NEW.claim_no;
END IF;
END
;;
DELIMITER ;
